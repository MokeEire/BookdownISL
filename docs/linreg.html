<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Linear Regression | An Introduction to Statistical Learning: with Applications in R</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Linear Regression | An Introduction to Statistical Learning: with Applications in R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://faculty.marshall.usc.edu/gareth-james/ISL/" />
  <meta property="og:image" content="http://faculty.marshall.usc.edu/gareth-james/ISL/images/isl_cover.jpg" />
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="MokeEire/BookdownISL" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Linear Regression | An Introduction to Statistical Learning: with Applications in R" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="twitter:image" content="http://faculty.marshall.usc.edu/gareth-james/ISL/images/isl_cover.jpg" />

<meta name="author" content="Gareth James, Daniela Witten, Trevor Hastie, &amp; Robert Tibshirani" />


<meta name="date" content="2020-12-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="intro.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="libs/core-js-2.5.3/shim.min.js"></script>
<script src="libs/react-16.12.0/react.min.js"></script>
<script src="libs/react-16.12.0/react-dom.min.js"></script>
<script src="libs/reactwidget-1.0.0/react-tools.js"></script>
<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/reactable-binding-0.2.3/reactable.js"></script>

<script>
/* ========================================================================
 * Bootstrap: transition.js v3.3.7
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)
  // ============================================================

  function transitionEnd() {
    var el = document.createElement('bootstrap')

    var transEndEventNames = {
      WebkitTransition : 'webkitTransitionEnd',
      MozTransition    : 'transitionend',
      OTransition      : 'oTransitionEnd otransitionend',
      transition       : 'transitionend'
    }

    for (var name in transEndEventNames) {
      if (el.style[name] !== undefined) {
        return { end: transEndEventNames[name] }
      }
    }

    return false // explicit for ie8 (  ._.)
  }

  // http://blog.alexmaccaw.com/css-transitions
  $.fn.emulateTransitionEnd = function (duration) {
    var called = false
    var $el = this
    $(this).one('bsTransitionEnd', function () { called = true })
    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }
    setTimeout(callback, duration)
    return this
  }

  $(function () {
    $.support.transition = transitionEnd()

    if (!$.support.transition) return

    $.event.special.bsTransitionEnd = {
      bindType: $.support.transition.end,
      delegateType: $.support.transition.end,
      handle: function (e) {
        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)
      }
    }
  })

}(jQuery);
</script>
<script>
/* ========================================================================
 * Bootstrap: collapse.js v3.3.7
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* jshint latedef: false */

+function ($) {
  'use strict';

  // COLLAPSE PUBLIC CLASS DEFINITION
  // ================================

  var Collapse = function (element, options) {
    this.$element      = $(element)
    this.options       = $.extend({}, Collapse.DEFAULTS, options)
    this.$trigger      = $('[data-toggle="collapse"][href="#' + element.id + '"],' +
                           '[data-toggle="collapse"][data-target="#' + element.id + '"]')
    this.transitioning = null

    if (this.options.parent) {
      this.$parent = this.getParent()
    } else {
      this.addAriaAndCollapsedClass(this.$element, this.$trigger)
    }

    if (this.options.toggle) this.toggle()
  }

  Collapse.VERSION  = '3.3.7'

  Collapse.TRANSITION_DURATION = 350

  Collapse.DEFAULTS = {
    toggle: true
  }

  Collapse.prototype.dimension = function () {
    var hasWidth = this.$element.hasClass('width')
    return hasWidth ? 'width' : 'height'
  }

  Collapse.prototype.show = function () {
    if (this.transitioning || this.$element.hasClass('in')) return

    var activesData
    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')

    if (actives && actives.length) {
      activesData = actives.data('bs.collapse')
      if (activesData && activesData.transitioning) return
    }

    var startEvent = $.Event('show.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    if (actives && actives.length) {
      Plugin.call(actives, 'hide')
      activesData || actives.data('bs.collapse', null)
    }

    var dimension = this.dimension()

    this.$element
      .removeClass('collapse')
      .addClass('collapsing')[dimension](0)
      .attr('aria-expanded', true)

    this.$trigger
      .removeClass('collapsed')
      .attr('aria-expanded', true)

    this.transitioning = 1

    var complete = function () {
      this.$element
        .removeClass('collapsing')
        .addClass('collapse in')[dimension]('')
      this.transitioning = 0
      this.$element
        .trigger('shown.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    var scrollSize = $.camelCase(['scroll', dimension].join('-'))

    this.$element
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])
  }

  Collapse.prototype.hide = function () {
    if (this.transitioning || !this.$element.hasClass('in')) return

    var startEvent = $.Event('hide.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    var dimension = this.dimension()

    this.$element[dimension](this.$element[dimension]())[0].offsetHeight

    this.$element
      .addClass('collapsing')
      .removeClass('collapse in')
      .attr('aria-expanded', false)

    this.$trigger
      .addClass('collapsed')
      .attr('aria-expanded', false)

    this.transitioning = 1

    var complete = function () {
      this.transitioning = 0
      this.$element
        .removeClass('collapsing')
        .addClass('collapse')
        .trigger('hidden.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    this.$element
      [dimension](0)
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)
  }

  Collapse.prototype.toggle = function () {
    this[this.$element.hasClass('in') ? 'hide' : 'show']()
  }

  Collapse.prototype.getParent = function () {
    return $(this.options.parent)
      .find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]')
      .each($.proxy(function (i, element) {
        var $element = $(element)
        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)
      }, this))
      .end()
  }

  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {
    var isOpen = $element.hasClass('in')

    $element.attr('aria-expanded', isOpen)
    $trigger
      .toggleClass('collapsed', !isOpen)
      .attr('aria-expanded', isOpen)
  }

  function getTargetFromTrigger($trigger) {
    var href
    var target = $trigger.attr('data-target')
      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') // strip for ie7

    return $(target)
  }


  // COLLAPSE PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.collapse')
      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false
      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.collapse

  $.fn.collapse             = Plugin
  $.fn.collapse.Constructor = Collapse


  // COLLAPSE NO CONFLICT
  // ====================

  $.fn.collapse.noConflict = function () {
    $.fn.collapse = old
    return this
  }


  // COLLAPSE DATA-API
  // =================

  $(document).on('click.bs.collapse.data-api', '[data-toggle="collapse"]', function (e) {
    var $this   = $(this)

    if (!$this.attr('data-target')) e.preventDefault()

    var $target = getTargetFromTrigger($this)
    var data    = $target.data('bs.collapse')
    var option  = data ? 'toggle' : $this.data()

    Plugin.call($target, option)
  })

}(jQuery);
</script>
<script>
window.initializeCodeFolding = function(show) {

  // handlers for show-all and hide all
  $("#rmd-show-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('show');
    });
  });
  $("#rmd-hide-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('hide');
    });
  });

  // index for unique code element ids
  var currentIndex = 1;

  // select all R code blocks
  var rCodeBlocks = $('pre.sourceCode, pre.r, pre.python, pre.bash, pre.sql, pre.cpp, pre.stan');
  rCodeBlocks.each(function() {

    // create a collapsable div to wrap the code in
    var div = $('<div class="collapse r-code-collapse"></div>');
    if (show)
      div.addClass('in');
    var id = 'rcode-643E0F36' + currentIndex++;
    div.attr('id', id);
    $(this).before(div);
    $(this).detach().appendTo(div);

    // add a show code button right above
    var showCodeText = $('<span>' + (show ? 'Hide' : 'Code') + '</span>');
    var showCodeButton = $('<button type="button" class="btn btn-default btn-xs code-folding-btn pull-right"></button>');
    showCodeButton.append(showCodeText);
    showCodeButton
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    var buttonRow = $('<div class="row"></div>');
    var buttonCol = $('<div class="col-md-12"></div>');

    buttonCol.append(showCodeButton);
    buttonRow.append(buttonCol);

    div.before(buttonRow);

    // update state of button on show/hide
    div.on('hidden.bs.collapse', function () {
      showCodeText.text('Code');
    });
    div.on('show.bs.collapse', function () {
      showCodeText.text('Hide');
    });
  });

}
</script>
<script>
/* ========================================================================
 * Bootstrap: dropdown.js v3.3.7
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // DROPDOWN CLASS DEFINITION
  // =========================

  var backdrop = '.dropdown-backdrop'
  var toggle   = '[data-toggle="dropdown"]'
  var Dropdown = function (element) {
    $(element).on('click.bs.dropdown', this.toggle)
  }

  Dropdown.VERSION = '3.3.7'

  function getParent($this) {
    var selector = $this.attr('data-target')

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && /#[A-Za-z]/.test(selector) && selector.replace(/.*(?=#[^\s]*$)/, '') // strip for ie7
    }

    var $parent = selector && $(selector)

    return $parent && $parent.length ? $parent : $this.parent()
  }

  function clearMenus(e) {
    if (e && e.which === 3) return
    $(backdrop).remove()
    $(toggle).each(function () {
      var $this         = $(this)
      var $parent       = getParent($this)
      var relatedTarget = { relatedTarget: this }

      if (!$parent.hasClass('open')) return

      if (e && e.type == 'click' && /input|textarea/i.test(e.target.tagName) && $.contains($parent[0], e.target)) return

      $parent.trigger(e = $.Event('hide.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this.attr('aria-expanded', 'false')
      $parent.removeClass('open').trigger($.Event('hidden.bs.dropdown', relatedTarget))
    })
  }

  Dropdown.prototype.toggle = function (e) {
    var $this = $(this)

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    clearMenus()

    if (!isActive) {
      if ('ontouchstart' in document.documentElement && !$parent.closest('.navbar-nav').length) {
        // if mobile we use a backdrop because click events don't delegate
        $(document.createElement('div'))
          .addClass('dropdown-backdrop')
          .insertAfter($(this))
          .on('click', clearMenus)
      }

      var relatedTarget = { relatedTarget: this }
      $parent.trigger(e = $.Event('show.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this
        .trigger('focus')
        .attr('aria-expanded', 'true')

      $parent
        .toggleClass('open')
        .trigger($.Event('shown.bs.dropdown', relatedTarget))
    }

    return false
  }

  Dropdown.prototype.keydown = function (e) {
    if (!/(38|40|27|32)/.test(e.which) || /input|textarea/i.test(e.target.tagName)) return

    var $this = $(this)

    e.preventDefault()
    e.stopPropagation()

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    if (!isActive && e.which != 27 || isActive && e.which == 27) {
      if (e.which == 27) $parent.find(toggle).trigger('focus')
      return $this.trigger('click')
    }

    var desc = ' li:not(.disabled):visible a'
    var $items = $parent.find('.dropdown-menu' + desc)

    if (!$items.length) return

    var index = $items.index(e.target)

    if (e.which == 38 && index > 0)                 index--         // up
    if (e.which == 40 && index < $items.length - 1) index++         // down
    if (!~index)                                    index = 0

    $items.eq(index).trigger('focus')
  }


  // DROPDOWN PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this = $(this)
      var data  = $this.data('bs.dropdown')

      if (!data) $this.data('bs.dropdown', (data = new Dropdown(this)))
      if (typeof option == 'string') data[option].call($this)
    })
  }

  var old = $.fn.dropdown

  $.fn.dropdown             = Plugin
  $.fn.dropdown.Constructor = Dropdown


  // DROPDOWN NO CONFLICT
  // ====================

  $.fn.dropdown.noConflict = function () {
    $.fn.dropdown = old
    return this
  }


  // APPLY TO STANDARD DROPDOWN ELEMENTS
  // ===================================

  $(document)
    .on('click.bs.dropdown.data-api', clearMenus)
    .on('click.bs.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() })
    .on('click.bs.dropdown.data-api', toggle, Dropdown.prototype.toggle)
    .on('keydown.bs.dropdown.data-api', toggle, Dropdown.prototype.keydown)
    .on('keydown.bs.dropdown.data-api', '.dropdown-menu', Dropdown.prototype.keydown)

}(jQuery);
</script>
<style type="text/css">
.code-folding-btn {
  margin-bottom: 4px;
}

.row { display: flex; }
.collapse { display: none; }
.in { display:block }
.pull-right > .dropdown-menu {
    right: 0;
    left: auto;
}

.dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    z-index: 1000;
    display: none;
    float: left;
    min-width: 160px;
    padding: 5px 0;
    margin: 2px 0 0;
    font-size: 14px;
    text-align: left;
    list-style: none;
    background-color: #fff;
    -webkit-background-clip: padding-box;
    background-clip: padding-box;
    border: 1px solid #ccc;
    border: 1px solid rgba(0,0,0,.15);
    border-radius: 4px;
    -webkit-box-shadow: 0 6px 12px rgba(0,0,0,.175);
    box-shadow: 0 6px 12px rgba(0,0,0,.175);
}

.open > .dropdown-menu {
    display: block;
    color: #ffffff;
    background-color: #ffffff;
    background-image: none;
    border-color: #92897e;
}

.dropdown-menu > li > a {
  display: block;
  padding: 3px 20px;
  clear: both;
  font-weight: 400;
  line-height: 1.42857143;
  color: #000000;
  white-space: nowrap;
}

.dropdown-menu > li > a:hover,
.dropdown-menu > li > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
}

.dropdown-menu > .active > a,
.dropdown-menu > .active > a:hover,
.dropdown-menu > .active > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
  outline: 0;
}
.dropdown-menu > .disabled > a,
.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  color: #aea79f;
}

.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  text-decoration: none;
  cursor: not-allowed;
  background-color: transparent;
  background-image: none;
  filter: progid:DXImageTransform.Microsoft.gradient(enabled = false);
}

.btn {
  display: inline-block;
  margin-bottom: 1;
  font-weight: normal;
  text-align: center;
  white-space: nowrap;
  vertical-align: middle;
  -ms-touch-action: manipulation;
      touch-action: manipulation;
  cursor: pointer;
  background-image: none;
  border: 1px solid transparent;
  padding: 4px 8px;
  font-size: 14px;
  line-height: 1.42857143;
  border-radius: 4px;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.btn:focus,
.btn:active:focus,
.btn.active:focus,
.btn.focus,
.btn:active.focus,
.btn.active.focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
.btn:hover,
.btn:focus,
.btn.focus {
  color: #ffffff;
  text-decoration: none;
}
.btn:active,
.btn.active {
  background-image: none;
  outline: 0;
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn.disabled,
.btn[disabled],
fieldset[disabled] .btn {
  cursor: not-allowed;
  filter: alpha(opacity=65);
  opacity: 0.65;
  box-shadow: none;
}
a.btn.disabled,
fieldset[disabled] a.btn {
  pointer-events: none;
}
.btn-default {
  color: #ffffff;
  background-color: #aea79f; #important
  border-color: #aea79f;
}

.btn-default:focus,
.btn-default.focus {
  color: #ffffff;
  background-color: #978e83;
  border-color: #6f675e;
}

.btn-default:hover {
  color: #ffffff;
  background-color: #978e83;
  border-color: #92897e;
}
.btn-default:active,
.btn-default.active,
.btn-group > .btn:not(:first-child):not(:last-child):not(.dropdown-toggle) {
  border-radius: 0;
}
.btn-group > .btn:first-child {
  margin-left: 0;
}
.btn-group > .btn:first-child:not(:last-child):not(.dropdown-toggle) {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn:last-child:not(:first-child),
.btn-group > .dropdown-toggle:not(:first-child) {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group > .btn-group {
  float: left;
}
.btn-group > .btn-group:not(:first-child):not(:last-child) > .btn {
  border-radius: 0;
}
.btn-group > .btn-group:first-child:not(:last-child) > .btn:last-child,
.btn-group > .btn-group:first-child:not(:last-child) > .dropdown-toggle {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn-group:last-child:not(:first-child) > .btn:first-child {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group .dropdown-toggle:active,
.btn-group.open .dropdown-toggle {
  outline: 0;
}
.btn-group > .btn + .dropdown-toggle {
  padding-right: 8px;
  padding-left: 8px;
}
.btn-group > .btn-lg + .dropdown-toggle {
  padding-right: 12px;
  padding-left: 12px;
}
.btn-group.open .dropdown-toggle {
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn-group.open .dropdown-toggle.btn-link {
  box-shadow: none;
}

</style>
<script>
var str = '<div class="btn-group pull-right" style="position: fixed; right: 50px; top: 10px; z-index: 200"><button type="button" class="btn btn-default btn-xs dropdown-toggle" id="allCodeButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" data-_extension-text-contrast=""><span>Code</span> <span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 50px;"><li><a id="rmd-show-all-code" href="#">Show All Code</a></li><li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li></ul></div>';
document.write(str);
</script>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "hide");
});
</script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><h1 class="corner-header"><a href="./">An Introduction to Statistical Learning</a></h1></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#resources-used-in-making-this-book"><i class="fa fa-check"></i>Resources used in making this book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#custom-functions-used-throughout-the-book"><i class="fa fa-check"></i>Custom functions used throughout the book</a><ul>
<li><a href="index.html#theme_islr"><code>theme_islr()</code></a></li>
<li><a href="index.html#prep_reg_table"><code>prep_reg_table()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#an-overview-of-statistical-learning"><i class="fa fa-check"></i><b>1.1</b> An Overview of Statistical Learning</a><ul>
<li class="chapter" data-level="1.1.1" data-path="intro.html"><a href="intro.html#wage-data"><i class="fa fa-check"></i><b>1.1.1</b> Wage Data</a></li>
<li class="chapter" data-level="1.1.2" data-path="intro.html"><a href="intro.html#stock-market-data"><i class="fa fa-check"></i><b>1.1.2</b> Stock Market Data</a></li>
<li class="chapter" data-level="1.1.3" data-path="intro.html"><a href="intro.html#gene-expression-data"><i class="fa fa-check"></i><b>1.1.3</b> Gene Expression Data</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#a-brief-history-of-statistical-learning"><i class="fa fa-check"></i><b>1.2</b> A Brief History of Statistical Learning</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#this-book"><i class="fa fa-check"></i><b>1.3</b> This Book</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#who-should-read-this-book"><i class="fa fa-check"></i><b>1.4</b> Who Should Read This Book</a></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#notation-and-simple-matrix-algebra"><i class="fa fa-check"></i><b>1.5</b> Notation and Simple Matrix Algebra</a></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#organization-of-this-book"><i class="fa fa-check"></i><b>1.6</b> Organization of This Book</a></li>
<li class="chapter" data-level="1.7" data-path="intro.html"><a href="intro.html#data-sets-used-in-labs-and-exercises"><i class="fa fa-check"></i><b>1.7</b> Data Sets Used in Labs and Exercises</a></li>
<li class="chapter" data-level="1.8" data-path="intro.html"><a href="intro.html#book-website"><i class="fa fa-check"></i><b>1.8</b> Book Website</a></li>
<li class="chapter" data-level="1.9" data-path="intro.html"><a href="intro.html#acknowledgements"><i class="fa fa-check"></i><b>1.9</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="linreg.html"><a href="linreg.html"><i class="fa fa-check"></i><b>2</b> Linear Regression</a><ul>
<li class="chapter" data-level="2.1" data-path="linreg.html"><a href="linreg.html#simple-lin-reg"><i class="fa fa-check"></i><b>2.1</b> Simple Linear Regression</a><ul>
<li class="chapter" data-level="2.1.1" data-path="linreg.html"><a href="linreg.html#simple-coef-est"><i class="fa fa-check"></i><b>2.1.1</b> Estimating the Coefficients</a></li>
<li class="chapter" data-level="2.1.2" data-path="linreg.html"><a href="linreg.html#assess-coef-acc"><i class="fa fa-check"></i><b>2.1.2</b> Assessing the Accuracy of the Coefficient Estimates</a></li>
<li class="chapter" data-level="2.1.3" data-path="linreg.html"><a href="linreg.html#assess-model-acc"><i class="fa fa-check"></i><b>2.1.3</b> Assessing the Accuracy of the Model</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="linreg.html"><a href="linreg.html#mult-lin-reg"><i class="fa fa-check"></i><b>2.2</b> Multiple Linear Regression</a><ul>
<li class="chapter" data-level="2.2.1" data-path="linreg.html"><a href="linreg.html#est-reg-coef"><i class="fa fa-check"></i><b>2.2.1</b> Estimating the Regression Coefficients</a></li>
<li class="chapter" data-level="2.2.2" data-path="linreg.html"><a href="linreg.html#important-questions"><i class="fa fa-check"></i><b>2.2.2</b> Some Important Questions</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="linreg.html"><a href="linreg.html#other-reg-cons"><i class="fa fa-check"></i><b>2.3</b> Other Considerations in the Regression Model</a><ul>
<li class="chapter" data-level="2.3.1" data-path="linreg.html"><a href="linreg.html#qualitative-predictors"><i class="fa fa-check"></i><b>2.3.1</b> Qualitative Predictors</a></li>
<li class="chapter" data-level="2.3.2" data-path="linreg.html"><a href="linreg.html#extensions-of-the-linear-model"><i class="fa fa-check"></i><b>2.3.2</b> Extensions of the Linear Model</a></li>
<li class="chapter" data-level="2.3.3" data-path="linreg.html"><a href="linreg.html#potential-problems"><i class="fa fa-check"></i><b>2.3.3</b> Potential Problems</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="linreg.html"><a href="linreg.html#the-marketing-plan"><i class="fa fa-check"></i><b>2.4</b> The Marketing Plan</a></li>
<li class="chapter" data-level="2.5" data-path="linreg.html"><a href="linreg.html#comparison-of-linear-regression-with-k-nearest-neighbors"><i class="fa fa-check"></i><b>2.5</b> Comparison of Linear Regression with K-Nearest Neighbors</a></li>
<li class="chapter" data-level="2.6" data-path="linreg.html"><a href="linreg.html#lab-linear-regression"><i class="fa fa-check"></i><b>2.6</b> Lab: Linear Regression</a><ul>
<li class="chapter" data-level="2.6.1" data-path="linreg.html"><a href="linreg.html#libraries"><i class="fa fa-check"></i><b>2.6.1</b> Libraries</a></li>
<li class="chapter" data-level="2.6.2" data-path="linreg.html"><a href="linreg.html#simple-linear-regression"><i class="fa fa-check"></i><b>2.6.2</b> Simple Linear Regression</a></li>
<li class="chapter" data-level="2.6.3" data-path="linreg.html"><a href="linreg.html#multiple-linear-regression"><i class="fa fa-check"></i><b>2.6.3</b> Multiple Linear Regression</a></li>
<li class="chapter" data-level="2.6.4" data-path="linreg.html"><a href="linreg.html#interaction-terms"><i class="fa fa-check"></i><b>2.6.4</b> Interaction Terms</a></li>
<li class="chapter" data-level="2.6.5" data-path="linreg.html"><a href="linreg.html#non-linear-transformations-of-the-predictors"><i class="fa fa-check"></i><b>2.6.5</b> Non-linear Transformations of the Predictors</a></li>
<li class="chapter" data-level="2.6.6" data-path="linreg.html"><a href="linreg.html#qualitative-predictors-1"><i class="fa fa-check"></i><b>2.6.6</b> Qualitative Predictors</a></li>
<li class="chapter" data-level="2.6.7" data-path="linreg.html"><a href="linreg.html#writing-functions"><i class="fa fa-check"></i><b>2.6.7</b> Writing Functions</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="linreg.html"><a href="linreg.html#exercises"><i class="fa fa-check"></i><b>2.7</b> Exercises</a><ul>
<li class="chapter" data-level="2.7.1" data-path="linreg.html"><a href="linreg.html#conceptual"><i class="fa fa-check"></i><b>2.7.1</b> Conceptual</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
<li><a href="https://statlearning.com/" target="blank">Go to ISLR Website</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">An Introduction to Statistical Learning: with Applications in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="linreg" class="section level1">
<h1><span class="header-section-number">2</span> Linear Regression</h1>
<p>This chapter is about <em>linear regression</em>, a very simple approach for supervised learning.
In particular, linear regression is a useful tool for predicting a quantitative response.
Linear regression has been around for a long time and is the topic of innumerable textbooks.
Though it may seem somewhat dull compared to some of the more modern statistical learning approaches described in later chapters of this book, linear regression is still a useful and widely used statistical learning method.
Moreover it serves as a good jumping-off point for newer approaches: as we will see in later chapters, many fancy statistical learning approaches can be seen as generalizations or extensions of linear regression.
Consequently, the importance of having a good understanding of linear regression before studying more complex learning methods cannot be overstated.
In this chapter, we review some of the key ideas of the linear regression model, as well as the least squares approach that is most commonly used to fit this model.</p>
<p>Recall the <code>Advertising</code> data from Chapter 2.
Figure 2.1 displays <code>sales</code> (in thousands of units) for a particular product as a function of advertising budgets (in thousands of dollars) for <code>TV</code>, <code>radio</code>, and <code>newspaper</code> media.
Suppose in our role as statistical consultants we are asked to suggest, on the basis of this data, a marketing plan for next year that will result in high product sales.
What information would be useful in order to provide such a recommendation?
Here are a few important questions that we might seek to address:</p>
<ol style="list-style-type: decimal">
<li><p><em>Is there a relationship between advertising budget and sales?</em><br />
Our first goal should be to determine whether the data provide evidence of an association between advertising expenditure and sales.
If the evidence is weak, then one might argue no money should be spent on advertising!</p></li>
<li><p><em>How strong is the relationship between advertising budget and sales?</em><br />
Assuming there is a relationship between advertising and sales, we would like to know the strength of that relationship.
In other words, given a certain advertising budget, can we predict sales with a high level of accuracy?
This would be a strong relationship.
Or is a prediction of sales based on advertising expenditure only slightly better than a random guess?
This would be a weak relationship.</p></li>
<li><p><em>Which media contribute to sales?</em><br />
Do all three media - TV, radio, and newspaper - contribute to sales, or do only one or two of the media contribute?
To answer this question, we must find a way to separate out the individual effects of each medium when we have spent the mony on all three media.</p></li>
<li><p><em>How accurately can we estimate the effect of each medium on sales?</em><br />
For every dollar spent on advertising in a particular medium, by what amount will sales increase?
How accurately can we predict this amount of increase?</p></li>
<li><p><em>How accurately can we predict future sales?</em><br />
For every given level of television, radio, and newspaper sales, what is our prediction for sales, and what is the accuracy of this prediction?</p></li>
<li><p><em>Is the relationship linear?</em><br />
If there is an approximately straight-line relationship between advertising expenditure in the various media and sales, then linear regression is an appropriate tool.
If not, then it may still be possible to transform the predictor of the response so that linear regression can be used.</p></li>
<li><p><em>Is there synergy among the advertising media?</em><br />
Perhaps spending $50,000 on television advertising and $50,000 on radio advertising results in more sales than allocating $100,000 in either television or radio individually.
In marketing, this is known as a <strong><span style="font-family:monospace; color: #1188ce;">synergy</span></strong> effect, while in statistics it is called an <strong><span style="font-family:monospace; color: #1188ce;">interaction</span></strong> effect.</p></li>
</ol>
<p>It turns out that linear regression can be used to answer each of these questions.
We will first discuss all of these questions in a general context, and then return to them in this specific context in Section 3.4.</p>
<div id="simple-lin-reg" class="section level2">
<h2><span class="header-section-number">2.1</span> Simple Linear Regression</h2>
<p><strong><span style="font-family:monospace; color: #1188ce;">Simple linear regression</span></strong> lives up to its name: it is a very straightforward approach for predicting a quantitative response <em>Y</em> on the basis of a single predictor variable <em>X</em>.
It assumes that there is an approximately linear relationship between <em>X</em> and <em>Y</em>.
Mathematically we can write this linear relationship as</p>
<p><span class="math display" id="eq:linmod">\[\begin{equation} 
  Y \approx \beta_0 + \beta_1X
  \tag{2.1}
\end{equation}\]</span></p>
<p>You might read “<span class="math inline">\(\approx\)</span>” as “<em>is approximately modeled as</em>”.
We will sometimes describe <a href="linreg.html#eq:linmod">(2.1)</a> by saying we are <em>regressing</em> Y on X (or Y <em>onto</em> X).
For example, <em>X</em> may represent <code>TV</code> advertising and <em>Y</em> may represent <code>sales</code>.
Then we can regress <code>sales</code> onto <code>TV</code> by fitting the model:</p>
<p><span class="math display">\[
\color{#B44C1C}{\textbf{sales}} = \beta_0+\beta_1\times\color{#B44C1C}{\textbf{TV}}
\]</span></p>
<p>In Equation <a href="linreg.html#eq:linmod">(2.1)</a>, <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> are two unknown constants that represent the <strong><span style="font-family:monospace; color: #1188ce;">intercept</span></strong> and the <strong><span style="font-family:monospace; color: #1188ce;">slope</span></strong> terms in the linear model.
Together, <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> are known as the model <strong><span style="font-family:monospace; color: #1188ce;">coefficients</span></strong> or <strong><span style="font-family:monospace; color: #1188ce;">parameters</span></strong>.
Once we have used our training data to produce estimates <span class="math inline">\(\hat{\beta_0}\)</span> and <span class="math inline">\(\hat{\beta_1}\)</span> for our model parameters, we can predict future sales on the basis of a particular value of TV advertising by computing</p>
<p><span class="math display" id="eq:linest">\[\begin{equation} 
  \hat{y} = \hat{\beta_0} + \hat{\beta_1}x
  \tag{2.2}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\hat{y}\)</span> indicates a prediction of <span class="math inline">\(Y\)</span> on the basis of <span class="math inline">\(X=x\)</span>.
Here we use the <em>hat</em> symbol, ^ , to denote the estimated value of an unknown parameter or coefficient, or to denote the predicted value of the response.</p>
<div id="simple-coef-est" class="section level3">
<h3><span class="header-section-number">2.1.1</span> Estimating the Coefficients</h3>
<p>In practice, <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> are unknown.
So before we can use <a href="linreg.html#eq:linmod">(2.1)</a> to make predictions, we must use data to estimate the coefficients. Let</p>
<p><span class="math display">\[(x_1, y_1), (x_2, y_2), ..., (x_n, y_n)\]</span></p>
<p>represent <em>n</em> observation pairs, each of which consists of a measurement of <em>X</em> and a measurement of <em>Y</em>.
In the <code>Advertising</code> example, this data set consists of the TV advertising budget and product sales in <span class="math inline">\(n = 200\)</span> different markets.
(Recall that the data are displayed in <strong>Figure 2.1</strong>.)
Our goal is to obtain coefficient estimates <span class="math inline">\(\hat{\beta_0}\)</span> and <span class="math inline">\(\hat{\beta_1}\)</span> such that the linear model <a href="linreg.html#eq:linmod">(2.1)</a> fits the available data well—that is, so that <span class="math inline">\(y_i \approx \hat{\beta_0}+\hat{\beta_1}x_i\)</span> for <span class="math inline">\(i = 1,...,n\)</span>.
In other words, we want to find an intercept b0 and a slope b1 such that the resulting line is as close as possible to the <span class="math inline">\(n = 200\)</span> data points.
There are a number of ways of measuring <em>closeness</em>.
However, by far the most common approach involves minimizing the <strong><span style="font-family:monospace; color: #1188ce;">least squares</span></strong> criterion, and we take that approach in this chapter.
Alternative approaches will be considered in Chapter 6.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="linreg.html#cb4-1"></a><span class="co"># Fit linear model regressing Sales on TV</span></span>
<span id="cb4-2"><a href="linreg.html#cb4-2"></a>adv_lm =<span class="st"> </span><span class="kw">lm</span>(sales<span class="op">~</span>TV, advertising)</span>
<span id="cb4-3"><a href="linreg.html#cb4-3"></a></span>
<span id="cb4-4"><a href="linreg.html#cb4-4"></a><span class="co"># Add the predicted values to the advertising dataframe</span></span>
<span id="cb4-5"><a href="linreg.html#cb4-5"></a>advertising <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-6"><a href="linreg.html#cb4-6"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">predicted =</span> adv_lm<span class="op">$</span>fitted.values) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-7"><a href="linreg.html#cb4-7"></a><span class="st">  </span><span class="kw">ggplot</span>(., <span class="kw">aes</span>(<span class="dt">x=</span>TV, <span class="dt">y =</span> sales))<span class="op">+</span></span>
<span id="cb4-8"><a href="linreg.html#cb4-8"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>)<span class="op">+</span></span>
<span id="cb4-9"><a href="linreg.html#cb4-9"></a><span class="st">  </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">xend =</span> TV, <span class="dt">yend =</span> predicted), <span class="dt">colour =</span> <span class="st">&quot;grey40&quot;</span>)<span class="op">+</span></span>
<span id="cb4-10"><a href="linreg.html#cb4-10"></a><span class="st">  </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> F, <span class="dt">fullrange =</span> T)<span class="op">+</span></span>
<span id="cb4-11"><a href="linreg.html#cb4-11"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">n.breaks =</span> <span class="dv">6</span>)<span class="op">+</span></span>
<span id="cb4-12"><a href="linreg.html#cb4-12"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">15</span>,<span class="dv">20</span>,<span class="dv">25</span>))<span class="op">+</span></span>
<span id="cb4-13"><a href="linreg.html#cb4-13"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Sales&quot;</span>)<span class="op">+</span></span>
<span id="cb4-14"><a href="linreg.html#cb4-14"></a><span class="st">  </span><span class="kw">theme_islr</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:advertising-lm"></span>
<img src="03-linear-regression_files/figure-html/advertising-lm-1.png" alt="*For the &lt;strong&gt;&lt;span style='font-family:monospace; color: #B44C1C;'&gt;Advertising&lt;/span&gt;&lt;/strong&gt; data, the least squares fit for the regression of &lt;strong&gt;&lt;span style='font-family:monospace; color: #B44C1C;'&gt;sales&lt;/span&gt;&lt;/strong&gt; onto &lt;strong&gt;&lt;span style='font-family:monospace; color: #B44C1C;'&gt;TV&lt;/span&gt;&lt;/strong&gt; is shown.  The fit is found by minimizing the sum of squared errors.  Each grey line segment represents an error, and the fit makes a compromise by averaging their squares.  In this case a linear fit captures the essence of the relationship, although it is somewhat deficient in the left of the plot.*" width="1152" />
<p class="caption">
FIGURE 2.1: <em>For the <strong><span style="font-family:monospace; color: #B44C1C;">Advertising</span></strong> data, the least squares fit for the regression of <strong><span style="font-family:monospace; color: #B44C1C;">sales</span></strong> onto <strong><span style="font-family:monospace; color: #B44C1C;">TV</span></strong> is shown. The fit is found by minimizing the sum of squared errors. Each grey line segment represents an error, and the fit makes a compromise by averaging their squares. In this case a linear fit captures the essence of the relationship, although it is somewhat deficient in the left of the plot.</em>
</p>
</div>
<p>Let <span class="math inline">\(\hat{y_i} = \hat{\beta_0}+\hat{\beta_1}x_i\)</span> be the prediction for <span class="math inline">\(Y\)</span> based on the <em>i</em>th value of <span class="math inline">\(X\)</span>.
Then <span class="math inline">\(e_i = y_i - \hat{y_i}\)</span> represents the <em>i</em>th <strong><span style="font-family:monospace; color: #1188ce;">residual</span></strong>—this is the difference between the <em>i</em>th observed response value and the <em>i</em>th response value that is predicted by our linear model.
We define the <strong><span style="font-family:monospace; color: #1188ce;">residual sum of squares</span></strong> (RSS) as
<span class="math display">\[RSS = {e_1^2}+{e_2^2}+...+{e_n^2},\]</span>
or equivalently as</p>
<p><span class="math display" id="eq:rss">\[\begin{equation} 
  RSS = (y_1 - \hat{\beta_0} - \hat{\beta_1}x_1)^2 + (y_2 - \hat{\beta_0} - \hat{\beta_1}x_2)^2 + ... + (y_n - \hat{\beta_0} - \hat{\beta_1}x_n)^2.
  \tag{2.3}
\end{equation}\]</span></p>
<p>The least squares approach chooses <span class="math inline">\(\hat{\beta_0}\)</span> and <span class="math inline">\(\hat{\beta_1}\)</span> to minimize the RSS.
Using some calculus, one can show that the minimizers are</p>
<p><span class="math display" id="eq:rssmin">\[\begin{equation} 
\begin{aligned}
  \hat{\beta_1} &amp;= \frac{\sum_{i=1}^{n}(x_i - \bar{x})(y_i-\bar{y})}{\sum_{i=1}^{n}(x_i-\bar{x})^2},\\
  \hat{\beta_0} &amp;= \bar{y}-\hat{\beta_1}\bar{x},
  \end{aligned}
  \tag{2.4}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\bar{y} \equiv \frac{1}{n}\sum_{i=1}^{n}y_i\)</span> and <span class="math inline">\(\bar{x} \equiv \frac{1}{n}\sum_{i=1}^{n}x_i\)</span> are the sample means.
In other words, <a href="linreg.html#eq:rssmin">(2.4)</a> defines the <em>least squares coefficient estimates</em> for simple linear regression.</p>
<p><a href="linreg.html#fig:advertising-lm">2.1</a> displays the simple linear regression fit to the <code>Advertising</code> data, where <span class="math inline">\(\hat{\beta_0} = 7.03\)</span> and <span class="math inline">\(\hat{\beta_1} = 0.0475\)</span>.
In other words, according to this approximation, an additional $1,000 spent on TV advertising is associated with selling approximately 47.5 additional units of the product.
In <strong>Figure 3.2</strong>, we have computed RSS for a number of values of <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>, using the advertising data with <code>sales</code> as the response and <code>TV</code> as the predictor.
In each plot, the red dot represents the pair of least squares estimates <span class="math inline">\((\hat{\beta_0}, \hat{\beta_1})\)</span> given by <a href="linreg.html#eq:rssmin">(2.4)</a>.
These values clearly minimize the RSS.</p>
<p>[FIGURE 3.2 HERE]</p>
</div>
<div id="assess-coef-acc" class="section level3">
<h3><span class="header-section-number">2.1.2</span> Assessing the Accuracy of the Coefficient Estimates</h3>
<p>Recall from <strong>Equation (2.1)</strong> that we can assume that the <em>true</em> relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> takes the form <span class="math inline">\(Y = f(X)+\epsilon\)</span> for some unknown function <span class="math inline">\(f\)</span>, where <span class="math inline">\(\epsilon\)</span> is a mean-zero random error term.
If <span class="math inline">\(f\)</span> is to be approximated by a linear function, then we can write this relationship as</p>
<p><span class="math display" id="eq:lin-rel">\[\begin{equation}
  Y = \beta_0+\beta_1X + \epsilon.
  \tag{2.5}
\end{equation}\]</span></p>
<p>Here <span class="math inline">\(\beta_0\)</span> is the intercept term—that is, the expected value of <span class="math inline">\(Y\)</span> when <span class="math inline">\(X=0\)</span> and <span class="math inline">\(\beta_1\)</span> is the slope—the average increase in <span class="math inline">\(Y\)</span> associated with a one-unit increase in <span class="math inline">\(X\)</span>.
The error term is a catch-all for what we miss with this simple model: the true relationship is probably not linear, there may be other variables that cause variation in <span class="math inline">\(Y\)</span>, and there may be measurement error.
We typically assume that the error term is independent of <span class="math inline">\(X\)</span>.</p>
<p>The model given by <a href="linreg.html#eq:lin-rel">(2.5)</a> defines the <strong><span style="font-family:monospace; color: #1188ce;">population regression line</span></strong>, which is the best linear approximation to the true relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>
The least squares regression coefficient estimates <a href="linreg.html#eq:rssmin">(2.4)</a> characterize the <strong><span style="font-family:monospace; color: #1188ce;">least squares line</span></strong> <a href="linreg.html#eq:linest">(2.2)</a>.</p>
<p>[FIGURE 3.3 HERE]</p>
<p>The left-hand panel of <strong>Figure 3.3</strong> displays these two lines in a simple simulated example. We created 100 random Xs, and generated 100 corresponding Ys from the model</p>
<p><span class="math display" id="eq:sim-mod">\[\begin{equation}
  Y = 2+3X+\epsilon
  \tag{2.6}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\epsilon\)</span> was generated from a normal distribution with mean zero.
The red line in the left-hand panel of Figure 3.3 displays the <em>true</em> relationship, <span class="math inline">\(f(X) = 2 + 3X\)</span>, while the blue line is the least squares estimate based on the observed data.
The true relationship is generally not known for real data, but the least squares line can always be computed using the coefficient estimates given in <a href="linreg.html#eq:rssmin">(2.4)</a>.
In other words, in real applications, we hav eaccess to a set of observations from which we can compute the lease squares line; however, the population regression line is unobserved.
In the right-hand panel of Figure 3.3 we have generated ten different data sets from the model given by <a href="linreg.html#eq:sim-mod">(2.6)</a> and plotted the corresponding ten least squares lines.
Notice that different data sets generated from the same true model result in slightly different least squares lines, but the unobserved population regression line does not change.</p>
<p>At first glance, the difference between the population regression line and the least squares line may seem subtle and confusing.
We only have one data set, and so what does it mean that two different lines describe the relationship between the predictor and the response?
Fundamentally the concept of these two lines is a natural extension of the standard statistical approach of using information from a sample to estimate characteristics of a large population.
For example, suppose that we are interested in knowing the population mean <span class="math inline">\(\mu\)</span> of some random variable <span class="math inline">\(Y\)</span>.<br />
Unfortunately, <span class="math inline">\(\mu\)</span> is unknoqn, but we do have access to <span class="math inline">\(n\)</span> observations from <span class="math inline">\(Y\)</span>, which we can write as <span class="math inline">\(y_1, ..., y_n\)</span>, and which we can use to estimate <span class="math inline">\(\mu\)</span>.
A reasonable estimate is <span class="math inline">\(\hat{\mu} = \bar{y}\)</span>, where <span class="math inline">\(\bar{y} = \frac{1}{n}\sum^{n}_{i=1}{y_i}\)</span> is the sample mean.
The sample mean and the population mean are different, but in general the sample mean will provide a good estimate of the population mean.
In the same way, the unknown coefficients <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> in linear regression define the population regression line.
We seek to estimate these unknown coefficients using <span class="math inline">\(\hat{\beta_0}\)</span> and <span class="math inline">\(\hat{\beta_1}\)</span> given in <a href="linreg.html#eq:rssmin">(2.4)</a>.
These coefficient estimates define the least squares line.</p>
<p>The analogy between linear regression and estimation of the mean of a random variable is an apt one based on the concept of <strong><span style="font-family:monospace; color: #1188ce;">bias</span></strong>.
If we use the sample mean <span class="math inline">\(\hat{\mu}\)</span> to estimate <span class="math inline">\(\mu\)</span>, this estimate is <strong><span style="font-family:monospace; color: #1188ce;">unbiased</span></strong>, in the sense that on average, we expect <span class="math inline">\(\hat{\mu}\)</span> to equal <span class="math inline">\(\mu\)</span>.
What exactly does this mean?
It means that on the basis of one particular set of observations <span class="math inline">\(y_1,...,y_n,\; \hat{\mu}\)</span> might overestimate <span class="math inline">\(\mu\)</span>, and on the basis of another set of observations, <span class="math inline">\(\hat{\mu}\)</span> might underestimate <span class="math inline">\(\mu\)</span>.
But if we could average a huge number of estimates of <span class="math inline">\(\mu\)</span> obtained from a huge number of sets of observations, then this average would <em>exactly</em> equal <span class="math inline">\(\mu\)</span>.
Hence, an unbiased estimator does not _systematically) over- or under-estimate the true parameter.
The property of unbiasedness holds for the least squares coefficient estimates given by <a href="linreg.html#eq:rssmin">(2.4)</a> as well: if we estimate <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> on the basis of a particular data set, then the average of these estimates would be spot on!<br />
In fact, we can see from the right-hand panel on Figure 3.3 that the average of many least squares lines, each estimated from a separate data set, is pretty close to the true population regression line.</p>
<p>We continue the analogy with the estimation of the population mean <span class="math inline">\(\mu\)</span> of a random variable <span class="math inline">\(Y\)</span>.<br />
A natural question is as follows: how accurate is the sample mean <span class="math inline">\(\hat{\mu}\)</span> as an estimate of <span class="math inline">\(\mu\)</span>?
We have established that the average of <span class="math inline">\(\hat{\mu}\)</span>’s over many data sets will be very close to <span class="math inline">\(\mu\)</span>, but that a single estimate <span class="math inline">\(\hat{\mu}\)</span> may be a substantial underestimate or overestimate of <span class="math inline">\(\mu\)</span>.
How far off will that single estimate of <span class="math inline">\(\hat{\mu}\)</span> be?
In general, we answer this question by computing the <strong><span style="font-family:monospace; color: #1188ce;">standard error</span></strong> of <span class="math inline">\(\hat{\mu}\)</span>, written as <span class="math inline">\(SE(\hat{\mu})\)</span>.
We have the well-known formula</p>
<p><span class="math display" id="eq:mu-se">\[\begin{equation}
Var(\hat{\mu}) = SE(\hat{\mu})^2 = \frac{\sigma^2}{n} \tag{2.7}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\sigma\)</span> is the standard deviation of each of the realizations <span class="math inline">\(y_i\)</span> of <span class="math inline">\(Y\)</span>.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>
Roughly speaking, the standard error tells us the average amount that this estimate <span class="math inline">\(\hat{\mu}\)</span> differs from the actual value of <span class="math inline">\(\mu\)</span>.
Equation <a href="linreg.html#eq:mu-se">(2.7)</a> also tells us how this deviation shrinks with <em>n</em>—themore observations we have, the smaller the standard error of <span class="math inline">\(\hat{\mu}\)</span>.
In a similar vein, we can wonder how close <span class="math inline">\(\hat{\beta_0}\)</span> and <span class="math inline">\(\hat{\beta_1}\)</span> are to the true values <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>/
To compute the standard errors associated with <span class="math inline">\(\hat{\beta_0}\)</span> and <span class="math inline">\(\hat{\beta_1}\)</span>, we use the following formulas:</p>
<p><span class="math display" id="eq:beta-se">\[\begin{equation}
SE(\hat{\beta_0})^2 = \sigma^2 \left[ \frac{1}{n} + \frac{\bar{x}^2}{\sum_{i=1}^n (x_i - \bar{x})^2} \right] , 
\hspace{1cm} 
SE(\hat{\beta_1})^2 = \frac{\sigma^2}{\sum_{i=1}^n (x_i - \bar{x})^2} , \tag{2.8}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\sigma^2 = Var(\epsilon)\)</span>.
For these formulas to be strictly valid, we need to assume that the errors <span class="math inline">\(\epsilon_i\)</span> for each observation are uncorrelated with common variance <span class="math inline">\(\sigma^2\)</span>.
This is clearly not true in Figure <a href="linreg.html#fig:advertising-lm">2.1</a>, but the formula still turns out to be a good approximation.
Notice in the formula that <span class="math inline">\(SE(\hat{\beta_1}\)</span> is smaller when the <span class="math inline">\(x_i\)</span> are more spread out; intuitively we have more <em>leverage</em> to estimate a slope when this is the case.
We also see that <span class="math inline">\(SE(\hat{\beta_0})\)</span> would be the same as <span class="math inline">\(SE(\hat{\mu})\)</span> if <span class="math inline">\(\bar{x}\)</span> were zero (in which case <span class="math inline">\(\hat{\beta_0}\)</span> would be equal to <span class="math inline">\(\bar{y}\)</span>).
In general, <span class="math inline">\(\sigma^2\)</span> is not known, but can be estimated from the data.
The estimate of <span class="math inline">\(\sigma\)</span> is known as the <strong><span style="font-family:monospace; color: #1188ce;">residual standard error</span></strong>, and is given by the formula <span class="math inline">\(RSE = \sqrt{RSS/(n-2)}\)</span>.
Strictly speaking, when <span class="math inline">\(\sigma^2\)</span> is estimated from the data we should write <span class="math inline">\(\widehat{SE}(\hat{\beta_1})\)</span> to indicate that an estimate has been made, but for simplicity of notation we will drop this extra “hat”.</p>
<p>Standard errors can be used to compute <strong><span style="font-family:monospace; color: #1188ce;">confidence intervals</span></strong>.
A 95% confidence interval is defined as a range of values such that with 95% probability, the range will contain the true unknown value of the parameter.
The range is defined in terms of lower and upper limits computed from the sample of data.
For linear regression, the 95% confidence interval for <span class="math inline">\(\beta_1\)</span> approximately takes the form</p>
<p><span class="math display" id="eq:b1-ci">\[\begin{equation}
\hat{\beta_1} \pm 2 \cdot SE(\hat{\beta_1}). \tag{2.9}
\end{equation}\]</span></p>
<p>That is, there is approximately a 95% chance that the interval</p>
<p><span class="math display" id="eq:b1-interval">\[\begin{equation}
\left[ \hat{\beta_1} - 2 \cdot SE(\hat{\beta_1}), \hat{\beta_1} + 2 \cdot SE(\hat{\beta_1}) \right] \tag{2.10}
\end{equation}\]</span></p>
<p>will contain the true value of <span class="math inline">\(\beta_1\)</span>.<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>
Similarly, a confidence interval for <span class="math inline">\(\beta_0\)</span> approximately takes the form</p>
<p><span class="math display" id="eq:b0-ci">\[\begin{equation}
\hat{\beta_0} \pm 2 \cdot SE(\hat{\beta_0}). \tag{2.11}
\end{equation}\]</span></p>
<p>In the case of the advertising data, the 95% confidence interval for <span class="math inline">\(\beta_0\)</span> is <span class="math inline">\([6.130, 7.935]\)</span> and the 95% confidence interval for <span class="math inline">\(\beta_1\)</span> is <span class="math inline">\([0.042, 0.053]\)</span>.
Therefore, we can conclude that in the absence of any advertising, sales will, on average, fall somewhere between 6,130 and 7,940 units.
Furthermore, for each $1,000 increase in television advertising, there will be an average increase in sales of between 42 and 53 units.</p>
<p>Standard errors can also be used to perform <strong><span style="font-family:monospace; color: #1188ce;">hypothesis tests</span></strong> on the coefficients.
The most common hypothesis test involves testing the <strong><span style="font-family:monospace; color: #1188ce;">null hypothesis</span></strong> of</p>
<p><span class="math display" id="eq:h-null">\[\begin{equation}
H_0: \mathrm{There\ is\ no\ relationship\ between}\ X\ \mathrm{and}\ Y \tag{2.12}
\end{equation}\]</span></p>
<p>versus the <strong><span style="font-family:monospace; color: #1188ce;">alternative hypothesis</span></strong></p>
<p><span class="math display" id="eq:h-a">\[\begin{equation}
H_a: \mathrm{There\ is\ some\ relationship\ between}\ X\ \mathrm{and}\ Y. \tag{2.13}
\end{equation}\]</span></p>
<p>Mathematically, this corresponds to testing</p>
<p><span class="math display">\[H_0: \beta_1 = 0\]</span></p>
<p>versus</p>
<p><span class="math display">\[H_a: \beta_1 \neq 0.\]</span></p>
<p>since if <span class="math inline">\(\beta_1 = 0\)</span> then the model <a href="linreg.html#eq:lin-rel">(2.5)</a> reduces to <span class="math inline">\(Y = \beta_0 + \epsilon\)</span>, and <span class="math inline">\(X\)</span> is not associated with <span class="math inline">\(Y\)</span>.
To test the null hypothesis, we need to determine whether <span class="math inline">\(\hat{\beta_1}\)</span>, our estimate for <span class="math inline">\(\beta_1\)</span>, is sufficiently far from zero that we can be confident that <span class="math inline">\(\beta_1\)</span> is non-zero.
How far is enough?
This of course depends on the accuracy of <span class="math inline">\(\hat{\beta_1}\)</span>—that is, it depends on <span class="math inline">\(SE(\hat{\beta_1})\)</span>.
If <span class="math inline">\(SE(\hat{\beta_1})\)</span> is small, then even relatively small values of <span class="math inline">\(\hat{\beta_1}\)</span> may provide strong evidence that <span class="math inline">\(\beta_1 \neq 0\)</span>, and hence that there is a relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>.
In contrast, if <span class="math inline">\(SE(\hat{\beta_1})\)</span> is large, then <span class="math inline">\(\hat{\beta_1}\)</span> must be large in absolute value in order for us to reject the null hypothesis.
In practice, we compute a <strong><span style="font-family:monospace; color: #1188ce;">t-statistic</span></strong>, give by</p>
<p><span class="math display" id="eq:t-stat">\[\begin{equation}
t = \frac{\hat{\beta_1}-0}{SE(\hat{\beta_1})} , \tag{2.14}
\end{equation}\]</span></p>
<p>which measures the number of standard deviations that <span class="math inline">\(\hat{\beta_1}\)</span> is away from 0.
If there really is no relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, then we expect that <a href="linreg.html#eq:t-stat">(2.14)</a> will have a <em>t</em>-distribution with <span class="math inline">\(n-2\)</span> degrees of freedom.
The t-distribution has a bell shape and for values of <em>n</em> greater than approximately 30 it is quite similar to the normal distribution.
Consequently, it is a simple matter to compute the probability of observing any number equal to <span class="math inline">\(|t|\)</span> or larger in absolute value, assuming <span class="math inline">\(\beta_1 = 0\)</span>.
We call this probability the <strong><span style="font-family:monospace; color: #1188ce;">p-value</span></strong>.
Roughly speaking, we interpret the p-value as follows: a small p-value indicates that it is unlikely to observe such a substantial association between the predictor and the response due to chance, in the absence of any real association between the predictor and the response.
Hence, if we see a small p-value, then we can infer that there is an association between the predictor and the response.
We <em>reject the null hypothesis</em>—that is, we declare a relationship to exist between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>—if the p-value is amll enough.
Typical p-value cutoffs for rejecting the null hypothesis are 5 or 1%.
When <span class="math inline">\(n=30\)</span>, these correspond to t-statistics <a href="linreg.html#eq:t-stat">(2.14)</a> of around 2 and 2.75, respectively.</p>
<p>{ Table 3.1 goes here }</p>
<p>Table 3.1 provides details of the least squares model for the regression of number of units sold on TV advertising budget for the <code>Advertising</code> data.
Notice that the coefficients for <span class="math inline">\(\hat{\beta_0}\)</span> and <span class="math inline">\(\hat{\beta_1}\)</span> are very large relative to their standard errors, so the t-statistics are also large; the probabilities of seeing such values if <span class="math inline">\(H_0\)</span> is true are virtually zero.
Hence we can conclude that <span class="math inline">\(\beta_0 \neq 0\)</span> and <span class="math inline">\(\beta_1 \neq 0\)</span>.<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a></p>
</div>
<div id="assess-model-acc" class="section level3">
<h3><span class="header-section-number">2.1.3</span> Assessing the Accuracy of the Model</h3>
<p>Once we have rejected the null hypothesis <a href="linreg.html#eq:h-null">(2.12)</a> in favor of the alternative hypothesis <a href="linreg.html#eq:h-a">(2.13)</a>, it is natural to want to quantify <em>the extent to which the model fits the data</em>.
The quality of a linear regression fit is typically assessed using two related quantities: the <em>residual standard error</em> and the <span class="math inline">\(\color{#1188ce}{R^2}\)</span> statistic.</p>
<p>Table 3.2 displays the RSE, the <span class="math inline">\(R^2\)</span> statistic, and the F-statistic (to be described in Section 3.2.2) for the linear regression of number of units sold on TV advertising budget.</p>
<div id="residual-standard-error" class="section level4 unnumbered">
<h4>Residual Standard Error</h4>
<p>Recall from the model <a href="linreg.html#eq:lin-rel">(2.5)</a> that associated with each observation is an error term <span class="math inline">\(\epsilon\)</span>.
Due to the presence of these error terms, even if we knew the true regression line (i.e. even if <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> were known), we would not be able to perfectly predict <span class="math inline">\(Y\)</span> from <span class="math inline">\(X\)</span>.
The RSE is an estimate of the standard deviation of <span class="math inline">\(\epsilon\)</span>.</p>
<p>{Table 3.2 goes here}</p>
<p>Roughly speaking, it is the average amount that the response will deviate from the true regression line.
It is computed using the formula</p>
<p><span class="math display" id="eq:rse">\[\begin{equation}
RSE = \sqrt{\frac{1}{n-2}RSS} = \sqrt{\frac{1}{n-2} \sum_{i=1}^{n} (y_i - \hat{y_i})^2} . \tag{2.15}
\end{equation}\]</span></p>
<p>Note that RSS was defined in Section 3.1.1, and is given by the formula</p>
<p><span class="math display" id="eq:rss-redefined">\[\begin{equation}
RSS = \sum_{i=1}^{n} (y_i - \hat{y_i})^2 . \tag{2.16}
\end{equation}\]</span></p>
<p>In the case of the advertising data, we see from the linear regression output in Table 3.2 that the RSE is 3.26.
In other words, actual sales in each market deviate from the true regression line by approximately 3,260 units, on average.
Another way to think about this is that even if the model were correct and the true values of the unknown coefficients <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> were known exactly, any prediction of sales on the basis of TV advertising would still be off by about 3,260 units on average.
Of course, whether or not 3,260 units is an acceptable prediction error depends on the problem context.
In the advertising data set, the mean value of <code>sales</code> over all markets is approximately 14,000 units, and so the percentage error is <span class="math inline">\(3,260/14,000 = 23\%\)</span>.</p>
<p>The RSE is considered a measure of the <em>lack of fit</em> of the model <a href="linreg.html#eq:lin-rel">(2.5)</a> to the data.
If the predictions obtained using the model are very close to the true outcome values—that is, if <span class="math inline">\(\hat{y_i} \approx y_i\)</span> for <span class="math inline">\(i = 1, ..., n\)</span>—then <a href="linreg.html#eq:rse">(2.15)</a> will be small, and we can conclude that the model fits the data very well.
On the other hand, if <span class="math inline">\(\hat{y_i}\)</span> is very far from <span class="math inline">\(y_i\)</span> for one or more observations, then the RSE may be quite large, indicating that the model doesn’t fit the data well.</p>
</div>
<div id="r2-statistic" class="section level4 unnumbered">
<h4><em>R</em><sup>2</sup> Statistic</h4>
<p>The RSE provides an absolute measure of lack of fit of the model <a href="linreg.html#eq:lin-rel">(2.5)</a> to the data.
But since it is measured in the units of <span class="math inline">\(Y\)</span>, it is not always clear what constitutes a good RSE.
The <span class="math inline">\(R^2\)</span> statistic provides an alternative measure of fit.
It takes the form of a <em>proportion</em>—the proportion of variance explained—and so it always takes on a value between 0 and 1, and is independent of the scale of <span class="math inline">\(Y\)</span>.</p>
<p>To calculate <span class="math inline">\(R^2\)</span>, we use the formula</p>
<p><span class="math display" id="eq:rsquared">\[\begin{equation}
R^2 = \frac{TSS-RSS}{TSS} = 1 - \frac{RSS}{TSS} \tag{2.17}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(TSS = \sum (y_i - \bar{y})^2\)</span> is the <strong><span style="font-family:monospace; color: #1188ce;">total sum of squares</span></strong>, and the RSS is defined in <a href="linreg.html#eq:rss-redefined">(2.16)</a>.
TSS measures the total variance in the response <span class="math inline">\(Y\)</span>, and can be thought of as the amount of variability inherent in the response before the regression is performed.
In contrast, RSS measures the amount of variability that is left unexplained after performing the regression.
Hence, <span class="math inline">\(TSS - RSS\)</span> measures the amount of variability in the response that is explained (or removed) by performing the regression, and <span class="math inline">\(R^2\)</span> measures the <em>proportion of variability in Y that can be explained using X</em>.
An <span class="math inline">\(R^2\)</span> statistic that is close to 1 indicates that a large proportion of the variability in the response has been explained by the regression.
A number near 0 indicates that the regression did not explain much of the variability in the response; this might occur because the linear model is wrong, or the inherent error <span class="math inline">\(\sigma^2\)</span> is high, or both.
In Table 3.2, the <span class="math inline">\(R^2\)</span> was 0.61, and so just under two-thirds of the variability in <code>sales</code> is explained by a linear regression on <code>TV</code>.</p>
<p>The <span class="math inline">\(R^2\)</span> statistic is a measure of the linear relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>.
Recall that <strong><span style="font-family:monospace; color: #1188ce;">correlation</span></strong>, defined as</p>
<p><span class="math display" id="eq:correlation">\[\begin{equation}
Cor(X,Y) = \frac{\sum_{i=1}^{n}(x_i - \bar{x})(y_i - \bar{y})}{\sqrt{\sum_{i=1}^{n} (x_i - \bar{x})^2} \sqrt{\sum_{i=1}^{n} (y_i - \bar{y})^2}}, \tag{2.18}
\end{equation}\]</span></p>
<p>is also a measure of the linear relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>.<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a>
This suggests that we might be able to use <span class="math inline">\(r = Cor(X,Y)\)</span> instead of <span class="math inline">\(R^2\)</span> in order to assess the fit of the linear model.
In fact, it can be shown that in the simple linear regression setting, <span class="math inline">\(R^2 = r^2\)</span>.
In other words, the squared correlation and the <span class="math inline">\(R^2\)</span> statistic are identical.
However, in the next section we will discuss the multiple linear regression problem, in which we use several predictors simultaneously to predict the response.
The concept of correlation between the predictors and the response does not extend automatically to this setting, since correlation quantifies the association between a single pair of variables rather than between a larger number of variables.
We will see that <span class="math inline">\(R^2\)</span> fills this role.</p>
</div>
</div>
</div>
<div id="mult-lin-reg" class="section level2">
<h2><span class="header-section-number">2.2</span> Multiple Linear Regression</h2>
<p>Simple linear regression is a useful approach for predicting a response on the basis of a single predictor variable.
However, in practice we often have more than one predictor.
For example, in the <code>Advertising</code> data, we have examined the relationship between sales and TV advertising.
We also have data for the amount of money spent on advertising on the radio and in newspapers, and we may want to know whether either of these two media is associated with sales.
How can we extend our analysis of the advertising data in order to accommodate these two additional predictors?</p>
<p>One option is to run three separate simple linear regressions, each of which uses a different advertising medium as a predictor.
For instance, we can fit a simple linear regression to predict sales on the basis of the amount spent on radio advertisements.
Results are shown in Table 3.3 (top table).
We find that a $1,000 increase in spending on radio advertising is associated with an increase in sales by around 203 units.
Table 3.3 (bottom table) contains the least squares coefficients for a simple linear regression of sales onto newspaper advertising budget.
A $1,000 increase in newspaper advertising budget is associated with an increase in sales by approximately 55 units.</p>
<p>However, the approach of fitting a separate simple linear regression model for each predictor is not entirely satisfactory.
First of all, it is unclear how to make a single prediction of sales given levels of the three advertising media budgets, since each of the budgets is associated with a separate regression equation.
Second, each of the three regression equations ignores the other two media in forming estimates for the regression coefficients.
We will see shortly that if the media budgets are correlated with each other in the 200 markets that constitute our data set, then this can lead to very misleading estimates of the individual media effects on sales.</p>
<p>Instead of fitting a separate simple linear regression model for each predictor, a better approach is to extend the simple linear regression model <a href="linreg.html#eq:lin-rel">(2.5)</a> so that it can directly accommodate multiple predictors.
We can do this by giving each predictor a separate slope coefficient in a single model.
In general, suppose that we have <em>p</em> distinct predictors.
Then the multiple linear regression model takes the form</p>
<p><span class="math display" id="eq:mlin-reg">\[\begin{equation}
  Y = \beta_0+\beta_1X_1 +\beta_2X_2 + ... +\beta_pX_p + \epsilon,
  \tag{2.19}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(X_j\)</span> represents the <em>j</em>th predictor and <span class="math inline">\(\beta_j\)</span> quantifies the association between that variable and the response.
We interpret <span class="math inline">\(\beta_j\)</span> as the <em>average</em> effect on <span class="math inline">\(Y\)</span> of a one unit increase in <span class="math inline">\(X_j\)</span>, <em>holding all other predictors fixed</em>.
In the advertising example, <a href="linreg.html#eq:mlin-reg">(2.19)</a> becomes</p>
<p><span class="math display" id="eq:mlin-reg-adv">\[\begin{equation}
  \color{#B44C1C}{\textbf{sales}} = \beta_0 + \beta_1 \times \color{#B44C1C}{\textbf{TV}}+\beta_2 \times \color{#B44C1C}{\textbf{radio}}+\beta_3 \times \color{#B44C1C}{\textbf{newspaper}}+ \epsilon. \tag{2.20}
\end{equation}\]</span></p>
<div id="est-reg-coef" class="section level3">
<h3><span class="header-section-number">2.2.1</span> Estimating the Regression Coefficients</h3>
<p>As was the case in the simple linear regression setting, the regression coefficients <span class="math inline">\(\beta_0, \beta_1, ..., \beta_p\)</span> in <a href="linreg.html#eq:mlin-reg">(2.19)</a> are unknown, and must be estimated.
Given estimates <span class="math inline">\(\hat{\beta_0}, \hat{\beta_1}, ..., \hat{\beta_p}\)</span>, we can make predictions using the formula</p>
<p><span class="math display" id="eq:mlin-reg-est">\[\begin{equation}
  \hat{y} = \hat{\beta_0}+\hat{\beta_1}x_1 +\hat{\beta_2}x_2 + ... +\hat{\beta_p}x_p + \epsilon,
  \tag{2.21}
\end{equation}\]</span></p>
<p>The parameters are estimated using the same least squares approach that we saw in the context of simple linear regression.
We choose <span class="math inline">\(\beta_0, \beta_1, ..., \beta_p\)</span> to minimize the sum of squared residuals</p>
<p><span class="math display" id="eq:m-rssmin">\[\begin{equation} 
\begin{aligned}
  RSS &amp;= \sum_{i=1}^{n} (y_i-\hat{y})^2 \\
      &amp;= \sum_{i=1}^{n} (y_i-\hat{\beta_0} - \hat{\beta_1}x_{i1} - \hat{\beta_2}x_{i2} - ... - \hat{\beta_p}x_{ip})^2.
  \end{aligned}
  \tag{2.22}
\end{equation}\]</span></p>
<p>The values <span class="math inline">\(\hat{\beta_0}, \hat{\beta_1}, ..., \hat{\beta_p}\)</span> that minimize <a href="linreg.html#eq:m-rssmin">(2.22)</a> are the multiple least squares regression coefficient estimates.
Unlike the simple linear regression estimates given in <a href="linreg.html#eq:rssmin">(2.4)</a>, the multiple regression coefficient estimates have somewhat complicated forms that are most easily represented using matrix algebra.
For this reason, we do not provide them here.
Any statistical software package can be used to compute these coefficient estimates, and later in this chapter we will show how this can be done in <code>R</code>.
Figure 3.4 illustrates an example of the least squares fit to a toy data set with <span class="math inline">\(p = 2\)</span> predictors.</p>
<p>Table 3.4 displays the multiple regression coefficient estimates when TV, radio, and advertising budgets are used to predict product sales using the <code>Advertising</code> data.
We interpret these results as follows: for a given amount of TV and newspaper advertising, spending an additional $1,000 on radio advertising leads to an increase in sales by approximately 189 units.
Comparing these coefficient estimates to those displayed in Table 3.1 and 3.3, we notice that the multiple regression coefficient estimates for <code>TV</code> and <code>radio</code> are pretty similar to the simple linear regression coefficient estimates.
However, while the <code>newspaper</code> regression coefficient estimate in Table 3.3 was significantly non-zero, the coefficient estimate for <code>newspaper</code> in the multiple regression model is close to zero, and the corresponding p-value is no longer significant, with a value around 0.86.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="linreg.html#cb5-1"></a><span class="co"># estimate linear model</span></span>
<span id="cb5-2"><a href="linreg.html#cb5-2"></a>advertising_mlin_reg =<span class="st"> </span><span class="kw">lm</span>(sales<span class="op">~</span>TV<span class="op">+</span>radio<span class="op">+</span>newspaper, <span class="dt">data =</span> advertising)</span>
<span id="cb5-3"><a href="linreg.html#cb5-3"></a></span>
<span id="cb5-4"><a href="linreg.html#cb5-4"></a><span class="co"># Clean up the model output</span></span>
<span id="cb5-5"><a href="linreg.html#cb5-5"></a><span class="kw">prep_reg_table</span>(advertising_mlin_reg) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb5-6"><a href="linreg.html#cb5-6"></a><span class="st">  </span><span class="co"># use reactable to produce the table</span></span>
<span id="cb5-7"><a href="linreg.html#cb5-7"></a><span class="st">  </span><span class="kw">reactable</span>(</span>
<span id="cb5-8"><a href="linreg.html#cb5-8"></a>    <span class="dt">borderless =</span> T,</span>
<span id="cb5-9"><a href="linreg.html#cb5-9"></a>    <span class="dt">sortable =</span> F,</span>
<span id="cb5-10"><a href="linreg.html#cb5-10"></a>    <span class="dt">defaultColDef =</span> <span class="kw">colDef</span>(<span class="dt">format =</span> <span class="kw">colFormat</span>(<span class="dt">digits =</span> <span class="dv">3</span>)),</span>
<span id="cb5-11"><a href="linreg.html#cb5-11"></a>    <span class="co"># Specific column formats</span></span>
<span id="cb5-12"><a href="linreg.html#cb5-12"></a>    <span class="dt">columns =</span> <span class="kw">list</span>(</span>
<span id="cb5-13"><a href="linreg.html#cb5-13"></a>      <span class="dt">term =</span> <span class="kw">colDef</span>(</span>
<span id="cb5-14"><a href="linreg.html#cb5-14"></a>        <span class="dt">name =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb5-15"><a href="linreg.html#cb5-15"></a>        <span class="dt">style =</span> <span class="kw">list</span>(<span class="dt">borderRight =</span> <span class="st">&quot;2px solid black&quot;</span>,</span>
<span id="cb5-16"><a href="linreg.html#cb5-16"></a>                                 <span class="dt">color =</span> <span class="st">&quot;#B44C1C&quot;</span>,</span>
<span id="cb5-17"><a href="linreg.html#cb5-17"></a>                                 <span class="dt">fontFamily =</span> <span class="st">&quot;Roboto Mono&quot;</span>),</span>
<span id="cb5-18"><a href="linreg.html#cb5-18"></a>        <span class="dt">headerStyle =</span> <span class="kw">list</span>(<span class="dt">borderRight =</span> <span class="st">&quot;2px solid black&quot;</span>)),</span>
<span id="cb5-19"><a href="linreg.html#cb5-19"></a>      <span class="st">`</span><span class="dt">t-statistic</span><span class="st">`</span> =<span class="st"> </span><span class="kw">colDef</span>(<span class="dt">format =</span> <span class="kw">colFormat</span>(<span class="dt">digits =</span> <span class="dv">2</span>))</span>
<span id="cb5-20"><a href="linreg.html#cb5-20"></a>    )</span>
<span id="cb5-21"><a href="linreg.html#cb5-21"></a>  )</span>
<span id="cb5-22"><a href="linreg.html#cb5-22"></a></span>
<span id="cb5-23"><a href="linreg.html#cb5-23"></a><span class="co"># Put the caption beneath the table</span></span>
<span id="cb5-24"><a href="linreg.html#cb5-24"></a><span class="kw">rt_caption</span>(</span>
<span id="cb5-25"><a href="linreg.html#cb5-25"></a>  <span class="dt">text =</span> <span class="kw">str_c</span>(<span class="st">&quot;For the &quot;</span>, <span class="kw">data_colour</span>(<span class="st">&quot;Advertising&quot;</span>), <span class="st">&quot; data, least squares coefficient estimates of the multiple linear regression of number of units sold on radio, TV, and newspaper advertising budgets.&quot;</span>), </span>
<span id="cb5-26"><a href="linreg.html#cb5-26"></a>  <span class="dt">tab_num =</span> <span class="fl">3.4</span></span>
<span id="cb5-27"><a href="linreg.html#cb5-27"></a>  )</span></code></pre></div>
<p><div id="htmlwidget-546b431222798b5b056c" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-546b431222798b5b056c">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"term":["Intercept","TV","radio","newspaper"],"Coefficient":[2.93888936945942,0.0457646454553976,0.188530016918204,-0.00103749304247626],"Std. Error":[0.311908236321791,0.00139489680697498,0.00861123396730194,0.00587100964708637],"t-statistic":[9.42228844007638,32.8086244276697,21.8934960580654,-0.176714586560276],"p-value":["<0.0001","<0.0001","<0.0001","0.8599"]},"columns":[{"accessor":"term","name":"","type":"character","format":{"cell":{"digits":3},"aggregated":{"digits":3}},"style":{"borderRight":"2px solid black","color":"#B44C1C","fontFamily":"Roboto Mono"},"headerStyle":{"borderRight":"2px solid black"}},{"accessor":"Coefficient","name":"Coefficient","type":"numeric","format":{"cell":{"digits":3},"aggregated":{"digits":3}}},{"accessor":"Std. Error","name":"Std. Error","type":"numeric","format":{"cell":{"digits":3},"aggregated":{"digits":3}}},{"accessor":"t-statistic","name":"t-statistic","type":"numeric","format":{"cell":{"digits":2},"aggregated":{"digits":2}}},{"accessor":"p-value","name":"p-value","type":"character","format":{"cell":{"digits":3},"aggregated":{"digits":3}}}],"sortable":false,"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"borderless":true,"theme":{"color":"#333","tableStyle":{"borderTop":"2px solid black","borderBottom":"2px solid black"},"headerStyle":{"borderBottom":"2px solid black"}},"dataKey":"5f2607354a493267c6d0fb92eee9decb","key":"5f2607354a493267c6d0fb92eee9decb"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script><p class="caption">
<span class="tab-num">TABLE 3.4.</span>
<em>For the <strong><span style='font-family:monospace; color: #B44C1C;'>Advertising</span></strong> data, least squares coefficient estimates of the multiple linear regression of number of units sold on radio, TV, and newspaper advertising budgets.</em>
</p></p>
<p>This illustrates that the simple and multiple regression coefficients can be quite different.
This difference stems from the fact that in the simple regression case, the slope term represents the average effect of a $1,000 increase in newspaper advertising, ignoring other predictors such as <code>TV</code> and <code>radio</code>.
In contrast, in the multiple regression setting, the coefficient for <code>newspaper</code> represents the average effect of increasing newspaper spending by $1,000 while holding <code>TV</code> and <code>radio</code> fixed.</p>
<p>Does it make sense for the multiple regression to suggest no relationship between <code>sales</code> and <code>newspaper</code> while the simple linear regression implies the opposite?
In fact it does.
Consider the correlation matrix for the three predictor variables and response variable, displayed in Table 3.5.
Notice that the correlation between <code>radio</code> and <code>newspaper</code> is 0.35.
This reveals a tendency to spend more on newspaper advertising in markets where more is spent on radio advertising.
Now suppose that the multiple regression is correct and newspaper advertising has no direct impact on sales, but radio advertising does increase sales.
Then in markets where we spend more on radio our sales will tend to be higher, and as our correlation matrix shows, we also tend to spend more on newspaper advertising in those same markets.
Hence, in a simple linear regression which only examines <code>sales</code> versus <code>newspaper</code>, we will observe that higher values of <code>newspaper</code> tend to be associated with higher values of <code>sales</code>, even though newspaper advertising does not actually affect sales.
So <code>newspaper</code> sales are a surrogate for <code>radio</code> advertising; newspaper gets “credit” for the effect of <code>radio</code> on <code>sales</code>.</p>
<p>This slightly counterintuitive result is very common in many real life situations.
Consider an absurd example to illustrate the point.
Running a regression of shark attacks versus ice cream sales for data collected at a given beach community over a period of time would show a positive relationship, similar to that seen between <code>sales</code> and <code>newspaper</code>.
Of course no one (yet) has suggested that ice creams should be banned at beaches to reduce shark attacks.
In reality, higher temperatures cause more people to visit the beach, which in turn results in more ice cream sales and more shark attacks.
A multiple regression of attacks versus ice cream sales and temperature reveals that, as intuition implies, the former predictor is no longer significant after adjusting for temperature.</p>
</div>
<div id="important-questions" class="section level3">
<h3><span class="header-section-number">2.2.2</span> Some Important Questions</h3>
<p>When we perform multiple linear regression, we usually are interested in answering a few important questions.</p>
<ol style="list-style-type: decimal">
<li><p><em>Is at least one of the predictors <span class="math inline">\(X_1 , X_2 , ... , X_p\)</span> useful in predicting the response?</em></p></li>
<li><p><em>Do all the predictors help to explain <span class="math inline">\(Y\)</span>, or is only a subset of the predictors useful?</em></p></li>
<li><p><em>How well does the model fit the data?</em></p></li>
<li><p><em>Given a set of predictor values, what response value should we predict, and how accurate is our prediction?</em></p></li>
</ol>
<p>We now address each of these questions in turn.</p>
<div id="one-is-there-a-relationship-between-the-response-and-predictors" class="section level4">
<h4><span class="header-section-number">2.2.2.1</span> One: Is There a Relationship Between the Response and Predictors?</h4>
<p>Recall that in the simple linear regression setting, in order to determine whether there is a relationship between the response and the predictor we can simply check whether <span class="math inline">\(\beta_1 = 0\)</span>.
In the multiple regression setting with <span class="math inline">\(p\)</span> predictors, we need to ask whether all of the regression coefficients are zero, i.e. whether <span class="math inline">\(\beta_1 = \beta_2 = ... = \beta_p = 0\)</span>.
As in the simple linear regression setting, we use a hypothesis test to answer this question.
We test the null hypothesis,</p>
<p><span class="math display">\[H_0: \beta_1 = \beta_2 = ... = \beta_p = 0\]</span></p>
<p>versus the alternative</p>
<p><span class="math display">\[H_a: \mathrm{at\ least\ one\ \beta_j\ is\ non-zero}\]</span></p>
<p>This hypothesis test is performed by computing the <strong><span style="font-family:monospace; color: #1188ce;">F-statistic</span></strong>,</p>
<p><span class="math display" id="eq:fstat">\[\begin{equation}
  F = \frac{(TSS-RSS)/p}{RSS/(n-p-1)},
  \tag{2.23}
\end{equation}\]</span></p>
<p>where, as with simple linear regression, <span class="math inline">\(TSS = \sum{(y_i - \bar{y})^2}\)</span> and <span class="math inline">\(RSS = \sum{(y_i - \hat{y_i})^2}\)</span>.
If the linear model assumptions are correct, one can show that</p>
<p><span class="math display">\[ E\{RSS/(n-p-1)\} = \sigma^2 \]</span></p>
<p>and that, provided <span class="math inline">\(H_0\)</span> is true.</p>
<p><span class="math display">\[ E\{TSS-RSS/p\} = \sigma^2. \]</span></p>
<p>Hence, when there is no relationship between the response and predictors, one would expect the F-statistic to take on a value close to 1.
On the other hand, if <span class="math inline">\(H_a\)</span> is true, then $ E{TSS-RSS/p} &gt; ^2 $, so we expect <span class="math inline">\(F\)</span> t obe greater than 1.</p>
<p>The F-statistic for the multiple linear regression model obtained by regressing <code>sales</code> onto <code>radio</code>, <code>TV</code>, and <code>newspaper</code> is shown in Table 3.6.
In this example the F-statistic is 570.
Since this is far larger than 1, it provides compelling evidence against the null hypothesis <span class="math inline">\(H_0\)</span>.
In other words, the large F-statistic suggests that at least one of the advertising media must be related to <code>sales</code>.
However, what if the F-statistic had been closer to
1? How large does the F-statistic need to be before we can reject <span class="math inline">\(H_0\)</span> and conclude that there is a relationship?
It turns out that the answer depends on the values of <span class="math inline">\(n\)</span> and <span class="math inline">\(p\)</span>.
When <span class="math inline">\(n\)</span> is large, an F-statistic that is just a little larger than 1 might still provide evidence against <span class="math inline">\(H_0\)</span>.
In contrast, a larger F-statistic is needed to reject <span class="math inline">\(H_0\)</span> if <span class="math inline">\(n\)</span> is small.
When <span class="math inline">\(H_0\)</span> is true, and the errors <span class="math inline">\(\epsilon_i\)</span> have a normal distribution, the F-statistic follows an F-distribution.<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a>
For any given value of <span class="math inline">\(n\)</span> and <span class="math inline">\(p\)</span>, any statistical software package can be used to compute the p-value associated with the F-statistic using this distribution.
Based on this p-value, we can determine whether or not to reject <span class="math inline">\(H_0\)</span>.
For the advertising data, the p-value associated with the F-statistic in Table 3.6 is essentially zero, so we have extremely strong evidence that at least one of the media is associated with increased <code>sales</code>.</p>
<p>In <a href="linreg.html#eq:fstat">(2.23)</a> we are testing <span class="math inline">\(H_0\)</span> that all the coefficients are zero.
Sometimes we want to test that a partiuclar subset of <span class="math inline">\(q\)</span> of the coefficients are zero.
This corresponds to a null hypothesis</p>
<p><span class="math display">\[H_0: \beta_{p-q+1} = \beta_{p-q+2} = ... = \beta_p = 0.\]</span></p>
<p>where for convenience we have put the variables chosen for omission at the end of the list.
In this case we fit a second model that uses all the variables <em>except</em> those last <span class="math inline">\(q\)</span>.
Suppose that the residual sum of squares for that model is <span class="math inline">\(RSS_0\)</span>.
Then the appropriate F-statistic is</p>
<p><span class="math display" id="eq:fstat2">\[\begin{equation}
  F = \frac{(RSS_0 - RSS)/q}{RSS/(n-p-1)}.
  \tag{2.24}
\end{equation}\]</span></p>
<p>Notice that in Table 3.4, for each individual predictor a t-statistic and a p-value were reported.
These provide information about whether each individual predictor is related to the response, after adjusting for the other predictors.
It turns out that each of these are exactly equivalent<a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a> to the F-test that omits that single variable from the model, leaving all others in—i.e. <span class="math inline">\(q=1\)</span> in <a href="linreg.html#eq:fstat2">(2.24)</a>.
So it reports the <em>partial effect</em> of adding that variable to the model.
For instance, as we discussed earlier, these p-values indicate that <code>TV</code> and <code>radio</code> are related to <code>sales</code>, but that there is no evidence that <code>newspaper</code> is associated with <code>sales</code>, in the presence of these two.</p>
<p>Given these individual p-values for each variable, why do we need to look at the overall F-statistic?
After all, it seems likely that if any one of the p-values for the individual variables is very small, then <em>at least one of the predictors is related to the response</em>.
However, this logic is flawed, especially when the number of predictors p is large.</p>
<p>For instance, consider an example in which <span class="math inline">\(p = 100\)</span> and <span class="math inline">\(H_0: \beta_1 = \beta_2 = ... = \beta_p = 0\)</span>is true, so no variable is truly associated with the response.
In this situation, about 5% of the p-values associated with each variable (of the type shown in Table 3.4) will be below 0.05 by chance.
In other words, we expect to see approximately five <em>small</em> p-values even in the absence of any true association between the predictors and the response.
In fact, we are almost guaranteed that we will observe at least one p-value below 0.05 by chance!
Hence, if we use the individual t-statistics and associated p-values in order to decide whether or not there is any association between the variables and the response, there is a very high chance that we will incorrectly conclude that there is a relationship.
However, the F-statistic does not suffer from this problem because it adjusts for the number of predictors.
Hence, if <span class="math inline">\(H_0\)</span> is true, there is only a 5% chance that the F-statistic will result in a p-value below 0.05, regardless of the number of predictors or the number of observations.</p>
<p>The approach of using an F-statistic to test for any association between the predictors and the response works when <span class="math inline">\(p\)</span> is relatively small, and certainly small compared to <span class="math inline">\(n\)</span>.
However, sometimes we have a very large number of variables.
If <span class="math inline">\(p &gt; n\)</span> then there are more coefficients <span class="math inline">\(\beta_j\)</span> to estimate than observations from which to estimate them.
In this case we cannot even fit the multiple linear regression model using least squares, so the F-statistic cannot be used, and neither can most of the other concepts that we have seen so far in this chapter.
When <span class="math inline">\(p\)</span> is large, some of the approaches discussed in the next section, such as <em>forward selection</em>, can be used.
This <strong><span style="font-family:monospace; color: #1188ce;">high-dimensional</span></strong> setting is discussed in greater detail in Chapter 6.</p>
</div>
<div id="two-deciding-on-important-variables" class="section level4">
<h4><span class="header-section-number">2.2.2.2</span> Two: Deciding on Important Variables</h4>
<p>As discussed in the previous section, the first step in a multiple regression analysis is to compute the F-statistic and to examine the associated p-value.
If we conclude on the basis of that p-value that at least one of the predictors is related to the response, then it is natural to wonder which are the guilty ones!
We could look at the individual p-values as in Table 3.4,
but as discussed, if p is large we are likely to make some false discoveries.
It is possible that all of the predictors are associated with the response, but it is more often the case that the response is only related to a subset of the predictors.
The task of determining which predictors are associated with the response, in order to fit a single model involving only those predictors, is referred to as <strong><span style="font-family:monospace; color: #1188ce;">variable selection</span></strong>.
The variable selection problem is studied extensively in Chapter 6, and so here we will provide only a brief outline of some classical approaches.</p>
<p>Ideally, we would like to perform variable selection by trying out a lot of different models, each containing a different subset of the predictors.
For instance, if <span class="math inline">\(p = 2\)</span>, then we can consider four models: (1) a model containing no variables, (2) a model containing <span class="math inline">\(X_1\)</span> only, (3) a model containing <span class="math inline">\(X_2\)</span> only, and (4) a model containing both <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span>.
We can then select the <em>best</em> model out of all the models that we have considered.
How do we determine which model is best?
Various statistics can be used to judge the quality of a model.
These include <span class="math inline">\(\color{#1188ce}{Mallow&#39;s\ C_p}\)</span>, <strong><span style="font-family:monospace; color: #1188ce;">Akaike information criterion</span></strong> (AIC), <strong><span style="font-family:monospace; color: #1188ce;">Bayesian information criterion</span></strong> (BIC), and <span class="math inline">\(\color{#1188ce}{adjusted\ R^2}\)</span>*.
These are discussed in more detail in Chapter 6.
We can also determine which model is best by plotting various model outputs, such as the residuals, in order to search for patterns.</p>
<p>Unfortunately, there are a total of <span class="math inline">\(2^p\)</span> models that contain subsets of <em>p</em> variables.
This means that even for moderate <em>p</em>, trying out every possible subset of predictors is infeasible.
For instance, we saw that if <em>p</em> = 2, then there are <span class="math inline">\(2^2\)</span> = 4 models to consider.
But if <em>p</em> = 30, then we must consider <span class="math inline">\(2^30\)</span> = 1,073,741824 models!
This is not practical.
Therefore, unless <em>p</em> is very small, we cannot consider all <span class="math inline">\(2^p\)</span> models, and instead we need an automated and efficient approach to choose a smaller set of models to consider.
There are three classical approaches for this task:</p>
<ul>
<li><strong><span style="font-family:monospace; color: #1188ce;">Forward selection</span></strong>.
We begin with the <strong><span style="font-family:monospace; color: #1188ce;">null model</span></strong>—a model that contains an intercept but no predictors.
We then fit <em>p</em> simple linear regressions and add to the null model the variable that results in the lowest RSS.
We then add to that model the variable that results in the lowest RSS for the new two-variable model.
This approach is continued until some stopping rule is satisfied.</li>
<li><strong><span style="font-family:monospace; color: #1188ce;">Backward selection</span></strong>.
We start with all variables in the model, and remove the variable with the largest p-value—that is, the variable that is the least statistically significant.
The new (<em>p</em> - 1)-variable model is fit, and the variable with the largest p-value is removed.
This procedure continues until a stopping rule is reached.
For instance, we may stop when all remaining variables have a p-value below some threshold.</li>
<li><strong><span style="font-family:monospace; color: #1188ce;">Mixed selection</span></strong>.
This is a combination of forward and backward selection.
We start with no variables in the model, and as with forward selection, we add the variable that provides the best fit.
We continue to add variables one-by-one.
Of course, as we noted with the <code>Advertising</code> example, the p-values for the variables can become larger as the new predictors are added to the model.
Hence, if at any point the p-value for one of the variables in the model rises above a certain threshold, then we remove that variable from the model.
We continue to perform these forward and backward steps until all variables in the model have a sufficiently low p-value, and all variables outside the model would have a large p-value if added to the model.</li>
</ul>
<p>Backward selection cannot be used if <em>p</em> &gt; <em>n</em>, while forward selection can always be used.
Forward selection is a greedy approach, and might include variables early that later become redundant.
Mixed selection can remedy this.</p>
</div>
<div id="three-model-fit" class="section level4">
<h4><span class="header-section-number">2.2.2.3</span> Three: Model Fit</h4>
<p>Two of the most common numerical measures of model fit are the RSE and
<span class="math inline">\(R^2\)</span>, the fraction of variance explained.
These quantities are computed and interpreted in the same fashion as for simple linear regression.</p>
<p>Recall that in simple regression, <span class="math inline">\(R^2\)</span> is the square of the correlation of the response and the variable.
In multiple linear regression, it turns out that it equals Cor(Y, <span class="math inline">\(\hat{Y})^2\)</span>, the square of the correlation between the response and
the fitted linear model; in fact one property of the fitted linear model is that it maximizes this correlation among all possible linear models.</p>
<p>An <span class="math inline">\(R^2\)</span> value close to 1 indicates that the model explains a large portion of the variance in the response variable.
As an example, we saw in Table 3.6 that for the <code>Advertising</code> data, the model that uses all three advertising media to predict <code>sales</code> has an <span class="math inline">\(R^2\)</span> of 0.8972.
On the other hand, the model that uses only <code>TV</code> and <code>radio</code> to predict <code>sales</code> has an <span class="math inline">\(R^2\)</span> value of 0.89719.
In other words, there is a small increase in <span class="math inline">\(R^2\)</span> if we include newspaper advertising in the model that already contains TV and radio advertising, even though we saw earlier that the p-value for newspaper advertising in Table 3.4 is not significant.
It turns out that <span class="math inline">\(R^2\)</span> will always increase when more variables are added to the model, even if those variables are only weakly associated with the response.
This is due to the fact that adding another variable to the least squares equations must allow us to fit the training data (though not necessarily the testing data) more accurately.
Thus, the <span class="math inline">\(R^2\)</span> statistic, which is also computed on the training data, must increase.
The fact that adding newspaper advertising to the model containing only TV and radio advertising leads to just a tiny increase in <span class="math inline">\(R^2\)</span> provides additional evidence that <code>newspaper</code> can be dropped from the model.
Essentially, <code>newspaper</code> provides no real improvement in the model fit to the training samples, and its inclusion will likely lead to poor results on independent test samples due to overfitting.</p>
<p>In contrast, the model containing only <code>TV</code> as a predictor had an <span class="math inline">\(R^2\)</span> of 0.61 (Table 3.2).
Adding <code>radio</code> to the model leads to a substantial improvement in <span class="math inline">\(R^2\)</span>.
This implies that a model that uses TV and radio expenditures to predict sales is substantially better than one that uses only TV advertising.
We could further quantify this improvement by looking at the p-value for the <code>radio</code> coefficient in a model that contains only <code>TV</code> and <code>radio</code> as predictors.</p>
<p>The model that contains only <code>TV</code> and <code>radio</code> as predictors has an RSE of 1.681, and the model that also contains <code>newspaper</code> as a predictor has an RSE of 1.686 (Table 3.6).
In contrast, the model that contains only <code>TV</code> has an RSE of 3.26 (Table 3.2).
This corroborates our previous conclusion that a model that uses TV and radio expenditures to predict sales is much more accurate (on the training data) than one that only uses TV spending.
Furthermore, given that TV and radio expenditures are used as predictors, there is no point in also using newspaper spending as a predictor in the model.
The observant reader may wonder how RSE can increase when <code>newspaper</code> is added to the model given that RSS must decrease.
In general RSE is defined as</p>
<p><span class="math display" id="eq:rse-def">\[\begin{equation}
  RSE = \sqrt{\frac{1}{n-p-1}RSS,}
  \tag{2.25}
\end{equation}\]</span></p>
<p>which simplifies to <a href="linreg.html#eq:rse">(2.15)</a> for a simple linear regression.
Thus, models with more variables can have higher RSE if the decrease in RSS is small relative to the increaes in <em>p</em>.</p>
<p>In addition to looking at the RSE and <span class="math inline">\(R^2\)</span> statistics just discussed, it can be useful to plot the data.
Graphical summaries can reveal problems with a model that are not visible from numerical statistics.
For example, Figure 3.5 displays a three-dimensional plot of <code>TV</code> and <code>radio</code> versus <code>sales</code>.
We see that some observations lie above and some observations lie below the least squares regression plane.
In particular, the linear model seems to overestimate <code>sales</code> for instances in which most of the advertising money was spent exclusively on either <code>TV</code> or <code>radio</code>.
It underestimates <code>sales</code> for instances where the budget was split between the two media.
This pronounced non-linear pattern cannot be modeled accurately using linear regression.
It suggests a <em>synergy</em> or <em>interaction</em> effect between the advertising media, whereby combining the media together results in a bigger boost to sales than using any single medium.
In Section 3.3.2, we will discuss extending the linear model to accomodate such synergistic effects through the use of interaction terms.</p>
</div>
<div id="four-predictions" class="section level4">
<h4><span class="header-section-number">2.2.2.4</span> Four: Predictions</h4>
<p>Once we have fit the multiple regression model, it is straightforward to apply <a href="linreg.html#eq:mlin-reg-est">(2.21)</a> in order to predict the response <em>Y</em> on the basis of a set of values for the predictors <span class="math inline">\(X_1, X_2,...,X_p\)</span>.
However, there are three sorts of uncertainty associated with this prediction.</p>
<ol style="list-style-type: decimal">
<li>The coefficient estimates <span class="math inline">\(\hat{\beta_0}, \hat{\beta_1}, ... , \hat{\beta_p}\)</span> are estimates for <span class="math inline">\(\beta_0, \beta_1, ... , \beta_p\)</span>.
That is, the <em>least squares plane</em></li>
</ol>
<p><span class="math display">\[ \hat{Y} = \hat{\beta_0} + \hat{\beta_1}X_1 + ... + \hat{\beta_p}X_p\]</span></p>
<p>is only an estimate for the <em>true population regression plane</em></p>
<p><span class="math display">\[f(X) = \beta_0 + \beta_1 X1 + ... + \beta_p X_p.\]</span></p>
<p>The inaccuracy in the coefficient estimates is related to the <em>reducible error</em> from Chapter 2.
We can compute a <em>confidence interval</em> in order to determine how close <span class="math inline">\(\hat{Y}\)</span> will be to <span class="math inline">\(f(X)\)</span>.</p>
<ol start="2" style="list-style-type: decimal">
<li><p>Of course, in practice assuming a linear model for <span class="math inline">\(f(X)\)</span> is almost always an approximation of reality, so there is an additional source of potentially reducible error which we call <em>model bias</em>.
So when we use a linear model, we are in fact estimating the best linear approximation to the true surface.
However, here we will ignore this discrepancy, and operate as if the linear model were correct.</p></li>
<li><p>Even if we knew <span class="math inline">\(f(X)\)</span>—that is, even if we knew the true values for <span class="math inline">\(\beta_0, \beta_1,...,\beta_p\)</span>—the response value cannot be predicted perfectly because of the random error in the model <a href="linreg.html#eq:mlin-reg-est">(2.21)</a>.
In Chapter 2, we referred to this as the irreducible error.
How much will Y vary from <span class="math inline">\(\hat{Y}\)</span>?
We use prediction intervals to answer this question.
Prediction intervals are always wider than confidence intervals, because they incorporate both the error in the estimate for f(X) (the reducible error) and the uncertainty as to how much an individual point will differ from the population regression plane (the irreducible error).</p></li>
</ol>
<p>We use a <strong><span style="font-family:monospace; color: #1188ce;">confidence interval</span></strong> to quantify the uncertainty surrounding the <em>average</em> <code>sales</code> over a large number of cities.
For example, given that $100,000 is spent on <code>TV</code> advertising and $20,000 is spent on <code>radio</code> advertising in each city, the 95% confidence interval is [10,985, 11,528].
We interpret this to mean that 95% of intervals of this form will contain the true value of f(X).<a href="#fn8" class="footnote-ref" id="fnref8"><sup>8</sup></a>
On the other hand, a <strong><span style="font-family:monospace; color: #1188ce;">prediction interval</span></strong> can be used to quantify the uncertainty surrounding <code>sales</code> for a <em>particular</em> city.
Given that $100,000 is spent on <code>TV</code> advertising and $20,000 is spent on <code>radio</code> advertising in that city the 95% prediction interval is [7,930, 14,580].
We interpret this to mean that 95% of intervals of this form will contain the true value of <em>Y</em> for this city.
Note that both intervals are centered at 11,256, but that the prediction interval is substantially wider than the confidence interval, reflecting the increased uncertainty about <code>sales</code> for a given city in comparison to the average <code>sales</code> over many locations.</p>
</div>
</div>
</div>
<div id="other-reg-cons" class="section level2">
<h2><span class="header-section-number">2.3</span> Other Considerations in the Regression Model</h2>
<div id="qualitative-predictors" class="section level3">
<h3><span class="header-section-number">2.3.1</span> Qualitative Predictors</h3>
<p>In our discussio so far, we have assumed that all variables in our linear regression model are <em>quantitative</em>.
But in practice, this is not necessarily the case; often some predictors are <em>qualitative</em>.
For example, the <code>Credit</code> data set displayed in Figure 3.6 records <code>balance</code> (average credit card debt for a number of individuals) as well as several quantitative predictors: <code>age</code>, <code>cards</code> (number of credit cards), <code>education</code> (years of education), <code>income</code> (in thousands of dollars), <code>limit</code> (credit limit), and <code>rating</code> (credit rating).
Each panel of Figure 3.6 is a scatterplot for a pair of variables whose identities are given by the corresponding row and column labels.
For example, the scatterplot directly to the right of the word “Balance” depicts <code>balance</code> versus <code>age</code>, while the plot directly to the right of “Age” corresponds to <code>age</code> versus <code>cards</code>.
In addition to these quantitative variables, we also have four qualitative variables: <code>gender</code>, <code>student</code> (student status), <code>status</code> (marital status), and <code>ethnicity</code> (Caucasian, African American or Asian).</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="linreg.html#cb6-1"></a><span class="co"># Need to use the GGally library</span></span>
<span id="cb6-2"><a href="linreg.html#cb6-2"></a><span class="kw">library</span>(GGally)</span>
<span id="cb6-3"><a href="linreg.html#cb6-3"></a></span>
<span id="cb6-4"><a href="linreg.html#cb6-4"></a><span class="co"># Select the relevant variables</span></span>
<span id="cb6-5"><a href="linreg.html#cb6-5"></a><span class="kw">ggpairs</span>(<span class="kw">select</span>(credit, Balance, Age, Cards, Education, Income, Limit, Rating), </span>
<span id="cb6-6"><a href="linreg.html#cb6-6"></a>        <span class="dt">upper =</span> <span class="kw">list</span>(<span class="dt">continuous =</span> <span class="kw">wrap</span>(<span class="st">&quot;points&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;blue&quot;</span>)), </span>
<span id="cb6-7"><a href="linreg.html#cb6-7"></a>        <span class="dt">lower =</span> <span class="kw">list</span>(<span class="dt">continuous =</span> <span class="kw">wrap</span>(<span class="st">&quot;points&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;blue&quot;</span>)), </span>
<span id="cb6-8"><a href="linreg.html#cb6-8"></a>        <span class="dt">diag =</span> <span class="st">&quot;blank&quot;</span>, <span class="co"># Set blank diagonal</span></span>
<span id="cb6-9"><a href="linreg.html#cb6-9"></a>        <span class="dt">axisLabels =</span> <span class="st">&quot;show&quot;</span>, </span>
<span id="cb6-10"><a href="linreg.html#cb6-10"></a>        <span class="dt">switch =</span> <span class="st">&quot;y&quot;</span>)<span class="op">+</span></span>
<span id="cb6-11"><a href="linreg.html#cb6-11"></a><span class="st">  </span><span class="co"># Apply our ISLR theme object</span></span>
<span id="cb6-12"><a href="linreg.html#cb6-12"></a><span class="st">  </span><span class="kw">theme_islr</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:credit-overview"></span>
<img src="03-linear-regression_files/figure-html/credit-overview-1.png" alt="*The &lt;strong&gt;&lt;span style='font-family:monospace; color: #B44C1C;'&gt;Credit&lt;/span&gt;&lt;/strong&gt; data set contains information about  &lt;strong&gt;&lt;span style='font-family:monospace; color: #B44C1C;'&gt;balance&lt;/span&gt;&lt;/strong&gt; ,  &lt;strong&gt;&lt;span style='font-family:monospace; color: #B44C1C;'&gt;age&lt;/span&gt;&lt;/strong&gt; ,  &lt;strong&gt;&lt;span style='font-family:monospace; color: #B44C1C;'&gt;cards&lt;/span&gt;&lt;/strong&gt; ,  &lt;strong&gt;&lt;span style='font-family:monospace; color: #B44C1C;'&gt;education&lt;/span&gt;&lt;/strong&gt; ,  &lt;strong&gt;&lt;span style='font-family:monospace; color: #B44C1C;'&gt;income&lt;/span&gt;&lt;/strong&gt; ,  &lt;strong&gt;&lt;span style='font-family:monospace; color: #B44C1C;'&gt;limit&lt;/span&gt;&lt;/strong&gt; , and  &lt;strong&gt;&lt;span style='font-family:monospace; color: #B44C1C;'&gt;rating&lt;/span&gt;&lt;/strong&gt;  for a number of potential customers.*" width="1152" />
<p class="caption">
FIGURE 2.2: <em>The <strong><span style="font-family:monospace; color: #B44C1C;">Credit</span></strong> data set contains information about <strong><span style="font-family:monospace; color: #B44C1C;">balance</span></strong> , <strong><span style="font-family:monospace; color: #B44C1C;">age</span></strong> , <strong><span style="font-family:monospace; color: #B44C1C;">cards</span></strong> , <strong><span style="font-family:monospace; color: #B44C1C;">education</span></strong> , <strong><span style="font-family:monospace; color: #B44C1C;">income</span></strong> , <strong><span style="font-family:monospace; color: #B44C1C;">limit</span></strong> , and <strong><span style="font-family:monospace; color: #B44C1C;">rating</span></strong> for a number of potential customers.</em>
</p>
</div>
<p><strong>TABLE 3.7</strong></p>
<div id="predictors-with-only-two-levels" class="section level4">
<h4><span class="header-section-number">2.3.1.1</span> Predictors with Only Two Levels</h4>
<p>Suppose that we wish to investigate differences in credit card balance between males and females, ignoring the other variables for the moment.
If a qualitative predictor (also known as a <strong><span style="font-family:monospace; color: #1188ce;">factor</span></strong>) only has two <strong><span style="font-family:monospace; color: #1188ce;">levels</span></strong>, or possible values, then incorporating it into a regression model is very simple.
We simply create an indicator or <strong><span style="font-family:monospace; color: #1188ce;">dummy variable</span></strong> that takes on two possible numerical values.
For example, based on the <code>gender</code> variable, we can create a new variable that takes the form</p>
<p><span class="math display" id="eq:dummy-gender">\[\begin{equation}
  x_i =  \begin{cases}
      1 &amp; \text{if $i$th person is female}\\
      0 &amp; \text{if $i$th person is male,}\\
    \end{cases}      
  \tag{2.26}
\end{equation}\]</span></p>
<p>and use this variable as a predictor in the regression equation.
This results in the model</p>
<p><span class="math display" id="eq:dummy-eq">\[\begin{equation}
  y_i = \beta_0 + \beta_1 x_i + \epsilon_i =  \begin{cases}
                                                  \beta_0 + \beta_1 + \epsilon_i &amp; \text{if $i$th person is female}\\
                                                  \beta_0 + \epsilon_i &amp; \text{if $i$th person is male.}\\
                                              \end{cases}      
  \tag{2.27}
\end{equation}\]</span></p>
<p>Now <span class="math inline">\(\beta_0\)</span> can be interpreted as the average credit card balance among males, <span class="math inline">\(\beta_0 + \beta_1\)</span> as the average credit card balance among females, and <span class="math inline">\(\beta_1\)</span> as the average diﬀerence in credit card balance between females and males.</p>
<p>Table 3.7 displays the coeﬃcient estimates and other information associated with the model <a href="linreg.html#eq:dummy-eq">(2.27)</a>.
The average credit card debt for males is estimated to be $509.80, whereas females are estimated to carry $19.73 in additional debt for a total of $509.80 + $19.73 = $529.53.
However, we notice that the p-value for the dummy variable is very high.
This indicates that there is no statistical evidence of a difference in average credit card balance between the genders.</p>
<p>The decision to code females as 1 and males as 0 in <a href="linreg.html#eq:dummy-eq">(2.27)</a> is arbitrary, and has no effect on the regression fit, but does alter the interpretation of the coefficients.
If we had coded males as 1 and females as 0, then the estimates for <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> would have been 529.53 and 19.73, respectively, leading once again to a prediction of credit card debt of $529.53 for females.
Alternatively, instead of a 0/1 coding scheme, we could create a dummy variable</p>
<p><span class="math display">\[
x_i = \begin{cases}
    1 &amp; \text{if $i$th person is female}\\
    -1 &amp; \text{if $i$th person is male,}\\
    \end{cases}  
\]</span></p>
<p>and use this variable in the regression equation.
This results in the model</p>
<p><span class="math display">\[
  y_i = \beta_0 + \beta_1 x_i + \epsilon_i =  \begin{cases}
                                                  \beta_0 + \beta_1 + \epsilon_i &amp; \text{if $i$th person is female}\\
                                                  \beta_0 - \beta_1 + \epsilon_i &amp; \text{if $i$th person is male.}\\
                                              \end{cases}      
\]</span></p>
<p>Now <span class="math inline">\(\beta_0\)</span> can be interpreted as the overall average credit card balance (ignoring the gender effect), and <span class="math inline">\(\beta_1\)</span> is the amount that females are above the average and males are below the average.
In this example, the estimate for <span class="math inline">\(\beta_0\)</span> would be <span class="math inline">\(\$519.665\)</span>, halfway between the male and female averages of <span class="math inline">\(\$509.80\)</span> and <span class="math inline">\(\$529.53\)</span>.
The estimate for <span class="math inline">\(\beta_1\)</span> would be <span class="math inline">\(\$9.865\)</span>, which is half of <span class="math inline">\(\$19.73\)</span>, the average difference between females and males.
It is important to note that the final predictions of the credit balances of males and females will be identical regardless of the coding scheme used.
The only difference is in the way that the coefficients are interpreted.</p>
</div>
<div id="qualitative-predictors-with-more-than-two-levels" class="section level4">
<h4><span class="header-section-number">2.3.1.2</span> Qualitative Predictors with More than Two Levels</h4>
<p>When a qualitative predictor has more than two levels, a single dummy variable cannot represent all possible values.
In this situation, we can create additional dummy variables.
For example, for the <code>ethnicity</code> variable we create two dummy variables. The first could be</p>
<p><span class="math display" id="eq:dummy-asian">\[\begin{equation}
  x_i1 = \begin{cases}
      1 &amp; \text{if $i$th person is Asian}\\
      0 &amp; \text{if $i$th person is not Asian}\\
      \end{cases}      
  \tag{2.28}
\end{equation}\]</span></p>
<p>and the second could be</p>
<p><span class="math display" id="eq:dummy-caucasian">\[\begin{equation}
  x_i2 = \begin{cases}
      1 &amp; \text{if $i$th person is Caucasian}\\
      0 &amp; \text{if $i$th person is not Caucasian}\\
      \end{cases}      
  \tag{2.29}
\end{equation}\]</span></p>
<p>Then both of these variables can be used in the regression equation, in order to obtain the model</p>
<p><span class="math display" id="eq:dummy-ethnicity">\[\begin{equation}
  y_i = \beta_0 + \beta_1 x_i1 + \beta_2 x_i2 + \epsilon_i = \begin{cases}
    \beta_0 + \beta_1 + \epsilon_i &amp; \text{if $i$th person is Asian}\\
    \beta_0 + \beta_2 + \epsilon_i &amp; \text{if $i$th person is Caucasian}\\
    \beta_0 + \epsilon_i &amp; \text{if $i$th person is African American.}\\
                                              \end{cases}      
  \tag{2.30}
\end{equation}\]</span></p>
<p>Now <span class="math inline">\(\beta_0\)</span> can be interpreted as the average credit card balance for African Americans, <span class="math inline">\(\beta_1\)</span> can be interpreted as the difference in average balance between the Asian and African American categories, and <span class="math inline">\(\beta_2\)</span> can be interpreted as the difference in the average balance between the Caucasian and African American categories.
There will always be one fewer dummy variables than the number of levels.
The level with no dummy variable — African American in this example — is known as the <strong><span style="font-family:monospace; color: #1188ce;">baseline</span></strong>.</p>
<p><strong>TABLE 3.8</strong></p>
<p>From Table 3.8, we see that the estimated <code>balance</code> for the baseline, African American is <span class="math inline">\(\$531.00\)</span>.
It is estimated that the Asian category will have <span class="math inline">\(\$18.69\)</span> less debt than the African American category, and that the Caucasian category will have <span class="math inline">\(\$12.50\)</span> less debt than the African American category.
However, the p-values associated with the coefficient estimates for the two dummy variables are very large, suggesting no statistical evidence of a real difference in credit card balance between the ethnicities.
Once again, the level selected as the baseline category is arbitrary, and the final predictions for each group will be the same regardless of this choice.
However, the coefficients and their p-values do depend on the choice of dummy variable coding.
Rather than rely on the individual coefficients, we can use an F-test to test <span class="math inline">\(H_0 : \beta_1 = \beta_2 = 0\)</span>; this does not depend on the coding.
This F-test has a p-value of <span class="math inline">\(0.96\)</span>, indicating that we cannot reject the null hypothesis that there is no relationship between <code>balance</code> and <code>ethnicity</code>.</p>
<p>Using this dummy variable approach presents no difficulties when using both quantitative and qualitative predictors.
For example, to regress <code>balance</code> on both a quantitative variable such as <code>income</code> and a qualitative variable such as <code>student</code>, we must simply create a dummy variable for <code>student</code> and then fit a multiple regression model using <code>income</code> and the dummy variable as predictors for credit card balance.</p>
<p>There are many different ways of coding qualitative variables besides the dummy variable approach taken here.
All of these approaches lead to equivalent model fits, but the coefficients are different and have different interpretations, and are designed to measure particular <strong><span style="font-family:monospace; color: #1188ce;">contrasts</span></strong>.
This topic is beyond the scope of the book, and so we will not pursue it further.</p>
</div>
</div>
<div id="extensions-of-the-linear-model" class="section level3">
<h3><span class="header-section-number">2.3.2</span> Extensions of the Linear Model</h3>
<p>The standard linear regression model <a href="linreg.html#eq:mlin-reg">(2.19)</a> provides interpretable results and works quite well on many real-world problems.
However, it makes several highly restrictive assumptions that are often violated in practice.
Two of the most important assumptions state that the relationship between the predictors and response are <strong><span style="font-family:monospace; color: #1188ce;">additive</span></strong> and <strong><span style="font-family:monospace; color: #1188ce;">linear</span></strong>.
The additive assumption means that the effect of changes in a predictor <span class="math inline">\(X_j\)</span> on the response <span class="math inline">\(Y\)</span> is independent of the values of the other predictors.
The linear assumption states that the change in the response <span class="math inline">\(Y\)</span> due to a one-unit change in <span class="math inline">\(X_j\)</span> is constant, regardless of the value of <span class="math inline">\(X_j\)</span>.
In this book, we examine a number of sophisticated methods that relax these two assumptions.
Here, we briefly examine some common classical approaches for extending the linear model.</p>
<div id="removing-the-additive-assumption" class="section level4">
<h4><span class="header-section-number">2.3.2.1</span> Removing the Additive Assumption</h4>
<p>In our previous analysis of the <strong><span style="font-family:monospace; color: #B44C1C;">Advertising</span></strong> data, we concluded that both <strong><span style="font-family:monospace; color: #B44C1C;">TV</span></strong> and <strong><span style="font-family:monospace; color: #B44C1C;">radio</span></strong> seem to be associated with <strong><span style="font-family:monospace; color: #B44C1C;">sales</span></strong>.
The linear model that forms the basis for this conclusion assumed that the effect on <strong><span style="font-family:monospace; color: #B44C1C;">sales</span></strong> of increasing one advertising medium is independent of the amount spent on the other media.
For example, the linear model (<a href="linreg.html#eq:mlin-reg-adv">(2.20)</a>) states that the average effect on <strong><span style="font-family:monospace; color: #B44C1C;">sales</span></strong> of a one-unit increase in <strong><span style="font-family:monospace; color: #B44C1C;">TV</span></strong> is always <span class="math inline">\(\beta_1\)</span>, regardless of the amount spent on <strong><span style="font-family:monospace; color: #B44C1C;">radio</span></strong>.</p>
<p>However, this simple model may be incorrect.
Suppose that spending money on radio advertising actually increases the effectiveness of TV advertising, so that the slope term for <strong><span style="font-family:monospace; color: #B44C1C;">TV</span></strong> should increase as <strong><span style="font-family:monospace; color: #B44C1C;">radio</span></strong> increases.
In this situation, given a fixed budget of <span class="math inline">\(\$100,000\)</span>, spending half on <strong><span style="font-family:monospace; color: #B44C1C;">radio</span></strong> and half on <strong><span style="font-family:monospace; color: #B44C1C;">TV</span></strong> may increaes <strong><span style="font-family:monospace; color: #B44C1C;">sales</span></strong> more than allocating the entire amount to either <strong><span style="font-family:monospace; color: #B44C1C;">TV</span></strong> or to <strong><span style="font-family:monospace; color: #B44C1C;">radio</span></strong>.
In marketing, this is known as a <em>synergy</em> effect, and in statistics it is referred to as an <em>interaction</em> effect.
Figure 3.5 suggests that such an effect may be present in the advertising data.
Notice that when levels of either <strong><span style="font-family:monospace; color: #B44C1C;">TV</span></strong> or <strong><span style="font-family:monospace; color: #B44C1C;">radio</span></strong> are low, then the true <strong><span style="font-family:monospace; color: #B44C1C;">sales</span></strong> are lower than predicted by the linear model.
But when advertising is split between the two media, then the model tends to underestimate <strong><span style="font-family:monospace; color: #B44C1C;">sales</span></strong>.</p>
<p>Consider the standard linear regression model with two variables.</p>
<p><span class="math display">\[Y = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \epsilon\]</span></p>
<p>According to this model, if we increase X_1 by one unit, then <span class="math inline">\(Y\)</span> will increase by an average of <span class="math inline">\(\beta_1\)</span> units.
Notice that the presence of <span class="math inline">\(X_2\)</span> does not alter this statement — that is, regardless of the value of <span class="math inline">\(X_2\)</span>, a one-unit increase in <span class="math inline">\(X_1\)</span> will lead to a <span class="math inline">\(\beta_1\)</span>-unit increase in <span class="math inline">\(Y\)</span>.
One way of extending this model to allow for interaction effects is to include a third predictor, called an <em>interaction term</em>, which is constructed by computing the product of <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span>. This results in the model</p>
<p><span class="math display" id="eq:interactionterm">\[\begin{equation}
  Y = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \beta_3 X_1 X_2 + \epsilon    
  \tag{2.31}
\end{equation}\]</span></p>
<p>How does inclusion of this interaction term relax the additive assumption?
Notice that <a href="linreg.html#eq:interactionterm">(2.31)</a> can be rewritten as</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="linreg.html#cb7-1"></a><span class="co"># estimate the linear model</span></span>
<span id="cb7-2"><a href="linreg.html#cb7-2"></a>interaction_model =<span class="st"> </span><span class="kw">lm</span>(sales <span class="op">~</span><span class="st"> </span>TV<span class="op">+</span>radio<span class="op">+</span>TV<span class="op">*</span>radio, </span>
<span id="cb7-3"><a href="linreg.html#cb7-3"></a>                       <span class="dt">data =</span> advertising)</span>
<span id="cb7-4"><a href="linreg.html#cb7-4"></a></span>
<span id="cb7-5"><a href="linreg.html#cb7-5"></a><span class="co"># Clean up the model output</span></span>
<span id="cb7-6"><a href="linreg.html#cb7-6"></a><span class="kw">prep_reg_table</span>(interaction_model) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-7"><a href="linreg.html#cb7-7"></a><span class="st">  </span><span class="co"># use reactable to produce the table</span></span>
<span id="cb7-8"><a href="linreg.html#cb7-8"></a><span class="st">  </span><span class="kw">reactable</span>(</span>
<span id="cb7-9"><a href="linreg.html#cb7-9"></a>    <span class="dt">borderless =</span> T,</span>
<span id="cb7-10"><a href="linreg.html#cb7-10"></a>    <span class="dt">sortable =</span> F,</span>
<span id="cb7-11"><a href="linreg.html#cb7-11"></a>    <span class="dt">defaultColDef =</span> <span class="kw">colDef</span>(<span class="dt">format =</span> <span class="kw">colFormat</span>(<span class="dt">digits =</span> <span class="dv">3</span>)),</span>
<span id="cb7-12"><a href="linreg.html#cb7-12"></a>    <span class="co"># Specific column formats</span></span>
<span id="cb7-13"><a href="linreg.html#cb7-13"></a>    <span class="dt">columns =</span> <span class="kw">list</span>(</span>
<span id="cb7-14"><a href="linreg.html#cb7-14"></a>      <span class="dt">term =</span> <span class="kw">colDef</span>(</span>
<span id="cb7-15"><a href="linreg.html#cb7-15"></a>        <span class="dt">name =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb7-16"><a href="linreg.html#cb7-16"></a>        <span class="dt">style =</span> <span class="kw">list</span>(<span class="dt">borderRight =</span> <span class="st">&quot;2px solid black&quot;</span>,</span>
<span id="cb7-17"><a href="linreg.html#cb7-17"></a>                                 <span class="dt">color =</span> <span class="st">&quot;#B44C1C&quot;</span>,</span>
<span id="cb7-18"><a href="linreg.html#cb7-18"></a>                                 <span class="dt">fontFamily =</span> <span class="st">&quot;Roboto Mono&quot;</span>),</span>
<span id="cb7-19"><a href="linreg.html#cb7-19"></a>        <span class="dt">headerStyle =</span> <span class="kw">list</span>(<span class="dt">borderRight =</span> <span class="st">&quot;2px solid black&quot;</span>)),</span>
<span id="cb7-20"><a href="linreg.html#cb7-20"></a>      <span class="st">`</span><span class="dt">t-statistic</span><span class="st">`</span> =<span class="st"> </span><span class="kw">colDef</span>(<span class="dt">format =</span> <span class="kw">colFormat</span>(<span class="dt">digits =</span> <span class="dv">2</span>))</span>
<span id="cb7-21"><a href="linreg.html#cb7-21"></a>    )</span>
<span id="cb7-22"><a href="linreg.html#cb7-22"></a>  )</span>
<span id="cb7-23"><a href="linreg.html#cb7-23"></a></span>
<span id="cb7-24"><a href="linreg.html#cb7-24"></a><span class="co"># Put the caption beneath the table</span></span>
<span id="cb7-25"><a href="linreg.html#cb7-25"></a><span class="kw">rt_caption</span>(</span>
<span id="cb7-26"><a href="linreg.html#cb7-26"></a>  <span class="dt">text =</span> <span class="kw">str_c</span>(<span class="st">&quot;For the &quot;</span>, <span class="kw">data_colour</span>(<span class="st">&quot;Advertising&quot;</span>), <span class="st">&quot; data, least squares coefficient estimates associated with the regression of &quot;</span>, <span class="kw">data_colour</span>(<span class="st">&quot;sales&quot;</span>), <span class="st">&quot; onto &quot;</span>, <span class="kw">data_colour</span>(<span class="st">&quot;TV&quot;</span>), <span class="st">&quot; and &quot;</span>, <span class="kw">data_colour</span>(<span class="st">&quot;radio&quot;</span>), <span class="st">&quot;, with an interaction term, as in (3.33)&quot;</span>), </span>
<span id="cb7-27"><a href="linreg.html#cb7-27"></a>  <span class="dt">tab_num =</span> <span class="fl">3.9</span></span>
<span id="cb7-28"><a href="linreg.html#cb7-28"></a>  )</span></code></pre></div>
<p><div id="htmlwidget-546b431222798b5b056c" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-546b431222798b5b056c">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"term":["Intercept","TV","radio","TV X radio"],"Coefficient":[6.75022020307515,0.019101073831043,0.0288603398999246,0.00108649469798996],"Std. Error":[0.247871369934467,0.00150414550866849,0.0089052728630375,5.24203957977123e-005],"t-statistic":[27.2327546535923,12.6989534728936,3.24081477836723,20.7265641828171],"p-value":["<0.0001","<0.0001","0.0014","<0.0001"]},"columns":[{"accessor":"term","name":"","type":"character","format":{"cell":{"digits":3},"aggregated":{"digits":3}},"style":{"borderRight":"2px solid black","color":"#B44C1C","fontFamily":"Roboto Mono"},"headerStyle":{"borderRight":"2px solid black"}},{"accessor":"Coefficient","name":"Coefficient","type":"numeric","format":{"cell":{"digits":3},"aggregated":{"digits":3}}},{"accessor":"Std. Error","name":"Std. Error","type":"numeric","format":{"cell":{"digits":3},"aggregated":{"digits":3}}},{"accessor":"t-statistic","name":"t-statistic","type":"numeric","format":{"cell":{"digits":2},"aggregated":{"digits":2}}},{"accessor":"p-value","name":"p-value","type":"character","format":{"cell":{"digits":3},"aggregated":{"digits":3}}}],"sortable":false,"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"borderless":true,"theme":{"color":"#333","tableStyle":{"borderTop":"2px solid black","borderBottom":"2px solid black"},"headerStyle":{"borderBottom":"2px solid black"}},"dataKey":"c6496af75eb7b76e2510535e6951e65d","key":"c6496af75eb7b76e2510535e6951e65d"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script><p class="caption">
<span class="tab-num">TABLE 3.9.</span>
<em>For the <strong><span style='font-family:monospace; color: #B44C1C;'>Advertising</span></strong> data, least squares coefficient estimates associated with the regression of <strong><span style='font-family:monospace; color: #B44C1C;'>sales</span></strong> onto <strong><span style='font-family:monospace; color: #B44C1C;'>TV</span></strong> and <strong><span style='font-family:monospace; color: #B44C1C;'>radio</span></strong>, with an interaction term, as in (3.33)</em>
</p></p>
<p><span class="math display" id="eq:interaction-rewritten">\[\begin{equation} 
\begin{aligned}
  Y &amp;= \beta_0 + (\beta_1 + \beta_3 X_2) X_1 + \beta_2 X_2 + \epsilon \\
      &amp;= \beta_0 + \tilde{\beta_1} X_1 + \beta_2 X_2 + \epsilon
  \end{aligned}
  \tag{2.32}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\tilde{\beta_1} = \beta_1 + \beta_3 X_2\)</span>.
Since <span class="math inline">\(\tilde{\beta_1}\)</span> changes with <span class="math inline">\(X_2\)</span>, the effect of <span class="math inline">\(X_1\)</span> on <span class="math inline">\(Y\)</span> is no longer constant: adjusting <span class="math inline">\(X_2\)</span> will change the impact of <span class="math inline">\(X_1\)</span> on <span class="math inline">\(Y\)</span>.</p>
<p>For example, suppose we are interested in studying the productivity of a factory.
We wish to predict the number of <strong><span style="font-family:monospace; color: #B44C1C;">units</span></strong> produced on the basis of the number of production <strong><span style="font-family:monospace; color: #B44C1C;">lines</span></strong> and the total number of <strong><span style="font-family:monospace; color: #B44C1C;">workers</span></strong>.
It seems likely that the effect of increasing the number of production lines will depend on the number of workers, since if no workers are available to operate the lines, then increasing the number of lines will not increase production.
This suggests that it would be appropriate to include an interaction term between <strong><span style="font-family:monospace; color: #B44C1C;">lines</span></strong> and <strong><span style="font-family:monospace; color: #B44C1C;">workers</span></strong> in a linear model to predict <strong><span style="font-family:monospace; color: #B44C1C;">units</span></strong>.
Suppose that when we fit the model, we obtain</p>
<p><span class="math display">\[
\begin{aligned}
  \color{#B44C1C}{units} &amp;\approx 1.2 + 3.4 \times \color{#B44C1C}{workers} + 1.4 \times (\color{#B44C1C}{{lines}} \times \color{#B44C1C}{{workers}}) \\
      &amp;= 1.2 + (3.4 + 1.4 \times \color{#B44C1C}{{workers}}) \times \color{#B44C1C}{{lines}} + 0.22 \times \color{#B44C1C}{{workers}}.
  \end{aligned}
\]</span></p>
<p>In other words, adding an additional line will increase the number of units produced by <span class="math inline">\(3.4 + 1.4 \times \color{#B44C1C}{workers}\)</span>.
Hence the more <strong><span style="font-family:monospace; color: #B44C1C;">workers</span></strong> we have, the stronger the effect of <strong><span style="font-family:monospace; color: #B44C1C;">lines</span></strong> will be.</p>
<p>We now return to the <strong><span style="font-family:monospace; color: #B44C1C;">Advertising</span></strong> example.
A linear model that uses <strong><span style="font-family:monospace; color: #B44C1C;">radio</span></strong>, <strong><span style="font-family:monospace; color: #B44C1C;">TV</span></strong>, and an interaction between the two to predict <strong><span style="font-family:monospace; color: #B44C1C;">sales</span></strong> takes the form</p>
<p><span class="math display" id="eq:adv-interaction">\[\begin{equation}
  \begin{aligned}
  \color{#B44C1C}{sales} &amp;\approx \beta_0 + \beta_1 \times \color{#B44C1C}{TV} + \beta_2 \times \color{#B44C1C}{radio} + \beta_3 \times (\color{#B44C1C}{{radio}} \times \color{#B44C1C}{{TV}}) + \epsilon \\
      &amp;= \beta_0 + (\beta_1 + \beta_3 \times \color{#B44C1C}{radio}) \times \color{#B44C1C}{TV} + \beta_2 \times \color{#B44C1C}{radio} + \epsilon.
  \end{aligned}
  \tag{2.33}
\end{equation}\]</span></p>
<p>We can interpret <span class="math inline">\(\beta_3\)</span> as the increase in effectiveness of TV advertising for a one-unit increase in radio advertising (or vice-versa).
The coefficients that result from fitting the model <a href="linreg.html#eq:adv-interaction">(2.33)</a> are given in Table 3.9.</p>
<p>The results in Table 3.9 strongly suggest that the model that includes the interaction term is superior to the model that contains only <strong><span style="font-family:monospace; color: #1188ce;">main effects</span></strong>.
The p-value for the interaction term <code>TV</code><span class="math inline">\(\times\)</span><code>radio</code>, is extremely low, indicating there is strong evidence for <span class="math inline">\(H_a : \beta_3 \neq 0\)</span>.
In other words, it is clear that the true relationship is not additive.
The <span class="math inline">\(R^2\)</span> for the model <a href="linreg.html#eq:adv-interaction">(2.33)</a> is <span class="math inline">\(96.8\%\)</span>, compared to only <span class="math inline">\(89.7\%\)</span> for the model that predicts <code>sales</code> using <code>TV</code> and <code>radio</code> without an interaction term.
This means that <span class="math inline">\((96.8 - 89.7)/(100 - 89.7) = 69\%\)</span> of the variability in <code>sales</code> that remains after fitting the additive model has been explained by the interaction term.
The coefficient estimates in Table 3.9 suggest that an increase in TV advertising of <span class="math inline">\(\$1,000\)</span> is associated with increased sales of <span class="math inline">\((\hat{\beta_1} + \hat{\beta_3} \times \color{#B44C1C}{radio}) \times 1,000 = 19 + 1.1 \times \color{#B44C1C}{radio}\)</span> units.
And an increase in radio advertising of <span class="math inline">\(\$1,000\)</span> will be associated with an increase in sales of <span class="math inline">\((\hat{\beta_2} + \hat{\beta_3} \times \color{#B44C1C}{TV}) \times 1,000 = 29 + 1.1 \times \color{#B44C1C}{TV}\)</span> units.</p>
<p>In this example, the p-values associated with <code>TV</code>, <code>radio</code>, and the interaction term all are statistically significant (Table 3.9), and so it is obvious that all three variables should be included in the model.
However, it is sometimes the case that an interaction term has a very small p-value, but the associated main effects (in this case, <code>TV</code> and <code>radio</code>) do not.
The <strong><span style="font-family:monospace; color: #1188ce;">hirearchical principle</span></strong> states that <em>if we include an interaction in a model, we should also include the main effects, even if the p-values associated with their coefficients are not significant</em>.
In other words, if the interaction between <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> seems important, then we should include both <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> in the model even if their coefficient estimates have large p-values.
The rationale for this principle is that if <span class="math inline">\(X_1 \times X_2\)</span> is related to the response, then whether or not the coefficients of <span class="math inline">\(X_1\)</span> or <span class="math inline">\(X_2\)</span> are exactly zero is of little interest.
Also <span class="math inline">\(X_1 \times X_2\)</span> is typically correlated with <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span>, and so leaving them out tends to alter the meaning of the interaction.</p>
<p>In the previous example, we considered an interaction between <code>TV</code> and <code>radio</code>, both of which are quantitative variables.
However, the concept of interactions applies just as well to qualitative variables.
In fact, an interaction between a qualitative variable and a quantitative variable has a particularly nice interpretation.
Consider the <code>Credit</code> data set from Section 3.3.1, and suppose that we wish to predict <code>balance</code> using the <code>income</code> (quantitative) and <code>student</code> (qualitative) variables.
In the absence of an interaction term, the model takes the form</p>
<p><span class="math display" id="eq:qual-nointeraction">\[\begin{equation}
\begin{aligned}
  \color{#B44C1C}{balance}_i &amp;\approx \beta_0 + \beta_1 \times \color{#B44C1C}{income}_i + \begin{cases}
                            \beta_2 &amp; \text{if $i$th person is a student}\\
                            0 &amp; \text{if $i$th person is not a student}\\
                            \end{cases} \\
                            &amp;= \beta_1 \times \color{#B44C1C}{income}_i + \begin{cases}
                            \beta_0 + \beta_2 &amp; \text{if $i$th person is a student}\\
                            \beta_0 &amp; \text{if $i$th person is not a student}\\
                            \end{cases}
                        
\end{aligned}
\tag{2.34}
\end{equation}\]</span></p>
<p>Notice that this amounts to fitting two parallel lines to the data, one for students and one for non-students.
The lines for students and non-students have different intercepts, <span class="math inline">\(\beta_0 + \beta_2\)</span> versus <span class="math inline">\(\beta_0\)</span>, but the same slope, <span class="math inline">\(\beta_1\)</span>.
This is illustrated in the left-hand panel of Figure 3.7.
The fact that the lines are parallel means that the average effect on <code>balance</code> of a one-unit increase in <code>income</code> does not depend on whether or not the individual is a student.
This represents a potentially serious limitation of the model, since in fact a change in <code>income</code> may have a very different effect on the credit card balance of a student versus a non-student.</p>
<p>This limitation can be addressed by adding an interaction variable, created by multiplying <code>income</code> with the dummy variable for <code>student</code>.
Our model now becomes</p>
<p><span class="math display" id="eq:qual-interaction">\[\begin{equation}
\begin{aligned}
  \color{#B44C1C}{balance}_i &amp;\approx \beta_0 + \beta_1 \times \color{#B44C1C}{income}_i + \begin{cases}
                            \beta_2 + \beta_3 \times \color{#B44C1C}{income}_i &amp; \text{if student}\\
                            0 &amp; \text{if not student}\\
                            \end{cases} \\
                            &amp;= \begin{cases}
                            (\beta_0 + \beta_2) + (\beta_1 + \beta_3) \times \color{#B44C1C}{income}_i &amp; \text{if student}\\
                            \beta_0 + \beta_1 \times \color{#B44C1C}{income}_i &amp; \text{if not student}\\
                            \end{cases}
                        
\end{aligned}
\tag{2.35}
\end{equation}\]</span></p>
<p>Once again, we have two different regression lines for the students and the non-students.
But now those regression lines have different intercepts, <span class="math inline">\(\beta_0 + \beta_2\)</span> versus <span class="math inline">\(\beta_0\)</span>, as well as different slopes, <span class="math inline">\(\beta_1 + \beta_3\)</span> versus <span class="math inline">\(\beta_1\)</span>.
This allows for the possibility that changes in income may affect the credit card balances of students and non-students differently.
The right-hand panel of Figure 3.7 shows the estimated relationships between <code>income</code> and <code>balance</code> for students and non-students in <a href="linreg.html#eq:qual-interaction">(2.35)</a>.
We note that the slope for students is lower than the slope for non-students.
This suggests that increases in income are associated with smaller increases in credit card balance among students as compared to non-students.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="linreg.html#cb8-1"></a><span class="co"># glimpse(Credit)</span></span>
<span id="cb8-2"><a href="linreg.html#cb8-2"></a></span>
<span id="cb8-3"><a href="linreg.html#cb8-3"></a><span class="co"># create multiple linear model</span></span>
<span id="cb8-4"><a href="linreg.html#cb8-4"></a>credit_lm =<span class="st"> </span><span class="kw">lm</span>(Balance<span class="op">~</span>Income<span class="op">+</span>Student, <span class="dt">data =</span> credit)</span>
<span id="cb8-5"><a href="linreg.html#cb8-5"></a><span class="co"># summary(credit_lm)</span></span>
<span id="cb8-6"><a href="linreg.html#cb8-6"></a></span>
<span id="cb8-7"><a href="linreg.html#cb8-7"></a><span class="co"># set axes and colour scale</span></span>
<span id="cb8-8"><a href="linreg.html#cb8-8"></a>cred_x_axis =<span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>), </span>
<span id="cb8-9"><a href="linreg.html#cb8-9"></a>                                 <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">155</span>))</span>
<span id="cb8-10"><a href="linreg.html#cb8-10"></a>cred_y_axis =<span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">name =</span> <span class="st">&quot;Balance&quot;</span>, </span>
<span id="cb8-11"><a href="linreg.html#cb8-11"></a>                     <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">200</span>, <span class="dv">600</span>, <span class="dv">1000</span>, <span class="dv">1400</span>), </span>
<span id="cb8-12"><a href="linreg.html#cb8-12"></a>                     <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">200</span>, <span class="dv">1400</span>))</span>
<span id="cb8-13"><a href="linreg.html#cb8-13"></a>cred_colour_scale =<span class="st"> </span><span class="kw">scale_colour_manual</span>(<span class="dt">name =</span> <span class="ot">NULL</span>, </span>
<span id="cb8-14"><a href="linreg.html#cb8-14"></a>                                        <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;red&quot;</span>))</span>
<span id="cb8-15"><a href="linreg.html#cb8-15"></a></span>
<span id="cb8-16"><a href="linreg.html#cb8-16"></a>credit_no_interaction =<span class="st"> </span>credit <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb8-17"><a href="linreg.html#cb8-17"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">balance_pred =</span> <span class="kw">predict</span>(credit_lm, credit)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb8-18"><a href="linreg.html#cb8-18"></a><span class="st">  </span><span class="kw">ggplot</span>(., <span class="kw">aes</span>(<span class="dt">x =</span> Income, <span class="dt">y =</span> balance_pred, <span class="dt">colour =</span> Student))<span class="op">+</span></span>
<span id="cb8-19"><a href="linreg.html#cb8-19"></a><span class="st">  </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> F)<span class="op">+</span></span>
<span id="cb8-20"><a href="linreg.html#cb8-20"></a><span class="st">  </span>cred_x_axis<span class="op">+</span></span>
<span id="cb8-21"><a href="linreg.html#cb8-21"></a><span class="st">  </span>cred_y_axis<span class="op">+</span></span>
<span id="cb8-22"><a href="linreg.html#cb8-22"></a><span class="st">  </span>cred_colour_scale<span class="op">+</span></span>
<span id="cb8-23"><a href="linreg.html#cb8-23"></a><span class="st">  </span><span class="kw">theme_islr</span>()<span class="op">+</span></span>
<span id="cb8-24"><a href="linreg.html#cb8-24"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb8-25"><a href="linreg.html#cb8-25"></a></span>
<span id="cb8-26"><a href="linreg.html#cb8-26"></a><span class="co"># create multiple linear model w/interaction</span></span>
<span id="cb8-27"><a href="linreg.html#cb8-27"></a>credit_lm_int =<span class="st"> </span><span class="kw">lm</span>(Balance<span class="op">~</span>Income<span class="op">+</span>Student<span class="op">+</span>Income<span class="op">*</span>Student, <span class="dt">data =</span> credit)</span>
<span id="cb8-28"><a href="linreg.html#cb8-28"></a><span class="co"># summary(credit_lm_int)</span></span>
<span id="cb8-29"><a href="linreg.html#cb8-29"></a></span>
<span id="cb8-30"><a href="linreg.html#cb8-30"></a>credit_interaction =<span class="st"> </span>credit <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb8-31"><a href="linreg.html#cb8-31"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">balance_pred =</span> <span class="kw">predict</span>(credit_lm_int, credit)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb8-32"><a href="linreg.html#cb8-32"></a><span class="st">  </span><span class="kw">ggplot</span>(., <span class="kw">aes</span>(<span class="dt">x =</span> Income, <span class="dt">y =</span> balance_pred, <span class="dt">colour =</span> Student))<span class="op">+</span></span>
<span id="cb8-33"><a href="linreg.html#cb8-33"></a><span class="st">  </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> F)<span class="op">+</span></span>
<span id="cb8-34"><a href="linreg.html#cb8-34"></a><span class="st">  </span>cred_x_axis<span class="op">+</span></span>
<span id="cb8-35"><a href="linreg.html#cb8-35"></a><span class="st">  </span>cred_y_axis<span class="op">+</span></span>
<span id="cb8-36"><a href="linreg.html#cb8-36"></a><span class="st">  </span>cred_colour_scale<span class="op">+</span></span>
<span id="cb8-37"><a href="linreg.html#cb8-37"></a><span class="st">  </span><span class="kw">theme_islr</span>()<span class="op">+</span></span>
<span id="cb8-38"><a href="linreg.html#cb8-38"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">25</span>, <span class="fl">.91</span>), <span class="dt">legend.margin =</span> <span class="kw">margin</span>())</span>
<span id="cb8-39"><a href="linreg.html#cb8-39"></a></span>
<span id="cb8-40"><a href="linreg.html#cb8-40"></a>credit_no_interaction <span class="op">+</span><span class="st"> </span>credit_interaction<span class="op">+</span></span>
<span id="cb8-41"><a href="linreg.html#cb8-41"></a><span class="st">  </span><span class="kw">plot_layout</span>(<span class="dt">nrow =</span> <span class="dv">1</span>, <span class="dt">widths =</span> <span class="kw">c</span>(.<span class="dv">5</span>, <span class="fl">.5</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:credit-lm"></span>
<img src="03-linear-regression_files/figure-html/credit-lm-1.png" alt="*For the &lt;strong&gt;&lt;span style='font-family:monospace; color: #B44C1C;'&gt;Credit&lt;/span&gt;&lt;/strong&gt; data, the least squares lines are shown for prediction of &lt;strong&gt;&lt;span style='font-family:monospace; color: #B44C1C;'&gt;balance&lt;/span&gt;&lt;/strong&gt; from &lt;strong&gt;&lt;span style='font-family:monospace; color: #B44C1C;'&gt;income&lt;/span&gt;&lt;/strong&gt; for students and non-students.* Left: *The model (3.34) was fit. There is no interaction between &lt;strong&gt;&lt;span style='font-family:monospace; color: #B44C1C;'&gt;income&lt;/span&gt;&lt;/strong&gt; and &lt;strong&gt;&lt;span style='font-family:monospace; color: #B44C1C;'&gt;student&lt;/span&gt;&lt;/strong&gt;.* Right: *The model (3.35) was fit. There is an interaction term between &lt;strong&gt;&lt;span style='font-family:monospace; color: #B44C1C;'&gt;income&lt;/span&gt;&lt;/strong&gt; and &lt;strong&gt;&lt;span style='font-family:monospace; color: #B44C1C;'&gt;student&lt;/span&gt;&lt;/strong&gt;.*" width="1152" />
<p class="caption">
FIGURE 2.3: <em>For the <strong><span style="font-family:monospace; color: #B44C1C;">Credit</span></strong> data, the least squares lines are shown for prediction of <strong><span style="font-family:monospace; color: #B44C1C;">balance</span></strong> from <strong><span style="font-family:monospace; color: #B44C1C;">income</span></strong> for students and non-students.</em> Left: <em>The model (3.34) was fit. There is no interaction between <strong><span style="font-family:monospace; color: #B44C1C;">income</span></strong> and <strong><span style="font-family:monospace; color: #B44C1C;">student</span></strong>.</em> Right: <em>The model (3.35) was fit. There is an interaction term between <strong><span style="font-family:monospace; color: #B44C1C;">income</span></strong> and <strong><span style="font-family:monospace; color: #B44C1C;">student</span></strong>.</em>
</p>
</div>
</div>
<div id="non-linear-relationships" class="section level4">
<h4><span class="header-section-number">2.3.2.2</span> Non-linear Relationships</h4>
<p>As discussed previously, the linear regression model <a href="linreg.html#eq:mlin-reg">(2.19)</a> assumes a linear relationship between the response and predictors.
But in some cases, the true relationship between the response and the predictors may be non-linear.
Here we present a very simple way to directly extend the linear model to accommodate non-linear relationships, using <strong><span style="font-family:monospace; color: #1188ce;">polynomial regression</span></strong>.
In later chapters, we will present more complex approaches for performing non-linear fits in more general settings.</p>
<p>Consider Figure 3.8, in which the <code>mpg</code> (gas mileage in miles per gallon) versus <code>horsepower</code> is shown for a number of cars in the <code>Auto</code> data set.</p>
<p>FIGURE 3.8</p>
<p>The orange line represents the linear regression fit.
There is a pronounced relationship between <code>mpg</code> and <code>horsepower</code>, but it seems clear that this relationship is in fact non-linear: the data suggest a curved relationship.
A simple approach for incorporating non-linear associations in a linear model is to include transformed versions of the predictors in the model.
For example, the points in Figure 3.8 seem to have a <strong><span style="font-family:monospace; color: #1188ce;">quadratic</span></strong> shape, suggesting that a model of the form</p>
<p><span class="math display" id="eq:mpg-quad">\[\begin{equation}
  \color{#B44C1C}{mpg} = \beta_0 + \beta_1 \times \color{#B44C1C}{horsepower} + \beta_2 \times \color{#B44C1C}{horsepower^2} + \epsilon
  \tag{2.36}
\end{equation}\]</span></p>
<p>may provide a better fit.
Equation <a href="linreg.html#eq:mpg-quad">(2.36)</a> involves predicting <code>mpg</code> using a non-linear function of <code>horsepower</code>.
<em>But it is still a linear model!</em>
That is, <a href="linreg.html#eq:mpg-quad">(2.36)</a> is simply a multiple linear regression model with <span class="math inline">\(X_1 = \color{#B44C1C}{horsepower}\)</span> and <span class="math inline">\(X_2 = \color{#B44C1C}{horsepower^2}\)</span>.
So we can use standard linear regression software to estimate <span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta_1\)</span>, and <span class="math inline">\(\beta_2\)</span> in order to produce a non-linear fit.
The blue curve in Figure 3.8 shows the resulting quadratic fit to the data.
The quadratic fit appears to be substantially better than the fit obtained when just the linear term is included.
The <span class="math inline">\(R^2\)</span> of the quadratic fit is <span class="math inline">\(0.688\)</span>, compared to <span class="math inline">\(0.606\)</span> for the linear fit, and the p-value in Table 3.10 for the quadratic term is highly significant.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="linreg.html#cb9-1"></a>mpg_lm =<span class="st"> </span><span class="kw">lm</span>(mpg<span class="op">~</span>horsepower<span class="op">+</span><span class="kw">I</span>(horsepower<span class="op">^</span><span class="dv">2</span>), <span class="dt">data =</span> Auto)</span>
<span id="cb9-2"><a href="linreg.html#cb9-2"></a></span>
<span id="cb9-3"><a href="linreg.html#cb9-3"></a></span>
<span id="cb9-4"><a href="linreg.html#cb9-4"></a><span class="co"># estimate the linear model</span></span>
<span id="cb9-5"><a href="linreg.html#cb9-5"></a>mpg_lm =<span class="st"> </span><span class="kw">lm</span>(mpg<span class="op">~</span>horsepower<span class="op">+</span><span class="kw">I</span>(horsepower<span class="op">^</span><span class="dv">2</span>), <span class="dt">data =</span> Auto)</span>
<span id="cb9-6"><a href="linreg.html#cb9-6"></a></span>
<span id="cb9-7"><a href="linreg.html#cb9-7"></a><span class="co"># Clean up the model output</span></span>
<span id="cb9-8"><a href="linreg.html#cb9-8"></a><span class="kw">prep_reg_table</span>(mpg_lm) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-9"><a href="linreg.html#cb9-9"></a><span class="st">  </span><span class="co"># use reactable to produce the table</span></span>
<span id="cb9-10"><a href="linreg.html#cb9-10"></a><span class="st">  </span><span class="kw">reactable</span>(</span>
<span id="cb9-11"><a href="linreg.html#cb9-11"></a>    <span class="dt">borderless =</span> T,</span>
<span id="cb9-12"><a href="linreg.html#cb9-12"></a>    <span class="dt">sortable =</span> F,</span>
<span id="cb9-13"><a href="linreg.html#cb9-13"></a>    <span class="dt">defaultColDef =</span> <span class="kw">colDef</span>(<span class="dt">format =</span> <span class="kw">colFormat</span>(<span class="dt">digits =</span> <span class="dv">3</span>)),</span>
<span id="cb9-14"><a href="linreg.html#cb9-14"></a>    <span class="co"># Specific column formats</span></span>
<span id="cb9-15"><a href="linreg.html#cb9-15"></a>    <span class="dt">columns =</span> <span class="kw">list</span>(</span>
<span id="cb9-16"><a href="linreg.html#cb9-16"></a>      <span class="dt">term =</span> <span class="kw">colDef</span>(</span>
<span id="cb9-17"><a href="linreg.html#cb9-17"></a>        <span class="dt">name =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb9-18"><a href="linreg.html#cb9-18"></a>        <span class="dt">style =</span> <span class="kw">list</span>(<span class="dt">borderRight =</span> <span class="st">&quot;2px solid black&quot;</span>,</span>
<span id="cb9-19"><a href="linreg.html#cb9-19"></a>                                 <span class="dt">color =</span> <span class="st">&quot;#B44C1C&quot;</span>,</span>
<span id="cb9-20"><a href="linreg.html#cb9-20"></a>                                 <span class="dt">fontFamily =</span> <span class="st">&quot;Roboto Mono&quot;</span>),</span>
<span id="cb9-21"><a href="linreg.html#cb9-21"></a>        <span class="dt">headerStyle =</span> <span class="kw">list</span>(<span class="dt">borderRight =</span> <span class="st">&quot;2px solid black&quot;</span>)),</span>
<span id="cb9-22"><a href="linreg.html#cb9-22"></a>      <span class="st">`</span><span class="dt">t-statistic</span><span class="st">`</span> =<span class="st"> </span><span class="kw">colDef</span>(<span class="dt">format =</span> <span class="kw">colFormat</span>(<span class="dt">digits =</span> <span class="dv">2</span>))</span>
<span id="cb9-23"><a href="linreg.html#cb9-23"></a>    )</span>
<span id="cb9-24"><a href="linreg.html#cb9-24"></a>  )</span>
<span id="cb9-25"><a href="linreg.html#cb9-25"></a></span>
<span id="cb9-26"><a href="linreg.html#cb9-26"></a><span class="co"># Put the caption beneath the table</span></span>
<span id="cb9-27"><a href="linreg.html#cb9-27"></a><span class="kw">rt_caption</span>(</span>
<span id="cb9-28"><a href="linreg.html#cb9-28"></a>  <span class="dt">text =</span> <span class="kw">str_c</span>(<span class="st">&quot;For the &quot;</span>, <span class="kw">data_colour</span>(<span class="st">&quot;Auto&quot;</span>), <span class="st">&quot; data set, least squares coefficient estimates associated with the regression of &quot;</span>, <span class="kw">data_colour</span>(<span class="st">&quot;mpg&quot;</span>), <span class="st">&quot; onto &quot;</span>, <span class="kw">data_colour</span>(<span class="st">&quot;horsepower&quot;</span>), <span class="st">&quot; and &quot;</span>, <span class="kw">data_colour</span>(<span class="st">&quot;horsepower^2&quot;</span>), <span class="st">&quot;.&quot;</span>), </span>
<span id="cb9-29"><a href="linreg.html#cb9-29"></a>  <span class="dt">tab_num =</span> <span class="st">&quot;3.10&quot;</span></span>
<span id="cb9-30"><a href="linreg.html#cb9-30"></a>  )</span></code></pre></div>
<p><div id="htmlwidget-aef7e650fd06417b33d6" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-aef7e650fd06417b33d6">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"term":["Intercept","horsepower","horsepower^2"],"Coefficient":[56.9000997021131,-0.466189629947354,0.00123053610077392],"Std. Error":[1.80042680630742,0.0311246171195557,0.000122075862760411],"t-statistic":[31.6036728084559,-14.978164330717,10.0800934185409],"p-value":["<0.0001","<0.0001","<0.0001"]},"columns":[{"accessor":"term","name":"","type":"character","format":{"cell":{"digits":3},"aggregated":{"digits":3}},"style":{"borderRight":"2px solid black","color":"#B44C1C","fontFamily":"Roboto Mono"},"headerStyle":{"borderRight":"2px solid black"}},{"accessor":"Coefficient","name":"Coefficient","type":"numeric","format":{"cell":{"digits":3},"aggregated":{"digits":3}}},{"accessor":"Std. Error","name":"Std. Error","type":"numeric","format":{"cell":{"digits":3},"aggregated":{"digits":3}}},{"accessor":"t-statistic","name":"t-statistic","type":"numeric","format":{"cell":{"digits":2},"aggregated":{"digits":2}}},{"accessor":"p-value","name":"p-value","type":"character","format":{"cell":{"digits":3},"aggregated":{"digits":3}}}],"sortable":false,"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"borderless":true,"theme":{"color":"#333","tableStyle":{"borderTop":"2px solid black","borderBottom":"2px solid black"},"headerStyle":{"borderBottom":"2px solid black"}},"dataKey":"3ee1ae39c81f552d6546bbe3a8ddb95c","key":"3ee1ae39c81f552d6546bbe3a8ddb95c"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script><p class="caption">
<span class="tab-num">TABLE 3.10.</span>
<em>For the <strong><span style='font-family:monospace; color: #B44C1C;'>Auto</span></strong> data set, least squares coefficient estimates associated with the regression of <strong><span style='font-family:monospace; color: #B44C1C;'>mpg</span></strong> onto <strong><span style='font-family:monospace; color: #B44C1C;'>horsepower</span></strong> and <strong><span style='font-family:monospace; color: #B44C1C;'>horsepower^2</span></strong>.</em>
</p></p>
<p>If including <span class="math inline">\(\color{#B44C1C}{horsepower^2}\)</span> led to such a big improvement in the model, why not include <span class="math inline">\(\color{#B44C1C}{horsepower^3}\)</span>, <span class="math inline">\(\color{#B44C1C}{horsepower^4}\)</span>, or even <span class="math inline">\(\color{#B44C1C}{horsepower^5}\)</span>?
The green curve in Figure 3.8 displays the fit that results from including all polynomials up to fifth degree in the model <a href="linreg.html#eq:mpg-quad">(2.36)</a>.
The resulting fit seems unnecessarily wiggly—that is, it is unclear that including the additional terms really has led to a better fit to the data.</p>
<p>The approach that we have just described for extending the linear model to accommodate non-linear relationships is known as <em>polynomial regression</em>, since we have included polynomial functions of the predictors in the regression model.
We further explore this approach and other non-linear extensions of the linear model in Chapter 7.</p>
</div>
</div>
<div id="potential-problems" class="section level3">
<h3><span class="header-section-number">2.3.3</span> Potential Problems</h3>
<p>When we fit a linear regression model to a particular data set, many problems may occur.
Most common among these are the following:</p>
<ol style="list-style-type: decimal">
<li><em>Non linearity of the response-predictor relationships.</em></li>
<li><em>Correlation of error terms.</em></li>
<li><em>Non-constant variance of error terms.</em></li>
<li><em>Outliers.</em></li>
<li><em>High-leverage points.</em></li>
<li><em>Collinearity.</em></li>
</ol>
<p>In practice, identifying and overcoming these problems is as much an art as a science.
Many pages in countless books have been written on this topic.
Since the linear regression model is not our primary focus here, we will provide only a brief summary of some key points.</p>
<div id="non-linearity-of-the-data" class="section level4">
<h4><span class="header-section-number">2.3.3.1</span> 1. Non-linearity of the Data</h4>
<p>The linear regression model assumes that there is a straight-line relationships between the predictors and the response.
If the true relationship is far from linear, then virtually all conclusions that we draw from the fit are suspect.
In addition, the prediction accuracy of the model can be significantly reduced.</p>
<p><strong><span style="font-family:monospace; color: #1188ce;">Residual plots</span></strong> are a useful graphical tool for identifying non-linearity.
Given a simple linear regression model, we can plot the residuals <span class="math inline">\(e_i = y_i - \hat{y_i}\)</span>, versus the predictor <span class="math inline">\(x_i\)</span>.
In the case of a multiple linear regression model, since there are multiple predictors, we instead plot the residuals versus the predicted (or <strong><span style="font-family:monospace; color: #1188ce;">fitted</span></strong>) values <span class="math inline">\(\hat{y_i}\)</span>.
Ideally, the residual plot will show no discernible pattern.
The presence of a pattern may indicate a problem with some aspect of the linear model.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="linreg.html#cb10-1"></a><span class="co"># fit simple linear model</span></span>
<span id="cb10-2"><a href="linreg.html#cb10-2"></a>mpg_lm_simple =<span class="st"> </span><span class="kw">lm</span>(mpg<span class="op">~</span>horsepower, <span class="dt">data =</span> Auto)</span>
<span id="cb10-3"><a href="linreg.html#cb10-3"></a></span>
<span id="cb10-4"><a href="linreg.html#cb10-4"></a><span class="co"># make dataframe of residuals and fitted values for simple linear model</span></span>
<span id="cb10-5"><a href="linreg.html#cb10-5"></a>linear_fit =<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">Residuals =</span> mpg_lm_simple<span class="op">$</span>residuals,</span>
<span id="cb10-6"><a href="linreg.html#cb10-6"></a>                    <span class="dt">fitted =</span> mpg_lm_simple<span class="op">$</span>fitted.values,</span>
<span id="cb10-7"><a href="linreg.html#cb10-7"></a>                    <span class="dt">fit_type =</span> <span class="st">&quot;Residual Plot for Linear Fit&quot;</span>)</span>
<span id="cb10-8"><a href="linreg.html#cb10-8"></a></span>
<span id="cb10-9"><a href="linreg.html#cb10-9"></a><span class="co"># make dataframe of residuals and fitted values for multiple linear model w/quadratic predictor</span></span>
<span id="cb10-10"><a href="linreg.html#cb10-10"></a>quad_fit =<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">Residuals =</span> mpg_lm<span class="op">$</span>residuals,</span>
<span id="cb10-11"><a href="linreg.html#cb10-11"></a>                    <span class="dt">fitted =</span> mpg_lm<span class="op">$</span>fitted.values,</span>
<span id="cb10-12"><a href="linreg.html#cb10-12"></a>                    <span class="dt">fit_type =</span> <span class="st">&quot;Residual Plot for Quadratic Fit&quot;</span>)</span>
<span id="cb10-13"><a href="linreg.html#cb10-13"></a></span>
<span id="cb10-14"><a href="linreg.html#cb10-14"></a><span class="co"># assign consistent plot elements</span></span>
<span id="cb10-15"><a href="linreg.html#cb10-15"></a>res_zeroline =<span class="st"> </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">colour =</span> <span class="st">&quot;grey50&quot;</span>)</span>
<span id="cb10-16"><a href="linreg.html#cb10-16"></a>mpg_x_axis =<span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">name =</span> <span class="st">&quot;Fitted values&quot;</span>, </span>
<span id="cb10-17"><a href="linreg.html#cb10-17"></a>                                <span class="dt">breaks =</span> scales<span class="op">::</span><span class="kw">pretty_breaks</span>(<span class="dt">n =</span> <span class="dv">6</span>))</span>
<span id="cb10-18"><a href="linreg.html#cb10-18"></a>mpg_y_axis =<span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> scales<span class="op">::</span><span class="kw">pretty_breaks</span>(<span class="dt">n =</span> <span class="dv">7</span>))</span>
<span id="cb10-19"><a href="linreg.html#cb10-19"></a></span>
<span id="cb10-20"><a href="linreg.html#cb10-20"></a><span class="co"># plot linear fit</span></span>
<span id="cb10-21"><a href="linreg.html#cb10-21"></a>linear_plot =<span class="st"> </span>linear_fit <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb10-22"><a href="linreg.html#cb10-22"></a><span class="st">  </span><span class="kw">ggplot</span>(., <span class="kw">aes</span>(<span class="dt">x =</span> fitted, <span class="dt">y =</span> Residuals))<span class="op">+</span></span>
<span id="cb10-23"><a href="linreg.html#cb10-23"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">1</span>, <span class="dt">colour =</span> <span class="st">&quot;grey30&quot;</span>)<span class="op">+</span></span>
<span id="cb10-24"><a href="linreg.html#cb10-24"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">se =</span> F, , <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>)<span class="op">+</span></span>
<span id="cb10-25"><a href="linreg.html#cb10-25"></a><span class="st">  </span>res_zeroline<span class="op">+</span></span>
<span id="cb10-26"><a href="linreg.html#cb10-26"></a><span class="st">  </span>mpg_x_axis<span class="op">+</span></span>
<span id="cb10-27"><a href="linreg.html#cb10-27"></a><span class="st">  </span>mpg_y_axis<span class="op">+</span></span>
<span id="cb10-28"><a href="linreg.html#cb10-28"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="kw">unique</span>(linear_fit<span class="op">$</span>fit_type))<span class="op">+</span></span>
<span id="cb10-29"><a href="linreg.html#cb10-29"></a><span class="st">  </span><span class="kw">theme_islr</span>()<span class="op">+</span></span>
<span id="cb10-30"><a href="linreg.html#cb10-30"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.subtitle =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">.5</span>))</span>
<span id="cb10-31"><a href="linreg.html#cb10-31"></a></span>
<span id="cb10-32"><a href="linreg.html#cb10-32"></a><span class="co"># plot quad fit</span></span>
<span id="cb10-33"><a href="linreg.html#cb10-33"></a>quad_plot =<span class="st"> </span>quad_fit <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb10-34"><a href="linreg.html#cb10-34"></a><span class="st">  </span><span class="kw">ggplot</span>(., <span class="kw">aes</span>(<span class="dt">x =</span> fitted, <span class="dt">y =</span> Residuals))<span class="op">+</span></span>
<span id="cb10-35"><a href="linreg.html#cb10-35"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">1</span>, <span class="dt">colour =</span> <span class="st">&quot;grey30&quot;</span>)<span class="op">+</span></span>
<span id="cb10-36"><a href="linreg.html#cb10-36"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">se =</span> F, , <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>)<span class="op">+</span></span>
<span id="cb10-37"><a href="linreg.html#cb10-37"></a><span class="st">  </span>res_zeroline<span class="op">+</span></span>
<span id="cb10-38"><a href="linreg.html#cb10-38"></a><span class="st">  </span>mpg_x_axis<span class="op">+</span></span>
<span id="cb10-39"><a href="linreg.html#cb10-39"></a><span class="st">  </span>mpg_y_axis<span class="op">+</span></span>
<span id="cb10-40"><a href="linreg.html#cb10-40"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="kw">unique</span>(quad_fit<span class="op">$</span>fit_type))<span class="op">+</span></span>
<span id="cb10-41"><a href="linreg.html#cb10-41"></a><span class="st">  </span><span class="kw">theme_islr</span>()<span class="op">+</span></span>
<span id="cb10-42"><a href="linreg.html#cb10-42"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.subtitle =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">.5</span>))</span>
<span id="cb10-43"><a href="linreg.html#cb10-43"></a></span>
<span id="cb10-44"><a href="linreg.html#cb10-44"></a><span class="co"># add the plots together</span></span>
<span id="cb10-45"><a href="linreg.html#cb10-45"></a>linear_plot <span class="op">+</span><span class="st"> </span>quad_plot</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:auto-res-plot"></span>
<img src="03-linear-regression_files/figure-html/auto-res-plot-1.png" alt="*Plots of residuals versus predicted (or fitted) values for the &lt;strong&gt;&lt;span style='font-family:monospace; color: #B44C1C;'&gt;Auto&lt;/span&gt;&lt;/strong&gt; data set. In each plot, the red line is a smooth fit to the residuals, intended to make it easier to identify a trend.* Left: *A linear regression of &lt;strong&gt;&lt;span style='font-family:monospace; color: #B44C1C;'&gt;mpg&lt;/span&gt;&lt;/strong&gt; on &lt;strong&gt;&lt;span style='font-family:monospace; color: #B44C1C;'&gt;horsepower&lt;/span&gt;&lt;/strong&gt;. A strong pattern in the residuals indicates non-linearity in the data.* Right: *A linear regression of &lt;strong&gt;&lt;span style='font-family:monospace; color: #B44C1C;'&gt;mpg&lt;/span&gt;&lt;/strong&gt; on &lt;strong&gt;&lt;span style='font-family:monospace; color: #B44C1C;'&gt;horsepower&lt;/span&gt;&lt;/strong&gt; and &lt;strong&gt;&lt;span style='font-family:monospace; color: #B44C1C;'&gt;horsepower^2&lt;/span&gt;&lt;/strong&gt;. There is little pattern in the residuals.*" width="1152" />
<p class="caption">
FIGURE 2.4: <em>Plots of residuals versus predicted (or fitted) values for the <strong><span style="font-family:monospace; color: #B44C1C;">Auto</span></strong> data set. In each plot, the red line is a smooth fit to the residuals, intended to make it easier to identify a trend.</em> Left: <em>A linear regression of <strong><span style="font-family:monospace; color: #B44C1C;">mpg</span></strong> on <strong><span style="font-family:monospace; color: #B44C1C;">horsepower</span></strong>. A strong pattern in the residuals indicates non-linearity in the data.</em> Right: <em>A linear regression of <strong><span style="font-family:monospace; color: #B44C1C;">mpg</span></strong> on <strong><span style="font-family:monospace; color: #B44C1C;">horsepower</span></strong> and <strong><span style="font-family:monospace; color: #B44C1C;">horsepower^2</span></strong>. There is little pattern in the residuals.</em>
</p>
</div>
<p>The left panel of Figure 3.9 displays a residual plot from the linear regression of <code>mpg</code> onto <code>horsepower</code> on the <code>Auto</code> data set that was illustrated in Figure 3.8.
The red line is a smooth fit to the residuals, which is displayed in order to make it easier to identify any trends.
The residuals exhibit a clear U-shape, which provides a strong indication of non-linearity in the data.
In contract, the right-hand panel of Figure 3.9 displays the residual plot that results from the model <a href="linreg.html#eq:mpg-quad">(2.36)</a>, which contains a quadratic term.
There appears to be little pattern in the residuals, suggesting that the quadratic term improves the fit to the data.</p>
<p>If the residual plot indicates that there are non-linear associations in the data, then a simple approach is to use non-linear transformations of the predictors, such as log <span class="math inline">\(X\)</span>, <span class="math inline">\(\sqrt{X}\)</span>, and <span class="math inline">\(X^2\)</span>, in the regression model.
In the later chapters of this book, we will discuss other more advanced non-linear approaches for addressing this issue.</p>
</div>
<div id="correlation-of-error-terms" class="section level4">
<h4><span class="header-section-number">2.3.3.2</span> 2. Correlation of Error Terms</h4>
<p>An important assumption of the linear regression model is that the error terms <span class="math inline">\(\epsilon_1, \epsilon_2, ..., \epsilon_n\)</span>, are uncorrelated.
What does this mean?
For instance, if the errors are uncorrelated, then the fact that <span class="math inline">\(\epsilon_i\)</span> is positive provides little or no information abou the sign of <span class="math inline">\(\epsilon_{i+1}\)</span>.
The standard errors that are computed for the estimated regression coefficients or the fitted values are based on the assumption of uncorrelated error terms.
If in fact there is correlation among the error terms, then the estimated standard errors will tend to underestimate the true standard errors.
As a result, confidence and prediction intervals will be narrower than they should be.
For example, a <span class="math inline">\(95\%\)</span> confidence interval may in reality have a much lower probability than <span class="math inline">\(0.95\)</span> of containing the true value of the parameter.
In addition, p-values associated with the model will be lower than they should be: this could cause us to erroneously conclude that a parameter is statistically significant.
In short, if the error terms are correlated, we may have an unwarranted sense of confidence in our model.</p>
<p>As an extreme example, suppose we accidentally doubled our data, leading to observations and error terms identical in pairs.
If we ignored this, our standard error calculations would be as if we had a sample size of <span class="math inline">\(2n\)</span>, when in fact we only have <span class="math inline">\(n\)</span> samples.
Our estimated parameters would be the same for <span class="math inline">\(2n\)</span> samples as for the <span class="math inline">\(n\)</span> samples, but the confidence intervals would be narrower by a factor of <span class="math inline">\(\sqrt{2}\)</span>!</p>
<p>Why might correlations among the error terms occur?
Such correlations frequently occur in the context of <strong><span style="font-family:monospace; color: #1188ce;">time series</span></strong> data, which consists of observations for which measurements are obtained at discrete points in time.
In many cases, observations that are obtained at adjacent time points will have positively correlated errors.
In order to determine if this is the case for a given data set, we can plot the residuals from our model as a function of time.
If the errors are uncorrelated, then there should be no discernible pattern.
On the other hand, if the error terms are positively correlated, then we may see <strong><span style="font-family:monospace; color: #1188ce;">tracking</span></strong> in the residuals—that is, adjacent residuals may have similar values.
Figure 3.10 provides an illustration.
In the top panel, we see the residuals from a linear regression fit to data generated with uncorrelated errors.
There is no evidence of a time-related trend in the residuals.
In contrast, the residuals in the bottom panel are from a data set in which adjacent errors had a correlation of <span class="math inline">\(0.9\)</span>.
Now there is a clear pattern in the residuals—adjacent residuals tend to take on similar values.
Finally, the center panel illustrates a more moerate case in which the residuals had a correlation of <span class="math inline">\(0.5\)</span>.
There is still evidence of tracking, but the pattern is less clear.</p>
<p>Many methods have been developed to properly take account of correlations in the error terms in time series data.
Correlation among the error terms can also occur outside of time series data.
For instance, consider a study in which individuals’ heights are predicted from their weights.
The assumption of uncorrelated errors could be violated if some of the individuals in the study are members of the same family, or eat the same diet, or have been exposed to the same environmental factors.
In general, the assumption of uncorrelated errors is extremely important for linear regression as well as for other statistical methods, and good experimental design is crucial in order to mitigate the risk of such correlations.</p>
<p>FIGURE 3.10</p>
</div>
<div id="non-constant-variance-of-error-terms" class="section level4">
<h4><span class="header-section-number">2.3.3.3</span> 3. Non-constant Variance of Error Terms</h4>
<p>Another important assumption of the linear regression model is that the error terms have a constant variance, <span class="math inline">\(Var(\epsilon_i) = \sigma^2\)</span>.
The standard errors, confidence intervals, and hypothesis tests associated with the linear model rely upon this assumption.</p>
<p>Unfortunately, it is often the case that the variances of the error terms are non-constant.
For instance, the variances of the error terms may increase with the value of the response.
One can identify non-constant variances in the errors, or <strong><span style="font-family:monospace; color: #1188ce;">heteroscedasticity</span></strong>, from the presence of a <em>funnel shape</em> in the residuals plot.
An example is shown in the left-hand panel of Figure 3.11, in which the magnitude of the residuals tends to increase with the fitted values.
When faced with this problem, one possible solution is to transform the response <span class="math inline">\(Y\)</span> using a concave function such as log <span class="math inline">\(Y\)</span> or <span class="math inline">\(\sqrt{Y}\)</span>.
Such a transformation results in a greater amount of shrinkage of the larger responses, leading to a reduction in heteroscedasticity.
The right-hand panel of Figure 3.11 displays the residual plot after transforming the response using log <span class="math inline">\(Y\)</span>.
The residuals now appear to have constant variance, though there is some evidence of a slight non-linear relationship in the data.</p>
<p>FIGURE 3.11</p>
<p>Sometimes we have a good idea of the variance of each response.
For example, the <em>i</em>th response could be an average of <span class="math inline">\(n_i\)</span> raw observations.
If each of these raw observations is uncorrelated with variance <span class="math inline">\(\sigma^2\)</span> then our average has variance <span class="math inline">\(\sigma_i^2 = \sigma^2/n_i\)</span>.
In this case a simple remedy is to fit our model by <strong><span style="font-family:monospace; color: #1188ce;">weighted least squares</span></strong>, with weights proportional to the inverse variances—i.e. <span class="math inline">\(w_i = n_i\)</span> in this case.
Most linear regression software allows for observation weights.</p>
</div>
<div id="outliers" class="section level4">
<h4><span class="header-section-number">2.3.3.4</span> 4. Outliers</h4>
<p>An <strong><span style="font-family:monospace; color: #1188ce;">outlier</span></strong> is a point for which <span class="math inline">\(y_i\)</span> is far from the value predicted by the model.
Outliers can arise for a variety of reasons, such as incorrect recording of an observation during data collection.</p>
<p>The red point (observation 20) in the left-hand panel of Figure 3.12 illustrates a typical outlier.
The red solid line is the least squares regression fit, while the blue dashed line is the least squares fit after removal of the outlier.
In this case, removing the outlier has little effect on the least squares line: it leads to almost no change in the slope, and a miniscule reduction in the intercept.
It is typical for an outlier that does not have an unusual predictor value to have little effect on the least squares fit.
However, even if an outlier does not have much effect on the least squares fit, it can cause other problems.
For instance, in this example, the RSE is <span class="math inline">\(1.09\)</span> when the outlier is included in the regression, but it is only <span class="math inline">\(0.77\)</span> when the outlier is removed.
Since the RSE is used to compute confidence intervals and p-values, such a dramatic increase caused by a single data point can have implications for the interpretation of the fit.
Similarly, inclusion of the outlier causes the <span class="math inline">\(R^2\)</span> to decline from <span class="math inline">\(0.892\)</span> to <span class="math inline">\(0.805\)</span>.</p>
<p>FIGURE 3.12</p>
<p>Residual plots can be used to identify outliers.
In this example, the outlier is clearly visible in the residual plot illustrated in the center panel of Figure 3.12.
But in practice, it can be difficult to decide how large a residual needs to be before we consider the point to be an outlier.
To address this problem, instead of plotting the residuals, we can plot the <strong><span style="font-family:monospace; color: #1188ce;">studentized residuals</span></strong>, computed by dividing each residual <span class="math inline">\(e_i\)</span> by its estimated standard error.
Observations whose studentized residuals are greater than 3 in absolute value are possible outliers.
In the right-hand panel of Figure 3.12, the outlier’s studentized residual exceeds 6, while all other observations have studentized residuals between <span class="math inline">\(-2\)</span> and <span class="math inline">\(2\)</span>.</p>
<p>If we believe that an outlier has occurred due to an error in data collection or recording, then one solution is to simply remove the observation.
However, care should be taken, since an outlier may instead indicate a deficiency with the model, such as a missing predictor.</p>
</div>
<div id="high-leverage-points" class="section level4">
<h4><span class="header-section-number">2.3.3.5</span> 5. High Leverage Points</h4>
<p>We just saw that outliers are observations for which response <span class="math inline">\(y_i\)</span> is unusual given the predictor <span class="math inline">\(x_i\)</span>.
In contrast, observations with <strong><span style="font-family:monospace; color: #1188ce;">high leverage</span></strong> have an unusual value for <span class="math inline">\(x_i\)</span>.
For example, observation 41 in the left-hand panel of Figure 3.13 has high leverage, in that the predictor value for this observation is large relative to the other observations.
(Note that the data displayed in Figure 3.13 are the same as the data in Figure 3.12, but with the addition of a single high leverage observation.)</p>
<p>FIGURE 3.13</p>
<p>The red solid line is the least squares fit to the data, while the blue dashed line is the fit produced when observation 41 is removed.
Comparing the left-hand panels of Figures 3.12 and 3.13, we observe that removing the high leverage observation has a much more substantial impact on the least squares line than removing the outlier.
In fact, high leverage observations tend to have a sizable impact on the estimated regression line.
It is cause for concern if the least squares line is heavily affected by just a couple of observations, because any problems with these points may invalidate the entire fit.
For this reason, it is important to identify high leverage observations.</p>
<p>In a simple linear regression, high leverage observations are fairly easy to identify, since we can simply look for observations for which the predictor value is outside of the normal range of the observations.
But in a multiple linear regression with many predictors, it is possible to have an observation that is well within the range of each individual predictor’s values, but that is unusual in terms of the full set of predictors.
An example is shown in the center panel of Figure 3.13, for a data set with two predictors, <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span>.
Most of the observations’ predictor values fall within the blue dashed ellipse, but the red observation is well outside of this range.
But neither its value for <span class="math inline">\(X_1\)</span> nor its value for <span class="math inline">\(X_2\)</span> is unusual.
So if we examine just <span class="math inline">\(X_1\)</span> or just <span class="math inline">\(X_2\)</span>, we will fail to notice this high leverage point.
This problem is more pronounced in multiple regression settings with more than two predictors, because then there is no simple way to plot all dimensions of the data simultaneously.</p>
<p>In order to quantify an observation’s leverage, we compute the <strong><span style="font-family:monospace; color: #1188ce;">leverage statistic</span></strong>.
A large value of this statistic indicates an observation with high leverage.
For a simple linear regression</p>
<p><span class="math display" id="eq:leverage-stat">\[\begin{equation}
h_i = \frac{1}{n} + \frac{(x_i - \bar{x})^2}{\sum_{i&#39; = 1}^n{(x_{i&#39;} - \bar{x})^2}} .
\tag{2.37}
\end{equation}\]</span></p>
<p>It is clear from this equation that <span class="math inline">\(h_i\)</span> increases with the distance of <span class="math inline">\(x_i\)</span> from <span class="math inline">\(\bar{x}\)</span>.
There is a simple extension of <span class="math inline">\(h_i\)</span> to the case of multiple predictors, though we do not provide the formula here.
The leverage statistic <span class="math inline">\(h_i\)</span> is always between <span class="math inline">\(1/n\)</span> and 1, and the average leverage for all the observations is always equal to <span class="math inline">\((p+1) / n\)</span>.
So if a given observation has a leverage statistic that greatly exceeds <span class="math inline">\((p + 1) / n\)</span>, then we may suspect that the corresponding point has high leverage.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="linreg.html#cb11-1"></a>coll_x_axis =<span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> scales<span class="op">::</span><span class="kw">pretty_breaks</span>(<span class="dv">6</span>))</span>
<span id="cb11-2"><a href="linreg.html#cb11-2"></a></span>
<span id="cb11-3"><a href="linreg.html#cb11-3"></a>(<span class="kw">ggplot</span>(credit, <span class="kw">aes</span>(<span class="dt">x =</span> Limit, <span class="dt">y =</span> Age))<span class="op">+</span></span>
<span id="cb11-4"><a href="linreg.html#cb11-4"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">1</span>, <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>)<span class="op">+</span></span>
<span id="cb11-5"><a href="linreg.html#cb11-5"></a><span class="st">  </span>coll_x_axis<span class="op">+</span></span>
<span id="cb11-6"><a href="linreg.html#cb11-6"></a><span class="st">  </span><span class="kw">theme_islr</span>())<span class="op">+</span></span>
<span id="cb11-7"><a href="linreg.html#cb11-7"></a><span class="st">  </span>(<span class="kw">ggplot</span>(credit, <span class="kw">aes</span>(<span class="dt">x =</span> Limit, <span class="dt">y =</span> Rating))<span class="op">+</span></span>
<span id="cb11-8"><a href="linreg.html#cb11-8"></a><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">1</span>, <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>)<span class="op">+</span></span>
<span id="cb11-9"><a href="linreg.html#cb11-9"></a><span class="st">    </span>coll_x_axis<span class="op">+</span></span>
<span id="cb11-10"><a href="linreg.html#cb11-10"></a><span class="st">    </span><span class="kw">theme_islr</span>())</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:collinearity-plot"></span>
<img src="03-linear-regression_files/figure-html/collinearity-plot-1.png" alt="*Scatterplots of the observations from the &lt;strong&gt;&lt;span style='font-family:monospace; color: #B44C1C;'&gt;Credit&lt;/span&gt;&lt;/strong&gt; data set.* Left: *A plot of &lt;strong&gt;&lt;span style='font-family:monospace; color: #B44C1C;'&gt;age&lt;/span&gt;&lt;/strong&gt; versus &lt;strong&gt;&lt;span style='font-family:monospace; color: #B44C1C;'&gt;limit&lt;/span&gt;&lt;/strong&gt;. These two variables are not collinear.* Right: *A plot of &lt;strong&gt;&lt;span style='font-family:monospace; color: #B44C1C;'&gt;rating&lt;/span&gt;&lt;/strong&gt; versus &lt;strong&gt;&lt;span style='font-family:monospace; color: #B44C1C;'&gt;limit&lt;/span&gt;&lt;/strong&gt;. There is high collinearity.*" width="1152" />
<p class="caption">
FIGURE 2.5: <em>Scatterplots of the observations from the <strong><span style="font-family:monospace; color: #B44C1C;">Credit</span></strong> data set.</em> Left: <em>A plot of <strong><span style="font-family:monospace; color: #B44C1C;">age</span></strong> versus <strong><span style="font-family:monospace; color: #B44C1C;">limit</span></strong>. These two variables are not collinear.</em> Right: <em>A plot of <strong><span style="font-family:monospace; color: #B44C1C;">rating</span></strong> versus <strong><span style="font-family:monospace; color: #B44C1C;">limit</span></strong>. There is high collinearity.</em>
</p>
</div>
<p>The right-hand panel of Figure 3.13 provides a plot of the studentized residuals versus <span class="math inline">\(h_i\)</span> for the data in the left-hand panel of Figure 3.13.
Observation 41 stands out as having a very high leverage statistic as well as a high studentized residual.
In other words, it is an outlier as well as a high leverage observation.
This is a particularly dangerous combination!
This plot also reveals the reason that observation 20 had relatively little effect on the least squares fit in Figure 3.12: it has low leverage.</p>
</div>
<div id="collinearity" class="section level4">
<h4><span class="header-section-number">2.3.3.6</span> 6. Collinearity</h4>
<p><strong><span style="font-family:monospace; color: #1188ce;">Collinearity</span></strong> refers to the situation in which two or more predictor variables are closely related to one another.
The concept of collinearity is illustrated in Figure 3.14 using the <code>Credit</code> data set.
In the left-hand panel of Figure 3.14, the two predictors <code>limit</code> and <code>age</code> appear to have no obvious relationship.
In contrast, in the right-hand panel of Figure 3.14, the predictors <code>limit</code> and <code>rating</code> are very highly correlated with each other, and we say that they are <em>collinear</em>.
The presence of collinearity can pose problems in the regression context, since it can be difficult to separate out the individual effects of collinear variables on the response.
In other words, since <code>limit</code> and <code>rating</code> tend to increase or decrease together, it can be difficult to determine how each one separately is associated with the response, <code>balance</code>.
Figure 3.15 illustrates some of the difficulties that can result from the collinearity.
The left-hand panel of Figure 3.15 is a contour plot of the RSS <a href="linreg.html#eq:rss">(2.3)</a> associated with different possible coefficient estimates for the regression of <code>balance</code> on <code>limit</code> and <code>age</code>.
Each ellipse represents a set of coefficients that correspond to the same RSS, with ellipses nearest to the center taking on the lowest values of RSS.
The black dots and associated dashed lines represent the coefficient estimates that result in the smallest possible RSS—in other words, these are the least squares estimates.
The axes for <code>limit</code> and <code>age</code> have been scaled so that the plot includes possible coefficient estimates that are up to four standard errors on either side of the least squares estimates.
Thus the plot includes all plausible values for the coefficients.
For example, we see that the true <code>limit</code> coefficient is almost certainly somewhere between <span class="math inline">\(0.15\)</span> and <span class="math inline">\(0.20\)</span>.</p>
<p>FIGURE 3.15</p>
<p>In contrast, the right-hand panel of Figure 3.15 displays contour plots of the RSS associated with possible coefficient estimates for the regression of <code>balance</code> onto <code>limit</code> and <code>rating</code>, which we know to highly collinear.
Now the contours run along a narrow valley; there is a broad range of values for the coefficient estimates that result in equal values for RSS.
Hence a small change in the data could cause the pair of coefficient values that yield the smallest RSS—that is, the least squares estimates—to move anywhere along this valley.
This results in a great deal of uncertainty in the coefficient estimates.
Notice that the scale for the <code>limit</code> coefficient now runs from roughly <span class="math inline">\(-0.2\)</span> to <span class="math inline">\(0.2\)</span>; this is an eight-fold increase over the plausible range of the <code>limit</code> coefficient in the regression with <code>age</code>.
Interestingly, even though the <code>limit</code> and <code>rating</code> coefficients now have much more individual uncertainty, they will almost certainly lie somewhere in this contour valley.
For example, we would not expect the true value of the <code>limit</code> and <code>rating</code> coefficients to be <span class="math inline">\(-0.1\)</span> and <span class="math inline">\(1\)</span> respectively, even though such a value is plausible for each coefficient individually.</p>
<p>TABLE 3.11</p>
<p>Since collinearity reduces the accuracy of the estimates of the regression coefficients, it causes the standard error for <span class="math inline">\(\hat{\beta_j}\)</span> to grow.
Recall that the <em>t-statistic</em> for each predictor is calculated by dividing <span class="math inline">\(\hat{\beta_j}\)</span> by its standard error.
Consequently, collinearity results in a decline in the <em>t</em>-statistic.
As a result, in the presence of collinearity, we may fail to reject <span class="math inline">\(H_0 : \beta_j = 0\)</span>.
This means that the <strong><span style="font-family:monospace; color: #1188ce;">power</span></strong> of the hypothesis test—the probability of correctly detecting a <em>non-zero</em> coefficient—is reduced by collinearity.
Table 3.11 compares the coefficient estimates obtained from the two separate multiple regression models.
The first is a regression of <code>balance</code> on <code>age</code> and <code>limit</code> and the second is a regression of <code>balance</code> on <code>rating</code> and <code>limit</code>.
In the first regression both <code>age</code> and <code>limit</code> are highly significant with very small p-values.
In the second, the collinearity between <code>limit</code> and <code>rating</code> has caused the standard error for the <code>limit</code> coefficient estimate to increase by a factor of 12 and the p-value to increase to <span class="math inline">\(0.701\)</span>.
In other words, the importance of the <code>limit</code> variable has been masked due to the presence of collinearity.
To avoid such a situation, it is desirable to identify and address potential collinearity problems while fitting the model.</p>
<p>A simple way to detect collinearity is to look at a correlation matrix of the predictors.
An element of this matrix that is large in absolute value indicates a pair of highly correlated variables, and therefore a collinearity problem in the data.
Unfortunately, not all collinearity problems can be detected by inspection of the correlation matrix: it is possible for collinearity to exist between three or more variables even if no pair of variables has a particularly high correlation.
We call this situation <strong><span style="font-family:monospace; color: #1188ce;">multicollinearity</span></strong>.
Instead of inspecting the correlation matrix, a better way to assess multicollinearity is to compute the <strong><span style="font-family:monospace; color: #1188ce;">variance inflation factor</span></strong> (VIF).
The VIF is the ratio of the variance of <span class="math inline">\(\hat{\beta_j}\)</span> when fitting the full model divided by the variance of <span class="math inline">\(\hat{\beta_j}\)</span> if fit on its own.
The smallest possible value for the VIF is 1, which indicates the complete absence of collinearity.
Typically in practice there is a small amount of collinearity among the predictors.
As a rule of thumb, a VIF value that exceeds 5 or 10 indicates a problematic amount of collinearity.
The VIF for each variable can be computed using the formula</p>
<p><span class="math display">\[
VIF(\hat{\beta_j}) = \frac{1}{1 - R_{X_j|X_{-j}}^2} .
\]</span>
where <span class="math inline">\(R_{X_j|X_{-j}}^2\)</span> is the <span class="math inline">\(R^2\)</span> from a regression of <span class="math inline">\(X_j\)</span> onto all of the other predictors.
If <span class="math inline">\(R_{X_j|X_{-j}}^2\)</span> is close to one, then collinearity is present, and so the VIF will be large.</p>
<p>In the <code>Credit</code> data, a regression of <code>balance</code> on <code>age</code>, <code>rating</code>, and <code>limit</code> indicates that the predictors have VIF values of <span class="math inline">\(1.01\)</span>, <span class="math inline">\(160.67\)</span>, and <span class="math inline">\(160.59\)</span>.
As we suspected, there is considerable collinearity in the data!</p>
<p>When faced with the problem of collinearity, there are two simple solutions.
The first is to drop one of the problematic variables from the regression.
This can usually be done without much compromise to the regression fit, since the presence of collinearity implies that the information that this variable provides about the response is redundant in the presence of other variables.
For instance, if we regress <code>balance</code> onto <code>age</code> and <code>limit</code>, without the <code>rating</code> predictor, then the resulting VIF values are close to the minimum possible value of 1, and the <span class="math inline">\(R^2\)</span> drops from <span class="math inline">\(0.754\)</span> to <span class="math inline">\(0.75\)</span>.
So dropping <code>rating</code> from the set of predictors has effectively solved the collinearity problem without compromising the fit.
The second solution is to combine the collinear variables together into a single predictor.
For instance, we might take the average of the standardized versions of <code>limit</code> and <code>rating</code> in order to create a new variable that measures <em>credit worthiness</em>.</p>
</div>
</div>
</div>
<div id="the-marketing-plan" class="section level2">
<h2><span class="header-section-number">2.4</span> The Marketing Plan</h2>
<p>We now briefly return to the seven questions about the <code>Advertising</code> data that we set out to answer at the beginning of this chapter.</p>
<p><callout>Click each question to see the answer, but it might be worth thinking about yourself before checking!</callout></p>
<details>
<summary>1. <em>Is there a relationship between advertising sales and budget?</em></summary><br />

<div class="summary-content">
<p>This question can be answered by fitting a multiple regression model of <code>sales</code> onto <code>TV</code>, <code>radio</code>, and <code>newspaper</code>, as in <a href="linreg.html#eq:mlin-reg-adv">(2.20)</a>, and testing the hypothesis <span class="math inline">\(H_0 : \beta_{\color{#B44C1C}{TV}} = \beta_{\color{#B44C1C}{radio}} = \beta_{\color{#B44C1C}{newspaper}} = 0\)</span>.
In Section 3.2.2, we showed that the F-statistic can be used to determine whether or not we should reject this null hypothesis.
In this case the p-value corresponding to the F-statistic in Table 3.6 is very low, indicating clear evidence of a relationship between advertising and sales.</p>
</div>
</details>
<details>
<summary>2. <em>How strong is the relationship?</em></summary><br />

<div class="summary-content">
<p>We discussed two measures of model accuracy in Section 3.1.3.
First the RSE estimates the standard deviation of the response from the population regression line.
For the <code>Advertising</code> data, the RSE is <span class="math inline">\(1,681\)</span> units while the mean value for the response is <span class="math inline">\(14,022\)</span>, indicating a percentage error of roughly <span class="math inline">\(12\%\)</span>.
Second, the <span class="math inline">\(R^2\)</span> statistic records the percentage of variability in the response that is explained by the predictors.
The predictors explain almost <span class="math inline">\(90\%\)</span> of the variance in <code>sales</code>.
The RSE and <span class="math inline">\(R^2\)</span> statistics are displayed in Table 3.6.</p>
</div>
</details>
<details>
<summary>3. <em>Which media contribute to sales?</em></summary><br />

<div class="summary-content">
<p>To answer this question, we can examine the p-values associated with each predictor’s t-statistic (Section 3.1.2).
In the multiple linear regression displayed in Table 3.4, the p-values for <code>TV</code> and <code>radio</code> are low, but the p-value for <code>newspaper</code> is not.
This suggests that only <code>TV</code> and <code>radio</code> are related to <code>sales</code>.
But the interval for <code>newspaper</code> includes zero, indicating that the variable is not statistically significant given the values of <code>TV</code> and <code>radio</code>.</p>
</div>
</details>
<details>
<summary>4. <em>How large is the effect of each medium on sales?</em></summary><br />

<div class="summary-content">
<p>We saw in Section 3.1.2 that the standard error of <span class="math inline">\(\hat{\beta_j}\)</span> can be used to construct confidence intervals for <span class="math inline">\(\beta_j\)</span>.
For the <code>Advertising</code> data, the <span class="math inline">\(95\%\)</span> confidence intervals are as follows: <span class="math inline">\((0.043, 0.049)\)</span> for <code>TV</code>, <span class="math inline">\((0.172, 0.206)\)</span> for <code>radio</code>, and <span class="math inline">\((-0.013, 0.011)\)</span> for <code>newspaper</code>.
The confidence intervals for <code>TV</code> and <code>radio</code> are narrow and far from zero, providing evidnece that these media are related to <code>sales</code>.
But the interval for <code>newspaper</code> includes zero, indicating that the variable is not statistically significant given the values of <code>TV</code> and <code>radio</code>.<br />
We saw in Section 3.3.3 that collinearity can result in very wide standard errors.
Could collinearity be the reason that the confidence intervals associated with <code>newspaper</code> is so wide?
The VIF scores are <span class="math inline">\(1.005\)</span>, <span class="math inline">\(1.145\)</span>, and <span class="math inline">\(1.145\)</span> for <code>TV</code>, <code>radio</code>, and <code>newspaper</code>, suggesting no evidence of collinearity.<br />
In order to assess the association of each medium individually on sales, we can perform three separate simple linear regressions.
Results are shown in Tables 3.1 and 3.3.
There is evidence of an extremely strong association between <code>TV</code> and <code>sales</code> and between <code>radio</code> and <code>sales</code>.
There is evidence of a mild association between <code>newspaper</code> and <code>sales</code>, when the values of <code>TV</code> and <code>radio</code> are ignored.</p>
</div>
</details>
<details>
<summary>5. <em>How accurately can we predict future sales?</em></summary><br />

<div class="summary-content">
<p>The response can be predicted using <a href="linreg.html#eq:mlin-reg-est">(2.21)</a>.
The accuracy associated with this estimate depends on whether we wish to predict an individual response, <span class="math inline">\(Y = f(X) + \epsilon\)</span>, or the average response, <span class="math inline">\(f(X)\)</span> (Section 3.2.2).
If the former, we use a prediction interval, and if the latter, we use a confidence interval.
Prediction intervals will always be wider than confidence intervals because they account for the uncertainty associated with <span class="math inline">\(\epsilon\)</span>, the irreducible error.</p>
</div>
</details>
<details>
<summary>6. <em>Is the relationship linear?</em></summary><br />

<div class="summary-content">
<p>In Section 3.3.3, we saw that residual plots can be used in order to identify non-linearity.
If the relationships are linear, then the residual plots should display no pattern.
In the case of the <code>Advertising</code> data, we observe a non-linear effect in Figure 3.5, though this effect could also be observed in a residual plot.
In Section 3.3.2, we discussed the inclusion of transformations of the predictors in the linear regression model in order to accommodate non-linear relationships.</p>
</div>
</details>
<details>
<summary>7. <em>Is there synergy among the advertising media?</em></summary><br />

<div class="summary-content">
<p>The standard linear regression model assumes an additive relationship between predictors.
However, the additive assumption may be unrealistic for certain data sets.
In Section 3.3.2, we showed how to include an interaction term in the regression model in order to accommodate non-additive relationships.
A small p-value associated with the interaction term indicates the presence of such relationships.
Figure 3.5 suggested that the <code>Advertising</code> data may not be additive.
Including an interaction term in the model results in a substantial increase in <span class="math inline">\(R^2\)</span>, from around <span class="math inline">\(90\%\)</span> to almost <span class="math inline">\(97\%\)</span>.</p>
</div>
</details>
</div>
<div id="comparison-of-linear-regression-with-k-nearest-neighbors" class="section level2">
<h2><span class="header-section-number">2.5</span> Comparison of Linear Regression with K-Nearest Neighbors</h2>
<p>As discussed in Chapter 2, linear regression is an example of a <em>parametric</em> approach because it assumes a linear functional form for <span class="math inline">\(f(X)\)</span>.
Parametric methods have several advantages.
They are often easy to fit, because one need estimate only a small number of coefficients.
In the case of linear regression, the coefficients have simple interpretations, and tests of statistical significance can be easily performed.
But parametric methods do have a disadvantage: by construction, they make strong assumptions about the form of <span class="math inline">\(f(X)\)</span>.
If the specified functional form is far from the truth, and prediction accuracy is our goal, then the parametric method will perform poorly.
For instance, if we assume a linear relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> but the true relationship is far from linear, then the resulting model will provide a poor fit to the data, and any conclusions drawn from it will be suspect.</p>
<p>In contrast, <em>non-parametric</em> methods do not explicitly assume a parametric form for <span class="math inline">\(f(X)\)</span>, and thereby provide an alternative and more flexible approach for performing regression.
We discuss various non-parametric methods in this book.
Here we consider one of the simplest and best-known non-parametric methods, <strong><span style="font-family:monospace; color: #1188ce;">K-nearest neighbors regression</span></strong> (KNN regression).</p>
<p>FIGURE 3.16</p>
<p>The KNN regression method is closely related to the KNN classifier discussed in Chapter 2.
Given a value for <span class="math inline">\(K\)</span> and a prediction point <span class="math inline">\(x_0\)</span>, KNN regression first identifies the <span class="math inline">\(K\)</span> training observations that are closest to <span class="math inline">\(x_0\)</span>, represented by <span class="math inline">\(N_0\)</span>.
It then estimates <span class="math inline">\(f(x_0)\)</span> using the average of all the training responses in <span class="math inline">\(N_0\)</span>.
In other words,</p>
<p><span class="math display">\[
\hat{f}(x_0) = \frac{1}{K} \sum_{x_i\in N_0} y_i.
\]</span>
Figure 3.16 illustrates two KNN fits on a data set with <span class="math inline">\(p = 2\)</span> predictors.
The fit with <span class="math inline">\(K = 1\)</span> is shown in the left-hand panel, while the right-hand panel corresponds to <span class="math inline">\(K=9\)</span>.
We see that when <span class="math inline">\(K=1\)</span>, the KNN fit perfectly interpolates the training observations, and consequently takes the form of a step function.
When <span class="math inline">\(K=9\)</span>, the KNN fit still is a step function, but averaging over nine observations results in much smaller regions of constant prediction, and consequently a smoother fit.
In general, the optimal value for <span class="math inline">\(K\)</span> will depend on the <em>bias-variance tradeoff</em>, which we introduced in Chapter 2.
A small value for <span class="math inline">\(K\)</span> provides the most flexible fit, which will have low bias but high variance.
This variance is due to the fact that the prediction in a given region is entirely dependent on just one observation.
In contrast, larger values of <span class="math inline">\(K\)</span> provide a smoother and less variable fit; the prediction in a region is an average of several points, and so changing one observation has a smaller effect.
However, the smoothing may cause bias by masking some of the structure of <span class="math inline">\(f(X)\)</span>.
In Chapter 5, we introduce several approaches for estimating test error rates.
These methods can be used to identify the optimal value of <span class="math inline">\(K\)</span> in KNN regression.</p>
<p>In what setting will a parametric approach such as least squares linear regression outperform a non-parametric approach such as KNN regression?
The answer is simple: <em>the parametric approach will outperform the non-parametric approach if the parametric form that has been selected is close to the true form of <span class="math inline">\(f\)</span></em>.
Figure 3.17 provides an example with data generated from a one-dimensional linear regression model.
The black solid lines represent <span class="math inline">\(f(X)\)</span>, while the blue curves correspond to the KNN fits using <span class="math inline">\(K=1\)</span> and <span class="math inline">\(K=9\)</span>.
In this case the <span class="math inline">\(K=1\)</span> predictions are far too variable, while the smoother <span class="math inline">\(K=9\)</span> fit is much closer to <span class="math inline">\(f(X)\)</span>.
However, since the true relationship is linear, it is hard for a non-parametric approach to compete with linear regression: a non-parametric approach incurs a cost in variance that is not offset by a reduction in bias.
The blue dashed line in the left-hand panel of Figure 3.18 represents the linear regression fit to the same data.
It is almost perfect.
The right-hand panel of Figure 3.18 revealsthat linear regression outperforms KNN for this data.
The green solid line, plotted as a function of <span class="math inline">\(1/K\)</span>, represents the test set mean squared error (MSE) for KNN.
The KNN errrors are well above the black dashed line, which is the test MSE for linear regression.
When the value of <span class="math inline">\(K\)</span> is large, then KNN performs only a little worse than least squares regression in terms of MSE.
It performs far worse when <span class="math inline">\(K\)</span> is small.</p>
<p>FIGURE 3.17</p>
<p>FIGURE 3.18</p>
<p>In practice, the true relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> is rarely exactly linear.
Figure 3.19 examines the relative performances of least squares regression and KNN u der increasing levels of non-linearity in the relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>.
In the top row, the true relationship is nearly linear.
In this csae we see that the test MSE for linear regression is still superior to that of KNN for low values of <span class="math inline">\(K\)</span>.
However, for <span class="math inline">\(K\ge4\)</span>, KNN outperforms linear regression.
The second row illustrates a more substantial deviation from linearity.
In this situation, KNN substantially outperforms linear regression for all values of <span class="math inline">\(K\)</span>.
Note that as the extent of non-linearity increases, there is little change in the test set MSE for the non-parametric KNN method, but there is a large increase in the test set MSE of linear regression.</p>
<p>Figure 3.18 and 3.19 display situations in which KNN performs slightly worse than linear regression when the relationship is linear, but much better than linear regression for non-linear situations.
In a real life situation in which the true relationship is unknown, one might draw the conclusion that KNN should be favored over linear regression because it will at worst be slightly inferior than linear regression if the true relationship is linear, and may give substantially better results if the true relationship is non-linear.
But in reality, even when the true relationship is highly non-linear, KNN may still provide inferior results to linear regression.
In particular, both Figures 3.18 and 3.19 illustrate settings with <span class="math inline">\(p=1\)</span> predictor.
But in higher dimensions, KNN often performs worse than linear regression.</p>
<p>FIGURE 3.19</p>
<p>Figure 3.20 considers the same strongly non-linear situation as in the second row of 3.19, except that we have added additional <em>noise</em> predictors that are not associated with the response.
When <span class="math inline">\(p=1\)</span> or <span class="math inline">\(p=2\)</span>, KNN outperforms linear regression.
But for <span class="math inline">\(p=3\)</span> the results are mixed, and for <span class="math inline">\(p\ge4\)</span> linear regression is superior to KNN.
In fact, the increase in dimension has only caused a small deterioration in the linear regression test set MSE, but it has caused more than a ten-fold increase in the MSE for KNN.
This decrease in performance as the dimension increases is a common problem for KNN, and results from the fact that in higher dimensions there is effectively a reduction in sample size.
In this data set there are 100 training observations; when <span class="math inline">\(p=1\)</span>, this provides enough information to accurately estimate <span class="math inline">\(f(X)\)</span>.
However, spreading 100 observations over <span class="math inline">\(p=20\)</span> dimensions results in a phenomenon in which a given observation has no <em>nearby neighbors</em>—this is the so-called <strong><span style="font-family:monospace; color: #1188ce;">curse of dimensionality</span></strong>.
That is, the <span class="math inline">\(K\)</span> observations that are nearest to a given test observation <span class="math inline">\(x_0\)</span> may be very far away from <span class="math inline">\(x_0\)</span> in <em>p</em>-dimensional space when <em>p</em> is large, leading to a very poor prediction of <span class="math inline">\(f(x_0)\)</span> and hence a poor KNN fit.
As a general rule, parametric methods will tend to outerform non-parametric approaches when there is a small number of observations per predictor.</p>
<p>Even in problems in which the dimensions is small, we might prefer linear regression to KNN from an interpretability standpoint.
If the test MSE of KNN is only slightly lower than that of linear regression, we might be willing to forego a little bit of prediction accuracy for the sake of a ssimple model that can be described in terms of just a few coefficients, and for which p-valiues are available.</p>
</div>
<div id="lab-linear-regression" class="section level2">
<h2><span class="header-section-number">2.6</span> Lab: Linear Regression</h2>
<div id="libraries" class="section level3">
<h3><span class="header-section-number">2.6.1</span> Libraries</h3>
<p>The <code>library()</code> function is used to load libraries, or groups of functions and data sets that are not included in the base <code>R</code> distribution.
Basic functions that perform least squares linear regression and other simple analyses come standard with the base distribution, but more exotic functions require additional libraries.
Here we load the <code>MASS</code> package, which is a very large collection of data sets and functions.
We also load the <code>ISLR</code> package, which includes the data sets associated with this book.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="linreg.html#cb12-1"></a><span class="kw">library</span>(MASS)</span>
<span id="cb12-2"><a href="linreg.html#cb12-2"></a><span class="kw">library</span>(ISLR)</span></code></pre></div>
<p>If you receive an error message when loading any of these libraries, it likely indicates that the corresponding library has not yet been installed on your system.
Some libraries, such as <code>MASS</code>, come with <code>R</code> and do not need to be separately installed on your computer.
However, other packages, such as <code>ISLR</code>, must be downloaded the ﬁrst time they are used. This can be done directly from within <code>R</code>.
For example, on a Windows system, select the <code>Install package</code> option under the <code>Packages</code> tab.
After you select any mirror site, a list of available packages will appear.
Simply select the package you wish to install and <code>R</code> will automatically download the package.
Alternatively, this can be done at the <code>R</code> command line via <code>install.packages("ISLR")</code>.
This installation only needs to be done the first time you use a package.
However, the <code>library()</code> function must be called each time you wish to use a given package.</p>
</div>
<div id="simple-linear-regression" class="section level3">
<h3><span class="header-section-number">2.6.2</span> Simple Linear Regression</h3>
<p>The <code>MASS</code> library contains the <code>Boston</code> data set, which records <code>medv</code> (median house value) for 506 neighborhoods around Boston.
We will seek to predict <code>medv</code> using 13 predictors such as <code>rm</code> (average number of rooms per house), <code>age</code> (average age of houses), and <code>lstat</code> (percent of households with low socioeconomic status).</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="linreg.html#cb13-1"></a><span class="kw">fix</span>(Boston)</span>
<span id="cb13-2"><a href="linreg.html#cb13-2"></a><span class="kw">names</span>(Boston)</span></code></pre></div>
<pre><code>##  [1] &quot;crim&quot;    &quot;zn&quot;      &quot;indus&quot;   &quot;chas&quot;    &quot;nox&quot;     &quot;rm&quot;      &quot;age&quot;    
##  [8] &quot;dis&quot;     &quot;rad&quot;     &quot;tax&quot;     &quot;ptratio&quot; &quot;black&quot;   &quot;lstat&quot;   &quot;medv&quot;</code></pre>
<p>To find out more about the data set, we can type <code>?Boston</code>.</p>
<p>We will start by using the <code>lm()</code> function to ﬁt a simple linear regression model, with <code>medv</code> as the response and <code>lstat</code> as the predictor.
The basic syntax is <code>lm(y∼x,data)</code>, where <code>y</code> is the response, <code>x</code> is the predictor, and data is the data set in which these two variables are kept.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="linreg.html#cb15-1"></a>lm.fit =<span class="st"> </span><span class="kw">lm</span>(medv<span class="op">~</span>lstat)</span></code></pre></div>
<pre><code>## Error in eval(predvars, data, env): object &#39;medv&#39; not found</code></pre>
<p>The command causes an error because <code>R</code> does not know where to find the variables <code>medv</code> and <code>lstat.</code> The next line tells <code>R</code> that the variables are
in <code>Boston.</code> If we attach <code>Boston</code>, the first line works fine because <code>R</code> now recognizes the variables.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="linreg.html#cb17-1"></a>lm.fit =<span class="st"> </span><span class="kw">lm</span>(medv<span class="op">~</span>lstat, <span class="dt">data=</span>Boston)</span>
<span id="cb17-2"><a href="linreg.html#cb17-2"></a><span class="kw">attach</span>(Boston)</span>
<span id="cb17-3"><a href="linreg.html#cb17-3"></a>lm.fit =<span class="st"> </span><span class="kw">lm</span>(medv<span class="op">~</span>lstat)</span></code></pre></div>
<p>If we type <code>lm.fit</code>, some basic information about the model is output.
For more detailed information, we use <code>summary(lm.fit)</code>.
This gives us p-values and standard errors for the coefficients, as well as the <span class="math inline">\(R^2\)</span> statistic and F-statistic for the model.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="linreg.html#cb18-1"></a>lm.fit</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = medv ~ lstat)
## 
## Coefficients:
## (Intercept)        lstat  
##       34.55        -0.95</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="linreg.html#cb20-1"></a><span class="kw">summary</span>(lm.fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = medv ~ lstat)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -15.17  -3.99  -1.32   2.03  24.50 
## 
## Coefficients:
##             Estimate Std. Error t value            Pr(&gt;|t|)    
## (Intercept)  34.5538     0.5626    61.4 &lt;0.0000000000000002 ***
## lstat        -0.9500     0.0387   -24.5 &lt;0.0000000000000002 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6.22 on 504 degrees of freedom
## Multiple R-squared:  0.544,  Adjusted R-squared:  0.543 
## F-statistic:  602 on 1 and 504 DF,  p-value: &lt;0.0000000000000002</code></pre>
<p>We can use the <code>names()</code> function in order to find out what other pieces of information are stored in <code>lm.fit</code>.
Although we can extract these quantities by name—e.g. <code>lm.fit$coefficients</code>—it is safer to use the extractor functions like <code>coef()</code> to access them.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="linreg.html#cb22-1"></a><span class="kw">names</span>(lm.fit)</span></code></pre></div>
<pre><code>##  [1] &quot;coefficients&quot;  &quot;residuals&quot;     &quot;effects&quot;       &quot;rank&quot;         
##  [5] &quot;fitted.values&quot; &quot;assign&quot;        &quot;qr&quot;            &quot;df.residual&quot;  
##  [9] &quot;xlevels&quot;       &quot;call&quot;          &quot;terms&quot;         &quot;model&quot;</code></pre>
<p>In order to obtain a confidence interval for the coefficient estimates, we can use the <code>confint()</code> command.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="linreg.html#cb24-1"></a><span class="kw">confint</span>(lm.fit)</span></code></pre></div>
<pre><code>##             2.5 % 97.5 %
## (Intercept) 33.45 35.659
## lstat       -1.03 -0.874</code></pre>
<p>The <code>predict()</code> function can be used to produce confidence intervals and prediction intervals for the prediction of <code>medv</code> for a given value of <code>lstat</code>.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="linreg.html#cb26-1"></a><span class="kw">predict</span>(lm.fit, </span>
<span id="cb26-2"><a href="linreg.html#cb26-2"></a>        <span class="kw">data.frame</span>(<span class="dt">lstat =</span> <span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">15</span>)),</span>
<span id="cb26-3"><a href="linreg.html#cb26-3"></a>        <span class="dt">interval=</span><span class="st">&quot;prediction&quot;</span>)</span></code></pre></div>
<pre><code>##    fit   lwr  upr
## 1 29.8 17.57 42.0
## 2 25.1 12.83 37.3
## 3 20.3  8.08 32.5</code></pre>
<p>For instance, the <span class="math inline">\(95\%\)</span> confidence interval associated with a <code>lstat</code> value of 10 is <span class="math inline">\((24.47, 25.63)\)</span>, and the <span class="math inline">\(95\%\)</span> prediction interval is <span class="math inline">\((12.828, 37.28)\)</span>.
As expected, the confidence and prediction intervals are centered around the same point (a predicted value of <span class="math inline">\(25.05\)</span> for <code>medv</code> when <code>lstat</code> equals 10), but the latter are substantially wider.</p>
<p>We will now plot <code>medv</code> and <code>lstat</code> along with the least squares regression line using the <code>plot()</code> and <code>abline()</code> functions.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="linreg.html#cb28-1"></a><span class="kw">plot</span>(lstat, medv)</span>
<span id="cb28-2"><a href="linreg.html#cb28-2"></a><span class="kw">abline</span>(lm.fit)</span></code></pre></div>
<p><img src="03-linear-regression_files/figure-html/lab-slr9-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>There is some evidence for non-linearity in the relationship between <code>lstat</code> and <code>medv</code>.
We will explore this issue later in this lab.
The <code>abline()</code> function can be used to draw any line, not just the least squares regression line.
To draw a line with intercept <code>a</code> and slope <code>b</code>, we type <code>abline(a,b)</code>.
Below we experiment with some additional settings for plotting lines and points.
The <code>lwd=3</code> command causes the width of the regression line to be increased by a factor of 3; this works for the <code>plot()</code> and <code>lines()</code> functions also.
We can also use the <code>pch</code> option to create different
plotting symbols.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="linreg.html#cb29-1"></a><span class="kw">abline</span>(lm.fit, <span class="dt">lwd=</span><span class="dv">3</span>)</span>
<span id="cb29-2"><a href="linreg.html#cb29-2"></a><span class="kw">abline</span>(lm.fit, <span class="dt">lwd=</span><span class="dv">3</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb29-3"><a href="linreg.html#cb29-3"></a><span class="kw">plot</span>(lstat, medv, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb29-4"><a href="linreg.html#cb29-4"></a><span class="kw">plot</span>(lstat, medv, <span class="dt">pch =</span> <span class="dv">20</span>)</span>
<span id="cb29-5"><a href="linreg.html#cb29-5"></a><span class="kw">plot</span>(lstat, medv, <span class="dt">pch =</span> <span class="st">&quot;+&quot;</span>)</span>
<span id="cb29-6"><a href="linreg.html#cb29-6"></a><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">20</span>, <span class="dt">pch =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">20</span>)</span></code></pre></div>
<p>Next we examine some diagnostic plots, several of which were discussed in Section 3.3.3.
Four diagnostic plots are automatically produced by applying the <code>plot()</code> function directly to the output from <code>lm()</code>.
In general, this command will produce one plot at a time, and hitting Enter will generate the next plot.
However, it is often convenient to view all four plots together.
We can achieve this by using the <code>par()</code> function, which tells R to split the display screen into separate panels so that multiple plots can be viewed simultaneously.
For example, <code>par(mfrow=c(2,2))</code> divides the plotting region into a 2 × 2 grid of panels.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="linreg.html#cb30-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb30-2"><a href="linreg.html#cb30-2"></a><span class="kw">plot</span>(lm.fit)</span></code></pre></div>
<p><img src="03-linear-regression_files/figure-html/lab-slr11-1.png" width="672" style="display: block; margin: auto;" />
Alternatively, we can compute the residuals from a linear regression fit using the <code>residuals()</code> function.
The function <code>rstudent()</code> will return the studentized residuals, and we can use this function to plot the residuals against the fitted values.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="linreg.html#cb31-1"></a><span class="kw">plot</span>(<span class="kw">predict</span>(lm.fit), <span class="kw">residuals</span>(lm.fit))</span></code></pre></div>
<p><img src="03-linear-regression_files/figure-html/lab-slr12-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="linreg.html#cb32-1"></a><span class="kw">plot</span>(<span class="kw">predict</span>(lm.fit), <span class="kw">rstudent</span>(lm.fit))</span></code></pre></div>
<p><img src="03-linear-regression_files/figure-html/lab-slr12-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>On the basis of the residual plots, there is some evidence of non-linearity.
Leverage statistics can be computed for any number of predictors using the <code>hatvalues()</code> function.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="linreg.html#cb33-1"></a><span class="kw">plot</span>(<span class="kw">hatvalues</span>(lm.fit))</span></code></pre></div>
<p><img src="03-linear-regression_files/figure-html/lab-slr13-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="linreg.html#cb34-1"></a><span class="kw">which.max</span>(<span class="kw">hatvalues</span>(lm.fit))</span></code></pre></div>
<pre><code>## 375 
## 375</code></pre>
<p>The <code>which.max()</code> function identiﬁes the index of the largest element of a vector.
In this case, it tells us which observation has the largest leverage statistic.</p>
</div>
<div id="multiple-linear-regression" class="section level3">
<h3><span class="header-section-number">2.6.3</span> Multiple Linear Regression</h3>
<p>In order to fit a multiple linear regression model using least squares, we again use the <code>lm()</code> function.
The syntax <code>lm(y∼x1+x2+x3)</code> is used to fit a model with three predictors, <code>x1</code>, <code>x2</code>, and <code>x3</code>.
The <code>summary()</code> function now outputs the regression coefficients for all the predictors.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="linreg.html#cb36-1"></a>lm.fit =<span class="st"> </span><span class="kw">lm</span>(medv<span class="op">~</span>lstat<span class="op">+</span>age, <span class="dt">data =</span> Boston)</span>
<span id="cb36-2"><a href="linreg.html#cb36-2"></a><span class="kw">summary</span>(lm.fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = medv ~ lstat + age, data = Boston)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -15.98  -3.98  -1.28   1.97  23.16 
## 
## Coefficients:
##             Estimate Std. Error t value            Pr(&gt;|t|)    
## (Intercept)  33.2228     0.7308   45.46 &lt;0.0000000000000002 ***
## lstat        -1.0321     0.0482  -21.42 &lt;0.0000000000000002 ***
## age           0.0345     0.0122    2.83              0.0049 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6.17 on 503 degrees of freedom
## Multiple R-squared:  0.551,  Adjusted R-squared:  0.549 
## F-statistic:  309 on 2 and 503 DF,  p-value: &lt;0.0000000000000002</code></pre>
<p>The Boston data set contains 13 variables, and so it would be cumbersome to have to type all of these in order to perform a regression using all of the predictors.
Instead, we can use the following short-hand:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="linreg.html#cb38-1"></a>lm.fit =<span class="st"> </span><span class="kw">lm</span>(medv<span class="op">~</span>., <span class="dt">data =</span> Boston)</span>
<span id="cb38-2"><a href="linreg.html#cb38-2"></a><span class="kw">summary</span>(lm.fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = medv ~ ., data = Boston)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -15.594  -2.730  -0.518   1.777  26.199 
## 
## Coefficients:
##               Estimate Std. Error t value             Pr(&gt;|t|)    
## (Intercept)  36.459488   5.103459    7.14      0.0000000000033 ***
## crim         -0.108011   0.032865   -3.29              0.00109 ** 
## zn            0.046420   0.013727    3.38              0.00078 ***
## indus         0.020559   0.061496    0.33              0.73829    
## chas          2.686734   0.861580    3.12              0.00193 ** 
## nox         -17.766611   3.819744   -4.65      0.0000042456438 ***
## rm            3.809865   0.417925    9.12 &lt; 0.0000000000000002 ***
## age           0.000692   0.013210    0.05              0.95823    
## dis          -1.475567   0.199455   -7.40      0.0000000000006 ***
## rad           0.306049   0.066346    4.61      0.0000050705290 ***
## tax          -0.012335   0.003761   -3.28              0.00111 ** 
## ptratio      -0.952747   0.130827   -7.28      0.0000000000013 ***
## black         0.009312   0.002686    3.47              0.00057 ***
## lstat        -0.524758   0.050715  -10.35 &lt; 0.0000000000000002 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.75 on 492 degrees of freedom
## Multiple R-squared:  0.741,  Adjusted R-squared:  0.734 
## F-statistic:  108 on 13 and 492 DF,  p-value: &lt;0.0000000000000002</code></pre>
<p>We can access the individual components of a summary object by name (type <code>?summary.lm</code> to see what is available).
Hence <code>summary(lm.fit)$r.sq</code> gives us the <span class="math inline">\(R^2\)</span>, and <code>summary(lm.fit)$sigma</code> gives us the RSE.
The <code>vif()</code> function, part of the car package, can be used to compute variance inflation factors.
Most VIF’s are low to moderate for this data.
The car package is not part of the base <code>R</code> installation so it must be downloaded the first time
you use it via the <code>install.packages</code> option in <code>R</code>.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="linreg.html#cb40-1"></a><span class="kw">library</span>(car)</span>
<span id="cb40-2"><a href="linreg.html#cb40-2"></a><span class="kw">vif</span>(lm.fit)</span></code></pre></div>
<pre><code>##    crim      zn   indus    chas     nox      rm     age     dis     rad     tax 
##    1.79    2.30    3.99    1.07    4.39    1.93    3.10    3.96    7.48    9.01 
## ptratio   black   lstat 
##    1.80    1.35    2.94</code></pre>
<p>What if we would like to perform a regression using all of the variables but one?
For example, in the above regression output, <code>age</code> has a high p-value.
So we may wish to run a regression excluding this predictor.
The following syntax results in a regression using all predictors except <code>age</code>.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="linreg.html#cb42-1"></a>lm.fit1 =<span class="st"> </span><span class="kw">lm</span>(medv<span class="op">~</span>.<span class="op">-</span>age, <span class="dt">data =</span> Boston)</span>
<span id="cb42-2"><a href="linreg.html#cb42-2"></a><span class="kw">summary</span>(lm.fit1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = medv ~ . - age, data = Boston)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -15.605  -2.731  -0.519   1.760  26.224 
## 
## Coefficients:
##              Estimate Std. Error t value             Pr(&gt;|t|)    
## (Intercept)  36.43693    5.08012    7.17     0.00000000000272 ***
## crim         -0.10801    0.03283   -3.29              0.00107 ** 
## zn            0.04633    0.01361    3.40              0.00072 ***
## indus         0.02056    0.06143    0.33              0.73799    
## chas          2.68903    0.85960    3.13              0.00186 ** 
## nox         -17.71354    3.67931   -4.81     0.00000196711001 ***
## rm            3.81439    0.40848    9.34 &lt; 0.0000000000000002 ***
## dis          -1.47861    0.19061   -7.76     0.00000000000005 ***
## rad           0.30579    0.06609    4.63     0.00000475053897 ***
## tax          -0.01233    0.00376   -3.28              0.00110 ** 
## ptratio      -0.95221    0.13029   -7.31     0.00000000000110 ***
## black         0.00932    0.00268    3.48              0.00054 ***
## lstat        -0.52385    0.04763  -11.00 &lt; 0.0000000000000002 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.74 on 493 degrees of freedom
## Multiple R-squared:  0.741,  Adjusted R-squared:  0.734 
## F-statistic:  117 on 12 and 493 DF,  p-value: &lt;0.0000000000000002</code></pre>
<p>Alternatively, the <code>update()</code> function can be used.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="linreg.html#cb44-1"></a>lm.fit1 =<span class="st"> </span><span class="kw">update</span>(lm.fit, <span class="op">~</span>.<span class="op">-</span>age)</span></code></pre></div>
</div>
<div id="interaction-terms" class="section level3">
<h3><span class="header-section-number">2.6.4</span> Interaction Terms</h3>
<p>It is easy to include interaction terms in a linear model using the <code>lm()</code> function.
The syntax <code>lstat:black</code> tells <code>R</code> to include an interaction term between <code>lstat</code> and <code>black</code>.
The syntax <code>lstat*age</code> simultaneously includes <code>lstat</code>, <code>age</code>, and the interaction term <code>lstat</code><span class="math inline">\(\times\)</span><code>age</code> as predictors; it is a shorthand for <code>lstat+age+lstat:age</code>.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="linreg.html#cb45-1"></a><span class="kw">summary</span>(<span class="kw">lm</span>(medv<span class="op">~</span>lstat<span class="op">*</span>age, <span class="dt">data =</span> Boston))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = medv ~ lstat * age, data = Boston)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -15.81  -4.04  -1.33   2.08  27.55 
## 
## Coefficients:
##              Estimate Std. Error t value             Pr(&gt;|t|)    
## (Intercept) 36.088536   1.469835   24.55 &lt; 0.0000000000000002 ***
## lstat       -1.392117   0.167456   -8.31  0.00000000000000088 ***
## age         -0.000721   0.019879   -0.04                0.971    
## lstat:age    0.004156   0.001852    2.24                0.025 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6.15 on 502 degrees of freedom
## Multiple R-squared:  0.556,  Adjusted R-squared:  0.553 
## F-statistic:  209 on 3 and 502 DF,  p-value: &lt;0.0000000000000002</code></pre>
</div>
<div id="non-linear-transformations-of-the-predictors" class="section level3">
<h3><span class="header-section-number">2.6.5</span> Non-linear Transformations of the Predictors</h3>
<p>The <code>lm()</code> function can also accommodate non-linear transformations of the predictors.
For instance, given a predictor X, we can create a predictor <em><strong>X</strong></em> using <code>I(X^2)</code>.
The function <code>I()</code> is needed since the <code>^</code> has a special meaning in a formula; wrapping as we do allows the standard usage in <code>R</code>, which is to raise <code>X</code> to the power <code>2</code>.
We now perform a regression of <code>medv</code> onto <code>lstat</code> and <span class="math inline">\(\color{#B44C1C}{lstat^2}\)</span>.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="linreg.html#cb47-1"></a>lm.fit2 =<span class="st"> </span><span class="kw">lm</span>(medv<span class="op">~</span>lstat<span class="op">+</span><span class="kw">I</span>(lstat<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb47-2"><a href="linreg.html#cb47-2"></a><span class="kw">summary</span>(lm.fit2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = medv ~ lstat + I(lstat^2))
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -15.28  -3.83  -0.53   2.31  25.41 
## 
## Coefficients:
##             Estimate Std. Error t value            Pr(&gt;|t|)    
## (Intercept) 42.86201    0.87208    49.1 &lt;0.0000000000000002 ***
## lstat       -2.33282    0.12380   -18.8 &lt;0.0000000000000002 ***
## I(lstat^2)   0.04355    0.00375    11.6 &lt;0.0000000000000002 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.52 on 503 degrees of freedom
## Multiple R-squared:  0.641,  Adjusted R-squared:  0.639 
## F-statistic:  449 on 2 and 503 DF,  p-value: &lt;0.0000000000000002</code></pre>
<p>The near-zero p-value associated with the quadratic term suggests that it leads to an improved model.
We use the <code>anova()</code> function to further quantify the extent to which the quadratic fit is superior to the linear fit.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="linreg.html#cb49-1"></a>lm.fit =<span class="st"> </span><span class="kw">lm</span>(medv<span class="op">~</span>lstat)</span>
<span id="cb49-2"><a href="linreg.html#cb49-2"></a><span class="kw">anova</span>(lm.fit, lm.fit2)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: medv ~ lstat
## Model 2: medv ~ lstat + I(lstat^2)
##   Res.Df   RSS Df Sum of Sq   F              Pr(&gt;F)    
## 1    504 19472                                         
## 2    503 15347  1      4125 135 &lt;0.0000000000000002 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Here Model 1 represents the linear submodel containing only one predictor, <code>lstat</code>, while Model 2 corresponds to the larger quadratic model that has two predictors, <code>lstat</code> and <span class="math inline">\(\color{#B44C1C}{lstat^2}\)</span>.
The <code>anova()</code> function performs a hypothesis test comparing the two models.
The null hypothesis is that the two models fit the data equally well, and the alternative hypothesis is that the full model is superior.
Here the F-statistic is 135 and the associated p-value is virtually zero.
This provides very clear evidence that the model containing the predictors <code>lstat</code> and <span class="math inline">\(\color{#B44C1C}{\textbf{lstat}^2}\)</span> is far superior to the model that only contains the predictor <code>lstat</code>.
This is not surprising, since earlier we saw evidence for non-linearity in the relationship between <code>medv</code> and <code>lstat</code>.
If we type</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="linreg.html#cb51-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb51-2"><a href="linreg.html#cb51-2"></a><span class="kw">plot</span>(lm.fit2)</span></code></pre></div>
<p><img src="03-linear-regression_files/figure-html/lab-nlt3-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>then we see that when the <span class="math inline">\(\color{#B44C1C}{lstat^2}\)</span> term is included in the model, there is little discernible pattern in the residuals.</p>
<p>In order to create a cubic fit, we can include a predictor of the form <code>I(X^3)</code>.
However, this approach can start to get cumbersome for higher order polynomials.
A better approach involves using the <code>poly()</code> function to create the polynomial within <code>lm()</code>. For example, the following command produces a fifth-order polynomial fit:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="linreg.html#cb52-1"></a>lm.fit5 =<span class="st"> </span><span class="kw">lm</span>(medv<span class="op">~</span><span class="kw">poly</span>(lstat,<span class="dv">5</span>))</span>
<span id="cb52-2"><a href="linreg.html#cb52-2"></a><span class="kw">summary</span>(lm.fit5)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = medv ~ poly(lstat, 5))
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -13.543  -3.104  -0.705   2.084  27.115 
## 
## Coefficients:
##                 Estimate Std. Error t value             Pr(&gt;|t|)    
## (Intercept)       22.533      0.232   97.20 &lt; 0.0000000000000002 ***
## poly(lstat, 5)1 -152.460      5.215  -29.24 &lt; 0.0000000000000002 ***
## poly(lstat, 5)2   64.227      5.215   12.32 &lt; 0.0000000000000002 ***
## poly(lstat, 5)3  -27.051      5.215   -5.19           0.00000031 ***
## poly(lstat, 5)4   25.452      5.215    4.88           0.00000142 ***
## poly(lstat, 5)5  -19.252      5.215   -3.69              0.00025 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.21 on 500 degrees of freedom
## Multiple R-squared:  0.682,  Adjusted R-squared:  0.679 
## F-statistic:  214 on 5 and 500 DF,  p-value: &lt;0.0000000000000002</code></pre>
<p>This suggests that including additional polynomial terms, up to fifth order, leads to an improvement in the model fit!
However, further investigation of the data reveals that no polynomial terms beyond fifth order have significant p-values in a regression fit.</p>
<p>Of course, we are in no way restricted to using polynomial transformations of the predictors.
Here we try a log transformation.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="linreg.html#cb54-1"></a><span class="kw">summary</span>(<span class="kw">lm</span>(medv<span class="op">~</span><span class="kw">log</span>(rm), <span class="dt">data =</span> Boston))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = medv ~ log(rm), data = Boston)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -19.49  -2.87  -0.10   2.84  39.82 
## 
## Coefficients:
##             Estimate Std. Error t value            Pr(&gt;|t|)    
## (Intercept)   -76.49       5.03   -15.2 &lt;0.0000000000000002 ***
## log(rm)        54.05       2.74    19.7 &lt;0.0000000000000002 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6.91 on 504 degrees of freedom
## Multiple R-squared:  0.436,  Adjusted R-squared:  0.435 
## F-statistic:  389 on 1 and 504 DF,  p-value: &lt;0.0000000000000002</code></pre>
</div>
<div id="qualitative-predictors-1" class="section level3">
<h3><span class="header-section-number">2.6.6</span> Qualitative Predictors</h3>
<p>We will now examine the <code>Carseats</code> data, which is part of the <code>ISLR</code> library.
We will attempt to predict <code>Sales</code> (child car seat sales) in 400 locations based on a number of predictors.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="linreg.html#cb56-1"></a><span class="kw">fix</span>(Carseats)</span>
<span id="cb56-2"><a href="linreg.html#cb56-2"></a><span class="kw">names</span>(Carseats)</span></code></pre></div>
<pre><code>##  [1] &quot;Sales&quot;       &quot;CompPrice&quot;   &quot;Income&quot;      &quot;Advertising&quot; &quot;Population&quot; 
##  [6] &quot;Price&quot;       &quot;ShelveLoc&quot;   &quot;Age&quot;         &quot;Education&quot;   &quot;Urban&quot;      
## [11] &quot;US&quot;</code></pre>
<p>The <code>Carseats</code> data includes qualitative predictors such as <code>Shelveloc</code>, an indicator of the quality of the shelving location—that is, the space within a store in which the car seat is displayed—at each location.
The predictor <code>Shelveloc</code> takes on three possible values, <em>Bad</em>, <em>Medium</em>, and <em>Good</em>.</p>
<p>Given a qualitative variable such as <code>Shelveloc</code>, <code>R</code> generates dummy variables
automatically.
Below we fit a multiple regression model that includes some interaction terms.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="linreg.html#cb58-1"></a>lm.fit =<span class="st"> </span><span class="kw">lm</span>(Sales<span class="op">~</span>.<span class="op">+</span>Income<span class="op">:</span>Advertising<span class="op">+</span>Price<span class="op">:</span>Age, <span class="dt">data =</span> Carseats)</span>
<span id="cb58-2"><a href="linreg.html#cb58-2"></a><span class="kw">summary</span>(lm.fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Sales ~ . + Income:Advertising + Price:Age, data = Carseats)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -2.921 -0.750  0.018  0.675  3.341 
## 
## Coefficients:
##                     Estimate Std. Error t value             Pr(&gt;|t|)    
## (Intercept)         6.575565   1.008747    6.52        0.00000000022 ***
## CompPrice           0.092937   0.004118   22.57 &lt; 0.0000000000000002 ***
## Income              0.010894   0.002604    4.18        0.00003566527 ***
## Advertising         0.070246   0.022609    3.11              0.00203 ** 
## Population          0.000159   0.000368    0.43              0.66533    
## Price              -0.100806   0.007440  -13.55 &lt; 0.0000000000000002 ***
## ShelveLocGood       4.848676   0.152838   31.72 &lt; 0.0000000000000002 ***
## ShelveLocMedium     1.953262   0.125768   15.53 &lt; 0.0000000000000002 ***
## Age                -0.057947   0.015951   -3.63              0.00032 ***
## Education          -0.020852   0.019613   -1.06              0.28836    
## UrbanYes            0.140160   0.112402    1.25              0.21317    
## USYes              -0.157557   0.148923   -1.06              0.29073    
## Income:Advertising  0.000751   0.000278    2.70              0.00729 ** 
## Price:Age           0.000107   0.000133    0.80              0.42381    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.01 on 386 degrees of freedom
## Multiple R-squared:  0.876,  Adjusted R-squared:  0.872 
## F-statistic:  210 on 13 and 386 DF,  p-value: &lt;0.0000000000000002</code></pre>
<p>The <code>contrasts()</code> function returns the coding that <code>R</code> uses for the dummy variables.</p>
<p>Use <code>?contrasts</code> to learn about other contrasts, and how to set them.</p>
<p><code>R</code> has created a <code>ShelveLocGood</code> dummy variable that takes on a value of 1 if the shelving location is good, and 0 otherwise.
It has also created a <code>ShelveLocMedium</code> dummy variable that equals 1 if the shelving location is
medium, and 0 otherwise.
A bad shelving location corresponds to a zero for each of the two dummy variables.
The fact that the coefficient for <code>ShelveLocGood</code> in the regression output is positive indicates that a good shelving location is associated with high sales (relative to a bad location).
And <code>ShelveLocMedium</code> has a smaller positive coefficient, indicating that a medium shelving location leads to higher sales than a bad shelving location but lower sales than a good shelving location.</p>
</div>
<div id="writing-functions" class="section level3">
<h3><span class="header-section-number">2.6.7</span> Writing Functions</h3>
<p>As we have seen, <code>R</code> comes with many useful functions, and still more functions are available by way of <code>R</code> libraries.
However, we will often be interested in performing an operation for which no function is available.
In this setting, we may want to write our own function.
For instance, below we provide a simple function that reads in the <code>ISLR</code> and <code>MASS</code> libraries, called <code>LoadLibraries()</code>.
Before we have created the function, <code>R</code> returns an error if we try to call it.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="linreg.html#cb60-1"></a>LoadLibraries</span></code></pre></div>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;LoadLibraries&#39; not found</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="linreg.html#cb62-1"></a><span class="kw">LoadLibraries</span>()</span></code></pre></div>
<pre><code>## Error in LoadLibraries(): could not find function &quot;LoadLibraries&quot;</code></pre>
<p>We now create the function.
Note that the <code>+</code> symbols are printed by <code>R</code> and should not be typed in.
The <code>{</code> symbol informs <code>R</code> that multiple commands are about to be input.
Hitting Enter after typing <code>{</code> will cause <code>R</code> to print the <code>+</code> symbol.
We can then input as many commands as we wish, hitting Enter after each one.
Finally the <code>}</code> symbol informs <code>R</code> that no further commands will be entered.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="linreg.html#cb64-1"></a>LoadLibraries =<span class="st"> </span><span class="cf">function</span>(){</span>
<span id="cb64-2"><a href="linreg.html#cb64-2"></a>  <span class="kw">library</span>(ISLR)</span>
<span id="cb64-3"><a href="linreg.html#cb64-3"></a>  <span class="kw">library</span>(MASS)</span>
<span id="cb64-4"><a href="linreg.html#cb64-4"></a>  <span class="kw">print</span>(<span class="st">&quot;The libraries have been loaded.&quot;</span>)</span>
<span id="cb64-5"><a href="linreg.html#cb64-5"></a>}</span></code></pre></div>
<p>Now if we type in <code>LoadLibraries</code>, <code>R</code> will tell us what is in the function.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="linreg.html#cb65-1"></a>LoadLibraries</span></code></pre></div>
<pre><code>## function(){
##   library(ISLR)
##   library(MASS)
##   print(&quot;The libraries have been loaded.&quot;)
## }</code></pre>
<p>If we call the function, the libraries are loaded in and the print statement is output.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="linreg.html#cb67-1"></a><span class="kw">LoadLibraries</span>()</span></code></pre></div>
<pre><code>## [1] &quot;The libraries have been loaded.&quot;</code></pre>
</div>
</div>
<div id="exercises" class="section level2">
<h2><span class="header-section-number">2.7</span> Exercises</h2>
<div id="conceptual" class="section level3">
<h3><span class="header-section-number">2.7.1</span> Conceptual</h3>
<ol style="list-style-type: decimal">
<li>Describe the null hypotheses to which the p-values given in Table 3.4 correspond.
Explain what conclusions you can draw based on these p-values.
Your explanation should be phrased in terms of <code>sales</code>, <code>TV</code>, <code>radio</code>,and <code>newspaper</code>, rather than in terms of the coefficients of the linear model.
<details>
<summary>Answer</summary>
<div class="summary-content">
The null hypotheses which correspond to the p-values in Table 3.4 are:
<ul>
<li>
<span class="math inline">\(H_{0a}\)</span>: A change in the advertising budget for <code>radio</code> is unrelated to changes in <code>sales</code> in the presence of <code>TV</code> and <code>newspaper</code> advertising.
</li>
<li>
<span class="math inline">\(H_{0b}\)</span>: A change in the advertising budget for <code>TV</code> is unrelated to changes in <code>sales</code> in the presence of <code>radio</code> and <code>newspaper</code> advertising.
</li>
<li>
<span class="math inline">\(H_{0c}\)</span>: A change in the advertising budget for <code>newspaper</code> is unrelated to changes in <code>sales</code> in the presence of <code>TV</code> and <code>radio</code> advertising.
</li>
</ul>
<p>The p-values for <code>TV</code> and <code>radio</code> are very low (<span class="math inline">\(&lt;.0001\)</span>) which means we can conclude there is likely a relationship between these two media and <code>sales</code>, while the p-value for <code>newspaper</code> is very high (<span class="math inline">\(0.8599\)</span>) which means we can conclude that a relationship between <code>newspaper</code> and <code>sales</code> is unlikely based on this data.</p>
</div>
</details></li>
</ol>

</div>
</div>
</div>


















<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>The assumption of linearity is often a useful working model.
However, despite what many textbooks might tell us, we seldom believe that the true relationship is linear.<a href="linreg.html#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>The formula holds provided that the <span class="math inline">\(n\)</span> observations are uncorrelated.<a href="linreg.html#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p> <em>Approximately</em> for several reasons. Equation <a href="linreg.html#eq:b1-interval">(2.10)</a> relies on the assumption that the errors are Guassian. Also, the factor of 2 in front of the <span class="math inline">\(SE(\hat{\beta_1})\)</span> term will vary slightly depending on the number of observations <em>n</em> in the linear regression.
To be precise, rather than the number 2, <a href="linreg.html#eq:b1-interval">(2.10)</a> should contain the 97.5% quantile of a <em>t</em>-distribution with <span class="math inline">\(n-2\)</span> degrees of freedom.
Details of how to compute the 95% confidence interval precisely in <code>R</code> will be preovided later in this chapter.<a href="linreg.html#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>In Table 3.1, a small p-value for the intercept indicates that we can reject the null hpothesis that <span class="math inline">\(\beta_0 = 0\)</span>, and a small p-value for <code>TV</code> indicates that we can reject the null hypothesis that <span class="math inline">\(\beta_1 = 0\)</span>.
Rejecting the latter null hypothesis allows us to conclude that there is a relationship between <code>TV</code> and <code>sales</code>.
Rejecting the former allows us to conclude that in the absence of <code>TV</code> expenditure, <code>sales</code> are non-zero.<a href="linreg.html#fnref4" class="footnote-back">↩︎</a></p></li>
<li id="fn5"><p>We should note that in fact, the right hand side of <a href="linreg.html#eq:correlation">(2.18)</a> is the sample correlation; thus, it would be more correct to write <span class="math inline">\(\widehat{Cor(X,Y)}\)</span>; however, we omit the “hat” for ease of notation.<a href="linreg.html#fnref5" class="footnote-back">↩︎</a></p></li>
<li id="fn6"><p>Even if the errors are not normally-distributed, the F-statistic approximately follows an F-distribution provided that the sample size <span class="math inline">\(n\)</span> is large.<a href="linreg.html#fnref6" class="footnote-back">↩︎</a></p></li>
<li id="fn7"><p>The squar eof each t-statistic is the corresponding F-statistic.<a href="linreg.html#fnref7" class="footnote-back">↩︎</a></p></li>
<li id="fn8"><p>In other words, if we collect a large number of data sets like the <code>Advertising</code> data set, and we construct a confidence interval for the average <code>sales</code> on the basis of each data set (given $100,000 in <code>TV</code> and $20,000 in <code>radio</code> advertising), then 95% of these confidence intervals will contain the true value of average <code>sales</code><a href="linreg.html#fnref8" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["BookdownISL.pdf", "BookdownISL.epub"],
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
